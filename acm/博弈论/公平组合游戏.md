# 公平组合游戏

## 定义

如果一个游戏满足：

1. 有两名玩家交替行动
2. 在游戏进程的任意时刻，可以执行的合法行动与轮到哪名玩家无关
3. 不能行动的玩家判负

那么该游戏就是公平组合游戏

## 有向图游戏

给定一个有向无环图，图中有一个唯一的起点，在起点上放一枚棋子。两名玩家交替移动棋子，无法移动者判负。

**任何一个**公平组合游戏都可以转化为有向图游戏。可以将每个局面看成一个节点。

## $mex$运算

我们定义
$$
mex(S)=min_{x \in N ,x \notin S}{x}
$$

## $SG$函数

一个状态的$sg$函数是这个状态的一个表示。

我们定义
$$
SG(x) = mex\{sg(y)\}
$$
其中$y$是$x$的后继状态.

有向图游戏的某个局面必胜当且仅当该局面对应节点的$SG$函数大于$0$

有向图游戏的某个局面必败当且仅当该局面对应节点的$SG$函数等于$0$

我们可以这样打表

```c++
for(int i = 1; i <= n; ++i)
{
    memset(vis, 0, sizeof(vis));
    for(int y:nxt[i])	//y表示i的下一个局面
        vis[sg[y]] = 1;
    for(int j = 0; j <= n; ++j)
    {
        if(!vis[j])
        {
            sg[i] = j;
            break;
        }
	}
}
```



## 有向图游戏的和

$$
SG(G)=SG(G_1) \wedge  SG(G_2) \wedge \cdots \wedge SG(G_m)
$$



# 常见博弈

## bash博弈

$n$个石子，每次可以取$1-m$颗石子

### 必败必胜

$n\mod (m+1)==0$先手必败，否则先手必胜

当$n\leq m $时，甲可以一次性拿完。先手必胜

$n=m+1$时，甲无论如何都拿不完，乙可以在甲操作完后拿完，先手必败。

$n$是$m+1$的倍数时，无论怎么拿都会破坏这个状态，后者总可以回到这个状态。

### 变种

每次我们只能取$\{a_1,a_2,\cdots,a_k\}$这个集合中的石子数

通常我们可以打表找规律，也可以$sg$函数判断，一般来说都有周期性。

# NIM博弈

有$n$堆石子，每次从某一堆中取任意数量的石子。

## 必败

当$a_1 \oplus  a_2 \oplus a_3 \oplus \cdots \oplus a_n ==0 $，先手必败，否则先手必胜

我们一定可以从必胜态找到一个必败态的后继，而必败态找不到必败态的后继。

# 威佐夫博弈

有两堆石子，每次可以从一堆中拿任意数量的石子或者从两堆中拿走相同数量的石子。

## 必败

当且仅当当前局势为奇异局势时必败

