<!DOCTYPE html>
<!-- saved from url=(0079)https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-G-Grouping-Problem-mid -->
<html lang="zh-CN" theme="light"><script type="text/javascript" async="" src="./# 2023 團體預賽題解 - HackMD_files/js" nonce=""></script><script async="" src="./# 2023 團體預賽題解 - HackMD_files/gtm.js.下载"></script><script id="allow-copy_script" src="chrome-extension://kkemgiffjdndikokhpoecoloebgeibde/content_scripts/copy.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="NTu6VyCT-CKzL_LElWt9y9kHCdby9_hpiwY8">
    
    
    <meta name="description" content="先固定 H 塗紅色，最後再把答案乘以 2。分為兩個 case：">
    
    <title># 2023 團體預賽題解 - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="false">

    
<script nonce="">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false || window.localStorage.getItem('HMD_DEBUG_FLAG') === 'true'
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = '25-WTZk1QHK7yT_7-wPWAQ'
  

  window.GOOGLE_DRIVE_API_KEY = 'AIzaSyAHmcP5gL_64ZafuAYOvJruFAIaYgHQaY4'
  window.GOOGLE_DRIVE_CLIENT_ID = '65857506266-76uhhee8se8dgs1i0q8fhtj1prg0ar27.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.ALLOW_DOWNLOAD_PDF = true
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  window.OFFLINE_ACCESS = true
  
  
  
    window.WALLET_CONNECT_PROJECT_ID = '91d6fa182b725b5895a17a170a5878c1'
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = false
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  
  window.IS_INVITEE_ADMIN = false
  

  
  window.USER_PROFILE = '%7B%22name%22%3A%22Guest%20Watson%22%7D'
  

  
  window.VERSION_TIME = '1691263231004'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = false
  

  
  window.canHideComment = false
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = true
  

  
    window.COMMENT_ENABLED = true
  

  window.SUGGEST_EDIT_ENABLED = true
  
    window.SUGGEST_EDIT_ENABLED = true
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  

  
    window.COMMENT_ENABLED = true
  

  
    window.DEBUG_DISCONNECT_SOCKET_WHEN_OFFLINE = false
  

  

  

  
    window.USE_NEW_LOGO = true
  

  
    window.ITERABLE_ENABLED = true
  
  
    window.ITERABLE_API_KEY = "c2c36a44c2614fb19aa3b46d660bbce2"
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    



    <meta property="fb:app_id" content="1436904003272070">



    <meta name="twitter:image:src" content="https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96">
    <meta name="twitter:image:alt" content="# 2023 團體預賽題解 - HackMD">


<meta name="twitter:site" content="@hackmdio">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="# 2023 團體預賽題解 - HackMD">


    <meta name="twitter:description" content="先固定 H 塗紅色，最後再把答案乘以 2。分為兩個 case：">



    <meta property="og:image" content="https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96">
    <meta property="og:image:alt" content="# 2023 團體預賽題解 - HackMD">


<meta property="og:site_name" content="HackMD">
<meta property="og:type" content="article">
<meta property="og:title" content="# 2023 團體預賽題解 - HackMD">


    <meta property="og:description" content="先固定 H 塗紅色，最後再把答案乘以 2。分為兩個 case：">


     <link href="./# 2023 團體預賽題解 - HackMD_files/font-vendor.ea8218d7d4f468b2c430.css" rel="stylesheet"><link href="./# 2023 團體預賽題解 - HackMD_files/common-vendor.0a08ae20e14fefe857eb.css" rel="stylesheet"><link href="./# 2023 團體預賽題解 - HackMD_files/pretty-vendor.db0e7b64c54d0a77290f.css" rel="stylesheet"><link href="./# 2023 團體預賽題解 - HackMD_files/pretty.7a3eb629eab4ef520e5e.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    


    <script defer="" data-domain="hackmd.io" src="./# 2023 團體預賽題解 - HackMD_files/script.js.下载"></script>
<script nonce="">
  window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments); }
  const keyboardWhiteList = ['a', 'span', 'button']

  function getTaggedEventAttributes (e) {
    const eventAttrs = { name: null, props: {} }
    if (!e || !e.classList) return eventAttrs
    const psEvent = /plausible-event-(.+)(=|--)(.+)/
    for (const className of [...e.classList]) {
      const [, key, , val] = className.match(psEvent) || []
      if (!key || !val) continue
      const value = val.replace(/\+/g, ' ')
      switch (key.toLowerCase()) {
        case 'name':
          eventAttrs.name = value
          break
        default:
          eventAttrs.props[key] = value
          break
      }
    }
    return eventAttrs
  }

  function isLocal () {
    return /^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(location.hostname) || location.protocol === 'file:'
  }

  function isAutomation () {
    return Boolean(window._phantom || window.__nightmare || window.navigator.webdriver || window.Cypress)
  }

  function shouldIgnore () {
    return isLocal() ||
      isAutomation() ||
      window.localStorage.getItem('plausible_ignore') === 'true'
  }

  function handler (e) {
    if (!window.plausible) return
    if (!e.target || !('className' in e.target)) return
    const ele = e.target

    const eventAttrs = getTaggedEventAttributes(ele)
    if (!eventAttrs.name) return
    if (ele?.href) eventAttrs.props.url = ele.href

    if (shouldIgnore()) {
      if (window.debug) logDebugEventMsg(eventAttrs)
      return
    }
    window.plausible(eventAttrs.name, { props: eventAttrs.props })
  }

  function logDebugEventMsg (eventAttrs) {
    console.warn(
      `Ignoring Event: "${eventAttrs.name}"`,
      eventAttrs,
    )
  }

  function keydownHandler (e) {
    if (e.key !== 'Enter') return
    if (e.target.nodeName.toLowerCase() === 'input') {
      switch (e.target.type.toLowerCase()) {
        case 'submit':
        case 'button':
        case 'reset':
        case 'checkbox':
        case 'radio':
        case 'file':
        case 'image':
        case 'color':
          break
        default:
          return
      }
    } else if (!keyboardWhiteList.includes(e.target.nodeName.toLowerCase())) {
      return
    }
    handler(e)
  }

  document.addEventListener('mousedown', handler)
  document.addEventListener('keydown', keydownHandler)
</script>

    
<script nonce="">
  window.publishProps = JSON.parse(`{"isOwnerAnonymous":false,"isOwnedByTeam":false,"ownerInfo":{"name":"%E6%B3%A2%E8%B7%AF%E7%89%B9%E7%9F%B3","path":"baluteshih","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2F-CKX82J9UNKM%2FAAAAAAAAAAI%2FAAAAAAAAACA%2FosF3Ho7GK5E%2Fphoto.jpg%3Fsz%3D96","description":null},"isPublished":false,"createTime":1690617206669,"updateTime":1691263231004,"vcsSyncMode":"github","vcsProviderName":"GitHub","canEdit":false,"hardBreaks":true,"onlyOwnerCanEdit":true,"isCommentEnabled":true,"likedCount":0,"isNotificationEnabled":true,"notificationType":"never","hasEmail":false,"canWriteComment":false,"viewCount":1585,"markdown":"%23%23%20Final%20Scoreboard%0A%0A!%5B%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH1BjvaNj3.png)%0A%0A%23%23%20Statistics%0A%0A%23%23%23%20Problems%20Attempted%2FSolved%0A!%5B%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJwUwTNsh.png)%0A%0A%23%23%23%20Submissions%20Over%20Time%0A%0A!%5B%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FrJ8FPa4jn.png)%0A%0A%23%23%20Summary%20%0A%0A%E5%9F%BA%E6%9C%AC%E4%B8%8A%E9%80%99%E5%A0%B4%E6%AF%94%E8%B3%BD%E8%A2%AB%E5%88%87%E6%88%90%E4%B8%89%E5%80%8B%E9%9A%8E%E6%AE%B5%0A-%20%E5%89%8D%E6%9C%9F%E9%A1%8C%20CEFHI%0A-%20%E4%B8%AD%E6%9C%9F%E9%A1%8C%20BGML%0A-%20%E5%BE%8C%E6%9C%9F%E9%A1%8C%20AJK%0A-%20%E4%B8%8D%E5%8F%AF%E5%81%9A%E9%A1%8C%20D%EF%BC%88%E4%B8%8D%E6%98%AF%E4%B8%80%E5%80%8B%E9%9A%8E%E6%AE%B5%EF%BC%89%0A%0A%E6%84%9F%E8%A6%BA%E5%A4%A7%E5%A4%9A%E6%95%B8%E4%BA%BA%E5%89%8D%E6%9C%9F%E9%A1%8C%E9%96%8B%E5%AE%8C%E4%B9%8B%E5%BE%8C%E5%B0%B1%E8%A2%AB%E5%8D%A1%E4%BD%8F%E4%BA%86%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%AD%E6%9C%9F%E9%A1%8C%E9%81%8E%E6%96%BC%20unusual%20%E7%9A%84%E9%97%9C%E4%BF%82%20QQ%20%0A%E6%9C%80%E6%AD%A3%E5%B8%B8%E7%9A%84%20G%20%E4%BC%BC%E4%B9%8E%E6%B2%92%E6%9C%89%E4%BA%BA%E6%83%B3%E5%88%B0%EF%BC%8C%E4%BD%86%E9%80%99%E9%A1%8C%E9%82%84%E7%AE%97%E6%BC%82%E4%BA%AE%EF%BC%8C%E6%8E%A8%E8%96%A6%E5%A4%A7%E5%AE%B6%E5%A4%9A%E6%83%B3%E4%B8%80%E9%99%A3%E5%AD%90%E5%86%8D%E7%9C%8B%E9%A1%8C%E8%A7%A3%E3%80%82%0A%0A%E4%BB%A5%E4%B8%8B%E6%AF%8F%E9%A1%8C%E5%BE%8C%E9%9D%A2%E6%9C%83%E9%99%84%E4%B8%8A%E6%88%91%E5%80%91%E9%A0%90%E6%9C%9F%E7%9A%84%E9%9B%A3%E5%BA%A6%E3%80%82%0A%0A%23%23%20Problem%20A.%20Area%20in%20Convex%20%5Bmid-hard%5D%0A%0A%E8%AE%93%E6%88%91%E5%80%91%E5%85%88%E8%80%83%E6%85%AE%E5%B0%8D%E6%96%BC%E5%B0%8F%E5%87%B8%E5%8C%85%E7%9A%84%E4%B8%80%E5%80%8B%E9%A0%82%E9%BB%9E%20%24p%24%20%E5%8F%AF%E4%BB%A5%E7%A7%BB%E5%8B%95%E7%9A%84%E7%AF%84%E5%9C%8D%E3%80%82%0A%0A%E5%8F%AF%E4%BB%A5%E7%99%BC%E7%8F%BE%EF%BC%8C%E5%B0%8D%E6%96%BC%E6%AF%8F%E4%B8%80%E6%A2%9D%E5%90%91%E9%87%8F%20%24%5Coverrightarrow%7Bq_ip%7D%24%20%E9%83%BD%E6%9C%83%E9%80%A0%E6%88%90%E5%A4%A7%E5%87%B8%E5%8C%85%E7%9A%84%E6%AF%8F%E4%B8%80%E6%A2%9D%E9%82%8A%E5%BE%80%E5%85%A7%20%24%5Coverrightarrow%7Bq_ip%7D%24%20%E7%9A%84%E9%99%90%E5%88%B6%EF%BC%8C%0A%E5%85%B6%E4%B8%AD%20%24q_i%24%20%E6%98%AF%E5%B0%8F%E5%87%B8%E5%8C%85%E4%B8%8A%E7%9A%84%E5%8F%A6%E4%B8%80%E5%80%8B%E9%BB%9E%E3%80%82%0A%0A%E5%9B%A0%E6%AD%A4%EF%BC%8C%E5%B0%8D%E5%A4%A7%E5%87%B8%E5%8C%85%E7%9A%84%E6%AF%8F%E4%B8%80%E6%A2%9D%E9%82%8A%E6%89%BE%E5%88%B0%E5%BE%80%E5%85%A7%E5%B9%B3%E7%A7%BB%E6%9C%80%E5%A4%9A%E7%9A%84%20%24%5Coverrightarrow%7Bq_ip%7D%24%EF%BC%8C%E6%9C%83%E6%98%AF%E9%A6%96%E8%A6%81%E9%97%9C%E9%8D%B5%EF%BC%8C%E8%80%8C%E9%80%99%E9%99%A4%E4%BA%86%E7%94%A8%20%24O(NM)%24%20%E6%89%BE%E5%88%B0%E4%B9%8B%E5%A4%96%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%94%A8%E9%9B%99%E6%8C%87%E9%87%9D%E9%A1%9E%E4%BC%BC%5B%E6%97%8B%E8%BD%89%E5%8D%A1%E5%B0%BA%5D(https%3A%2F%2Foi-wiki.org%2Fgeometry%2Frotating-calipers%2F)%E7%9A%84%E5%81%9A%E6%B3%95%E5%9C%A8%20%24O(N%2BM)%24%20%E6%89%BE%E5%88%B0%E3%80%82%E5%AF%A6%E5%8B%99%E4%B8%8A%E5%9B%A0%E7%82%BA%20%24N%2C%20M%5Cleq%2010%5E4%24%EF%BC%8C%24O(NM)%24%20%E7%9A%84%E5%81%9A%E6%B3%95%E5%B8%B8%E6%95%B8%E4%B8%8D%E8%A6%81%E9%81%8E%E5%A4%A7%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%BE%88%E5%BF%AB%E6%89%BE%E5%AE%8C%E3%80%82%0A%0A%E6%89%BE%E5%88%B0%E5%A4%A7%E5%87%B8%E5%8C%85%E7%9A%84%E6%AF%8F%E4%B8%80%E6%A2%9D%E9%82%8A%E5%B9%B3%E7%A7%BB%E7%9A%84%E7%B5%90%E6%9E%9C%E5%BE%8C%EF%BC%8C%E5%9B%A0%E7%82%BA%E9%A1%8C%E7%9B%AE%E4%BF%9D%E8%AD%89%E6%9C%80%E7%B5%82%E8%A7%A3%E5%AD%98%E5%9C%A8%E5%85%A9%E5%80%8B%E6%96%B9%E5%90%91%E5%8F%AF%E4%BB%A5%E7%A7%BB%E5%8B%95%E5%B0%8F%E5%87%B8%E5%8C%85%20%3D%3E%20%E8%A9%B2%E9%A0%82%E9%BB%9E%E5%8F%AF%E7%A7%BB%E5%8B%95%E7%9A%84%E7%AF%84%E5%9C%8D%E9%9D%A2%E7%A9%8D%20%24%3E0%24%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%A5%97%E7%94%A8%5B%E5%8D%8A%E5%B9%B3%E9%9D%A2%E4%BA%A4%5D(https%3A%2F%2Foi-wiki.org%2Fgeometry%2Fhalf-plane%2F)%E4%BE%86%E6%8A%8A%E7%AF%84%E5%9C%8D%E6%89%BE%E5%87%BA%E4%BE%86%EF%BC%8C%E6%9C%83%E6%98%AF%E4%B8%80%E5%80%8B%E5%87%B8%E5%A4%9A%E9%82%8A%E5%BD%A2%E3%80%82%E9%80%99%E6%AD%A5%E5%8F%AF%E4%BB%A5%20%24O((N%2BM)%5Clog(N%2BM))%24%20%E6%90%9E%E5%AE%9A%E3%80%82%0A%0A%E6%8E%A5%E8%91%97%EF%BC%8C%E6%88%91%E5%80%91%E5%B8%8C%E6%9C%9B%E7%94%A8%20%24p%24%20%E7%9A%84%E7%A7%BB%E5%8B%95%E7%AF%84%E5%9C%8D%E4%BE%86%E9%82%84%E5%8E%9F%E5%87%BA%E6%95%B4%E5%80%8B%E5%B0%8F%E5%87%B8%E5%8C%85%E7%9A%84%E8%A6%86%E8%93%8B%E7%AF%84%E5%9C%8D%EF%BC%8C%0A%E6%B3%A8%E6%84%8F%E5%88%B0%E9%80%99%E5%85%B6%E5%AF%A6%E6%98%AF%E9%82%A3%E4%BA%9B%20%24%5Coverrightarrow%7Bpq_i%7D%24%20%E8%92%90%E9%9B%86%E8%B5%B7%E4%BE%86%E4%B9%8B%E5%BE%8C%E8%B7%9F%20%24p%24%20%E7%9A%84%E7%A7%BB%E5%8B%95%E7%AF%84%E5%9C%8D%E6%B1%82%5B%E9%96%94%E5%8F%AF%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%92%8C%5D(https%3A%2F%2Fzh.wikipedia.org%2Fzh-tw%2F%25E9%2596%2594%25E5%258F%25AF%25E5%25A4%25AB%25E6%2596%25AF%25E5%259F%25BA%25E5%2592%258C)%EF%BC%8C%E5%9B%A0%E6%AD%A4%E5%8F%AF%E4%BB%A5%E5%9C%A8%20%24O((N%2BM)%5Clog(N%2BM))%24%20%E6%90%9E%E5%AE%9A%E3%80%82%0A%0A%E4%BD%86%E5%85%B6%E5%AF%A6%EF%BC%8C%E5%8D%8A%E5%B9%B3%E9%9D%A2%E4%BA%A4%E5%92%8C%E9%96%94%E5%8F%AF%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%92%8C%E7%9A%84%E8%A4%87%E9%9B%9C%E5%BA%A6%E7%93%B6%E9%A0%B8%E9%83%BD%E6%98%AF%E6%8E%92%E5%BA%8F%EF%BC%8C%E7%94%B1%E6%96%BC%E9%80%99%E9%A1%8C%E5%87%B8%E5%8C%85%E7%9A%84%E5%A5%BD%E6%80%A7%E8%B3%AA%EF%BC%8C%E5%85%B6%E5%AF%A6%E5%AF%A6%E4%BD%9C%E4%B8%8A%E5%8F%AF%E4%BB%A5%E5%AE%8C%E5%85%A8%E9%81%BF%E5%85%8D%E6%8E%92%E5%BA%8F%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%95%B4%E9%A1%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8%20%24O(N%2BM)%24%20%E5%85%A7%E5%AE%8C%E6%88%90%E3%80%82%0A%0A%E6%AF%94%E8%BC%83%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F%E7%9A%84%E9%BB%9E%E6%98%AF%E7%B2%BE%E5%BA%A6%E5%95%8F%E9%A1%8C%EF%BC%8C%E5%8E%9F%E9%A1%8C%E4%BF%9D%E8%AD%89%E4%BA%86%E5%B0%8F%E5%87%B8%E5%8C%85%E9%9D%A2%E7%A9%8D%E7%9A%84%20%2410%5E5%24%20%E5%80%8D%E4%B8%8D%E6%9C%83%E5%B0%8F%E6%96%BC%E6%9C%80%E5%A4%A7%E5%BA%A7%E6%A8%99%E7%B5%95%E5%B0%8D%E5%80%BC%E7%9A%84%E5%B9%B3%E6%96%B9%E5%85%B6%E5%AF%A6%E6%98%AF%E5%9C%A8%E4%BF%9D%E8%AD%89%E3%80%8C%E5%A4%AA%E5%A4%A7%E7%9A%84%E7%B5%95%E5%B0%8D%E8%AA%A4%E5%B7%AE%E3%80%8D%E4%B8%8D%E6%9C%83%E9%80%A0%E6%88%90%E7%B2%BE%E5%BA%A6%E4%B8%8A%E7%9A%84%E5%9B%B0%E6%93%BE%EF%BC%8C%E4%BD%86%E9%9A%A8%E6%84%8F%E5%AF%A6%E4%BD%9C%E9%82%84%E6%98%AF%E5%BE%88%E5%AE%B9%E6%98%93%E8%AE%93%E7%B2%BE%E5%BA%A6%E5%99%B4%E9%A3%9B%EF%BC%88ex.%20%E9%81%8E%E6%97%A9%E5%B0%87%E6%95%B8%E5%AD%97%E8%BD%89%E6%88%90%E6%B5%AE%E9%BB%9E%E6%95%B8%E5%BE%8C%E9%80%B2%E8%A1%8C%E9%81%8B%E7%AE%97%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B9%8B%E5%BE%8C%E9%82%84%E6%9C%89%E4%B9%98%E6%B3%95%E5%B0%B1%E5%8F%AF%E8%83%BD%E6%94%BE%E5%A4%A7%E8%AA%A4%E5%B7%AE%EF%BC%89%EF%BC%8C%E5%9C%A8%E9%80%99%E7%A8%AE%E6%83%85%E6%B3%81%E4%B8%8B%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%20%60__float128%60%20%E4%BE%86%E7%B6%AD%E6%8C%81%E7%B2%BE%E5%BA%A6%E3%80%82%0A%0A%E5%AD%98%E5%9C%A8%E4%B8%80%E4%BB%BD%E5%8F%AA%E7%94%A8%E5%88%B0%20%60double%60%20%E5%9E%8B%E6%85%8B%E6%B5%AE%E9%BB%9E%E6%95%B8%E7%9A%84%E8%A7%A3%E7%AD%94%E3%80%82%0A%0A%23%23%20Problem%20B.%20Bogosort%20%5Bmid%5D%0A%0A%23%23%23%20How%20to%20start%20with%3F%0ALet's%20think%20about%20a%20good%20scenario%20as%20ending%20---%20the%20last%20%245%24%20consecutive%20numbers%20are%20repeatedly%20shuffled%20until%20all%20of%20them%20are%20correcly%20placed%20and%20once%20this%20is%20achieved%2C%20the%20array%20is%20sorted.%20If%20this%20is%20the%20case%2C%20we%20should%20have%20the%20other%20%2495%24%20numbers%20correctly%20placed%20first.%0A%0A%23%23%23%20Heuristic%20Proposal%0ASo%2C%20we%20may%20wonder%20if%20there%20exists%20any%20way%20such%20that%20after%20the%20%24i%24-th%20(%24i%20%5Cleq%2095%24)%20iteration%2C%20%24a_j%20%3D%20j%2C%20%5Cforall%20j%20%3D%201%2C%202%2C%20%5Cldots%2C%20i%24.%20(And%20after%20that%2C%20just%20randomly%20shuffle%20%24a%5B96..100%5D%24%20until%20%24a%24%20gets%20sorted.)%20Good%20news%3A%20it's%20possible!%0A%0ABased%20on%20the%20induction%20hypothesis%20(i.e.%20%24%5Ba_1%2C%20a_2%2C%20%5Cldots%2C%20a_%7Bi%20-%201%7D%5D%20%3D%20%5B1%2C%202%2C%20%5Cldots%2C%20i%20-%201%5D%24%20before%20the%20%24i%24-th%20iteration%20begins)%2C%20in%20the%20%24i%24-th%20iteration%2C%20let's%20do%20the%20following%20thing%3A%0A%0A%60%60%60%0Awhile%20True%3A%0A%20%20%20%20Shuffle%20a%5Bi..N%5D%20%2F%2F%20try%20our%20luck%20to%20hit%20a_i%20%3D%20i%0A%20%20%20%20%0A%20%20%20%20%2F*%20Verify%20if%20you%20are%20that%20lucky%20*%2F%0A%20%20%20%20record%20%3D%20%5B%5D%0A%20%20%20%20Do%20C%20times%3A%20%2F%2F%20C%20can%20be%20a%20constant%0A%20%20%20%20%20%20%20%20Shuffle%20a%5B(i%20%2B%201)..N%5D%0A%20%20%20%20%20%20%20%20append%20%22the%20i-th%20smallest%20element%20of%20%7Ca_z%20-%20z%7C%22%20to%20record%0A%20%20%20%20if%20all%20the%20elements%20in%20record%20are%20zeros%3A%0A%20%20%20%20%20%20%20%20break%20%2F%2F%20treat%20it%20as%20a%20sign%20of%20a_i%20%3D%20i%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20continue%20%2F%2F%20try%20again%20to%20make%20a_i%20%3D%20i%20next%20time%0A%60%60%60%0A%0A%23%23%23%20Verification%20Validity%0A%0ALet's%20see%20how%20the%20verification%20process%20can%20be%20valid.%0A%0A%23%23%23%23%20False%20Negative%0A%0AThis%20does%20not%20happen.%20When%20%24a_i%20%3D%20i%24%2C%20the%20%24i%24%20smallest%20%24%7Ca_z%20-%20z%7C%24%20must%20all%20be%20zeros%20because%20of%20the%20induction%20hypothesis.%20Hence%2C%20when%20we%20perform%20%60%3F%201%20i%60%2C%20it%20always%20returns%200%20if%20%24a_i%20%3D%20i%24.%0A%0A%23%23%23%23%20False%20Positive%0A%0AThis%20**may%20happen**%20but%20with%20a%20low%20probability.%20A%20false%20positive%20occurs%20when%20both%20of%20the%20conditions%20below%20hold.%0A%0A-%20%24a_i%20%5Cneq%20i%24%0A-%20no%20%5Bderangement%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FDerangement)%20happens%20in%20any%20of%20the%20%24C%24%20shuffles%0A%20%20%20%20-%20Please%20note%20that%20this%20is%20an%20inaccurate%20statement%20since%3Cbr%3E%3Cbr%3E%24%5C%7Ba_%7Bi%20%2B%201%7D%2C%20a_%7Bi%20%2B%202%7D%2C%20%5Cldots%2C%20N%5C%7D%20%5Cneq%20%5C%7Bi%20%2B%201%2C%20i%20%2B%202%2C%20%5Cldots%2C%20N%5C%7D%24%3Cbr%3E%3Cbr%3Ewhen%20%24a_i%20%5Cneq%20i%24.%20Anyway%2C%20you%20know%20what%20I%20mean.%0A%0AThe%20probability%20of%20the%20latter%20condition%20is%20upper-bounded%20by%20%0A%0A%24%24%0A%5Cleft(1%20-%20%5Cdfrac%7B!n%7D%7Bn!%7D%5Cright)%5EC%20%5Capprox%20%5Cleft(1%20-%20%5Cdfrac1e%5Cright)%5EC%20%5Capprox%200.632%5EC%0A%24%24%0A%0A%2C%20where%20%24n%20%3D%20N%20-%20i%24%20and%20%24!n%24%20denotes%20the%20%24n%24-th%20derangement%20number.%20So%2C%20for%20sufficiently%20large%20%24C%24%2C%20the%20probability%20of%20the%20occurence%20of%20a%20false%20positive%20can%20be%20negligible.%0A%0A%23%23%23%20Implementation%20and%20Experiments%0A%0ABy%20taking%20%24C%20%3D%2030%24%20and%20an%20optimization%20---%20conditionally%20%22break%22%20the%20%22Do%20C%20times%22%20loop%20if%20the%20number%20appended%20into%20the%20record%20is%20non-zero%20---%20this%20heuristic%20method%20can%20succeed%20%24995%24%20times%20out%20of%20%241000%24%20experiments.%20To%20make%20it%20even%20more%20robust%2C%20some%20trivial%20optimizations%20(e.g.%20dynamically%20determine%20%24C%24%20depending%20on%20%24i%24%20and%20the%20number%20of%20remaining%20queries%2C%20or%20rollback%20to%20a%20previous%20iteration%20if%20a%20suspicious%20false%20positive%20is%20detected%20with%20high%20confidence)%20can%20still%20be%20applied.%20But%20since%20there%20are%20only%20%2420%24%20testcases%2C%20given%20the%20fact%20that%20%240.995%5E%7B20%7D%20%3E%2090%5C%25%24%2C%20I%20would%20rather%20just%20submit%20my%20code%20again%20instaead%20of%20implementing%20more%20optimizations.%0A%0A%23%23%20Problem%20C.%20Communication%20Problem%20%5Beasy%5D%0A%0AAs%20a%20contestant%2C%20you%20may%20first%20try%20on%20different%20%24n%24%20to%20discover%20the%20pattern%20---%20if%20you%20tried%20to%20do%20so%2C%20you%20were%20on%20the%20expected%20way%20to%20start%20with%20this%20problem.%0A%0AAs%20you%20may%20notice%2C%20except%20for%20the%20case%20where%20%24k%20%3D%20n%24%2C%20the%20answer%20is%20only%20determined%20by%20%24k%24.%20More%20specifically%2C%20when%20%24k%20%3C%20n%24%2C%20%24ans_k%20%3D%20%5Cdfrac%7B1%7D%7Bk!%20%2B%20(k%20-%201)!%7D%24.%0A%0AThis%20hypothesis%20seems%20arbitrary%20but%20you%20could%20find%20it%20reasonable%20after%20thinking%20twice.%20Let's%20consider%20the%20contribution%20when%20you%20add%20a%20number%20%24x%24%20into%20the%20set%20%24B%24.%20The%20more%20divisors%20%24x%24%20have%2C%20the%20larger%20the%20numerator%20is%3B%20however%2C%20%24x%24%20grows%20much%20faster%20than%20%24d(x)%24%2C%20where%20%24d(x)%24%20denotes%20the%20number%20of%20divisors%20%24x%24%20have.%20In%20this%20case%2C%20adding%20a%20smaller%20number%20but%20keeping%20the%20nominator%20positive%20makes%20sense.%20More%20specifically%2C%20you%20may%20observe%20that%20for%20some%20small%20%24n%24%2C%0A%0A%24%24%0A%5Cbegin%7Bcases%7D%0AB_1%20%3D%20%5C%7B2%5C%7D%5C%5C%0AB_k%20%3D%20B_%7Bk%20-%201%7D%20%5Ccup%20%5C%7Bk%20%2B%201%5C%7D%2C%20%5Cforall%20k%20%3D%202%2C%203%2C%20%5Cldots%2C%20n%20-%201%5C%5C%0AB_n%20%3D%20%5C%7B1%2C%202%2C%20%5Cldots%2C%20n%5C%7D%0A%5Cend%7Bcases%7D%0A%24%24%0A%0Aand%20this%20is%20the%20correct%20construction%20for%20all%20%24n%24%20as%20well.%0A%0AThe%20explanation%20above%20may%20serve%20as%20an%20intuitive%20understanding%20instead%20of%20a%20rigorous%20proof.%20With%20this%20problem%2C%20we%20would%20like%20to%20introduce%20that%20finding%20the%20pattern%20before%20coming%20up%20with%20a%20claim%20is%20often%20useful%20and%20effective%20in%20competitive%20programming.%0A%0ASince%20all%20the%20teams%20have%20solved%20this%20problem%2C%20let's%20omit%20the%20rigorous%20proof%20part%20and%20leave%20it%20as%20an%20exercise%20for%20you%20%3A)%0A%0A%23%23%20Problem%20D.%20Decision%20Problem%20%5Bhard%5D%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D%3A%20%E8%A9%A2%E5%95%8F%E6%A8%B9%E4%B8%8A%E5%85%A9%E9%BB%9E%E9%96%93%E8%B7%AF%E5%BE%91%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%81%B6%E6%95%B8%E6%AC%A1%E3%80%82%E9%99%90%E5%AE%9A%E5%9C%A8%E7%B7%9A%E7%AE%97%E6%B3%95%E3%80%82%0A%3A%3A%3A%0A%0A%23%23%23%20D.1%20%E6%8B%86%E8%A7%A3%E5%95%8F%E9%A1%8C%0A%E5%B0%8D%E6%96%BC%E6%A8%B9%E4%B8%8A%E8%B7%AF%E5%BE%91%E8%A9%A2%E5%95%8F%E7%9A%84%E9%A1%8C%E7%9B%AE%EF%BC%8C%E9%80%9A%E5%B8%B8%E5%8F%AF%E4%BB%A5%E5%85%88%E8%80%83%E6%85%AE%E5%BA%8F%E5%88%97%EF%BC%88%E6%A8%B9%E6%98%AF%E4%B8%80%E6%A2%9D%E9%8F%88%EF%BC%89%E7%9A%84%E6%83%85%E5%BD%A2%EF%B8%B0%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D.1%3A%20%E7%B5%A6%E5%AE%9A%E4%B8%80%E5%80%8B%E5%BA%8F%E5%88%97%20%24a_1%2C%20a_2%2C%20%5Ccdots%2C%20a_n%24%EF%BC%8C%24q%24%20%E6%AC%A1%E8%A9%A2%E5%95%8F%E5%8D%80%E9%96%93%20%24%5Bl_i%2C%20r_i%5D%24%20%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%81%B6%E6%95%B8%E6%AC%A1%E3%80%82%0A%3A%3A%3A%0A%0A%E9%80%99%E5%80%8B%E5%95%8F%E9%A1%8C%E5%8F%AF%E4%BB%A5%E8%BC%95%E6%98%93%E7%9A%84%E4%BD%BF%E7%94%A8%5B%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%5D(https%3A%2F%2Foi-wiki.org%2Fmisc%2Fmo-algo%2F)%E8%A7%A3%E6%B1%BA%E3%80%82%E6%B3%A8%E6%84%8F%E5%88%B0%E9%9B%96%E7%84%B6%5B%E9%9B%B6%E6%98%AF%E5%81%B6%E6%95%B8%5D(https%3A%2F%2Ftw.news.yahoo.com%2F0%25E7%2582%25BA%25E4%25BD%2595%25E6%2598%25AF-%25E5%2581%25B6%25E6%2595%25B8-%25E5%25B0%258F%25E5%25AD%25B8%25E7%2594%259F-%25E6%258B%259B%25E5%2591%258A%25E8%25A8%25B4%25E4%25BD%25A0-023035573.html)%EF%BC%8C%E4%BD%86%E4%BE%9D%E6%93%9A%E5%8E%9F%E9%A1%8C%EF%BC%88D%EF%BC%89%E9%A1%8C%E6%84%8F%EF%BC%8C%E8%A9%A2%E5%95%8F%E7%AF%84%E5%9C%8D%E5%85%A7%E6%B2%92%E5%87%BA%E7%8F%BE%E9%81%8E%E7%9A%84%E6%95%B8%E5%AD%97%E4%B8%8D%E5%88%97%E5%85%A5%E8%A8%88%E7%AE%97%E3%80%82%E5%9B%A0%E6%AD%A4%E5%95%8F%E9%A1%8C%20D.1%20%E6%9C%AC%E8%B3%AA%E4%B8%8A%E6%98%AF%E4%BB%A5%E4%B8%8B%E5%85%A9%E5%80%8B%E5%AD%90%E5%95%8F%E9%A1%8C%EF%BC%88D.1.1%2C%20D.1.3%EF%BC%89%E7%9A%84%E7%AD%94%E6%A1%88%E7%9B%B8%E6%B8%9B%EF%B8%B0%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D.1.1%3A%20%E7%B5%A6%E5%AE%9A%E4%B8%80%E5%80%8B%E5%BA%8F%E5%88%97%20%24a_1%2C%20a_2%2C%20%5Ccdots%2C%20a_n%24%EF%BC%8C%24q%24%20%E6%AC%A1%E8%A9%A2%E5%95%8F%E5%8D%80%E9%96%93%20%24%5Bl_i%2C%20r_i%5D%24%20%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E4%B8%8D%E5%90%8C%E7%9A%84%E6%95%B8%E5%AD%97%E3%80%82%0A%3A%3A%3A%0A%0A%E9%9B%96%E7%84%B6%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%E8%99%95%E7%90%86%EF%BC%8C%E4%BD%86%E5%A6%82%E6%9E%9C%E9%A1%8C%E7%9B%AE%E8%A6%81%E6%B1%82%E5%9C%A8%E7%B7%9A%E5%91%A2%EF%BC%9F%0A%0A%3A%3A%3Awarning%0A%E7%B7%B4%E7%BF%92%20D.1.2%EF%BC%88%E7%84%A1%E9%97%9C%E5%8E%9F%E9%A1%8C%E5%AE%98%E8%A7%A3%EF%BC%89%3A%20%E5%9C%A8%20%24O((n%20%2B%20q)%5Clog%20n)%24%20%E7%9A%84%E6%99%82%E9%96%93%E5%85%A7%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C%20D.1.1%E3%80%82%E9%99%90%E5%AE%9A%E5%9C%A8%E7%B7%9A%E7%AE%97%E6%B3%95%E3%80%82%0A%3A%3A%3A%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D.1.3%3A%20%E7%B5%A6%E5%AE%9A%E4%B8%80%E5%80%8B%E5%BA%8F%E5%88%97%20%24a_1%2C%20a_2%2C%20%5Ccdots%2C%20a_n%24%EF%BC%8C%24q%24%20%E6%AC%A1%E8%A9%A2%E5%95%8F%E5%8D%80%E9%96%93%20%24%5Bl_i%2C%20r_i%5D%24%20%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%A5%87%E6%95%B8%E6%AC%A1%E3%80%82%0A%3A%3A%3A%0A%0A%E8%88%87%20D.1.1%20%E4%B8%8D%E5%90%8C%E7%9A%84%E6%98%AF%EF%BC%8CD.1.3%20%E4%BD%BF%E7%94%A8%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%E6%99%82%E4%B8%8D%E9%9C%80%E8%A6%81%E8%A8%98%E9%8C%84%E6%AF%8F%E5%80%8B%E6%95%B8%E5%AD%97%E5%AF%A6%E9%9A%9B%E5%87%BA%E7%8F%BE%E7%9A%84%E6%AC%A1%E6%95%B8%EF%BC%8C%E5%8F%AA%E8%A6%81%E8%A8%98%E9%8C%84%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E5%B0%B1%E5%A5%BD%E4%BA%86%E3%80%82%0A%0A%E5%B0%8D%E6%96%BC%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%E8%83%BD%E8%A7%A3%E6%B1%BA%E7%9A%84%E5%95%8F%E9%A1%8C%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%98%97%E8%A9%A6%E5%88%86%E5%A1%8A%E3%80%82%E9%81%B8%E6%93%87%E5%B8%B8%E6%95%B8%20%24k%24%EF%BC%8C%E4%BB%A4%E9%9B%86%E5%90%88%20%24S%24%20%E7%82%BA%20%241%20%5Csim%20n%24%20%E4%B8%AD%E6%89%80%E6%9C%89%20%24k%24%20%E7%9A%84%E5%80%8D%E6%95%B8%E3%80%82%E5%B0%8D%E6%96%BC%E6%89%80%E6%9C%89%20%24p%20%5Cin%20S%24%EF%BC%8C%E7%B4%80%E9%8C%84%E6%AF%8F%E4%B8%80%E7%A8%AE%E6%95%B8%E5%AD%97%E5%9C%A8%20%24%5B1%2C%20p%5D%24%20%E4%B8%AD%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E3%80%82%E7%94%B1%E6%96%BC%E6%95%B4%E5%80%8B%E5%BA%8F%E5%88%97%E8%87%B3%E5%A4%9A%E6%9C%89%20%24n%24%20%E7%A8%AE%E6%95%B8%E5%AD%97%EF%BC%8C%E7%B4%80%E9%8C%84%E5%A5%87%E5%81%B6%E6%80%A7%E9%9C%80%E8%A6%81%20%24O(n%20%5Ccdot%20%7CS%7C)%20%3D%20O(n%5E2%20%2F%20k)%24%20%E7%9A%84%E7%A9%BA%E9%96%93%E3%80%82%0A%0A%E6%AD%A4%E5%A4%96%EF%BC%8C%E5%B0%8D%E6%96%BC%E6%89%80%E6%9C%89%20%24p_1%2C%20p_2%20%5Cin%20S%24%EF%BC%8C%E9%A0%90%E5%85%88%E8%A8%88%E7%AE%97%20%24%5Bp_1%2C%20p_2%5D%24%20%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%A5%87%E6%95%B8%E6%AC%A1%EF%BC%8C%E9%9C%80%E8%A6%81%20%24O(%7CS%7C%5E2)%20%3D%20O(n%5E2%20%2F%20k%5E2)%24%20%E7%9A%84%E7%A9%BA%E9%96%93%E3%80%82%0A%0A%E8%87%B3%E6%AD%A4%E9%A0%90%E8%99%95%E7%90%86%E7%9A%84%E6%AD%A5%E9%A9%9F%E7%B5%90%E6%9D%9F%EF%BC%8C%E6%99%82%E9%96%93%E5%92%8C%E7%A9%BA%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E9%83%BD%E6%98%AF%20%24O(n%5E2%20%2F%20k)%24%E3%80%82%0A%0A%E8%A9%A2%E5%95%8F%E6%99%82%EF%BC%8C%E4%BB%A4%20%24l%5E%5Cprime_i%20%3D%20%5Cmax%5Cleft(k%2C%20l_i%20-%20(l_i%20%5Cmod%20k)%5Cright)%2C%20r%5E%5Cprime_i%20%3D%20%5Cmax%5Cleft(k%2C%20r_i%20-%20(r_i%20%5Cmod%20k)%5Cright)%24%EF%BC%8C%E6%B3%A8%E6%84%8F%E5%88%B0%20%24l%5E%5Cprime_i%2C%20r%5E%5Cprime_i%20%5Cin%20S%24%E3%80%82%0A-%20%E7%9B%B4%E6%8E%A5%E6%9F%A5%E8%A1%A8%E5%BE%97%E7%9F%A5%20%24%5Bl%5E%5Cprime_i%2C%20r%5E%5Cprime_i%5D%24%20%E7%9A%84%E7%AD%94%E6%A1%88%E3%80%82%0A-%20%E4%B8%80%E5%80%8B%E6%95%B8%E5%AD%97%E5%9C%A8%20%24(l%5E%5Cprime_i%2C%20r%5E%5Cprime_i%5D%24%20%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E7%AD%89%E6%96%BC%20%24%5B1%2C%20r%5E%5Cprime_i%5D%24%20%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%20XOR%20%24%5B1%2C%20l%5E%5Cprime_i%5D%24%20%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E3%80%82%0A-%20%24%5Cleft%7Cl_i%20-%20l%5E%5Cprime_i%5Cright%7C%20%5Cle%20k%24%20%E4%B8%94%20%24%5Cleft%7Cr_i%20-%20r%5E%5Cprime_i%5Cright%7C%20%5Cle%20k%24%E3%80%82%0A%0A%E4%BB%BF%E9%80%A0%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%E7%A7%BB%E5%8B%95%E5%8D%80%E9%96%93%E7%9A%84%E7%B6%AD%E8%AD%B7%E6%96%B9%E5%BC%8F%E5%8F%AF%E4%BB%A5%E5%9C%A8%20%24O(k)%24%20%E6%99%82%E9%96%93%E5%85%A7%E5%9B%9E%E7%AD%94%E4%B8%80%E6%AC%A1%E8%A9%A2%E5%95%8F%E3%80%82%0A%0A%E5%8F%96%20%24k%20%3D%20O(%5Csqrt%7Bn%7D)%24%EF%BC%8C%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%20%24O((n%20%2B%20q)%5Csqrt%7Bn%7D)%24%20%E7%9A%84%E6%BC%94%E7%AE%97%E6%B3%95%E3%80%82%E7%B5%90%E5%90%88%20D.1.2%20%E5%BE%8C%E5%95%8F%E9%A1%8C%20D.1%20%E7%9A%84%E5%9C%A8%E7%B7%9A%E7%89%88%E6%9C%AC%E4%B9%9F%E8%A2%AB%E8%A7%A3%E6%B1%BA%E4%BA%86%E3%80%82%0A%0A%23%23%23%23%20%E8%A7%80%E5%AF%9F%E8%88%87%E7%B5%90%E8%AB%96%0A-%20%E5%A6%82%E6%9E%9C%E5%8E%9F%E9%A1%8C%E5%8F%AF%E4%BB%A5%E9%9B%A2%E7%B7%9A%EF%BC%8C%E4%BC%BC%E4%B9%8E%E4%B9%9F%E8%83%BD%5B%E5%9C%A8%E6%A8%B9%E4%B8%8A%E4%BD%BF%E7%94%A8%E8%8E%AB%E9%9A%8A%E7%AE%97%E6%B3%95%5D(https%3A%2F%2Fwww.cnblogs.com%2Fzwfymqz%2Fp%2F9223425.html)%EF%BC%9F%0A-%20%E5%8F%AF%E4%BB%A5%E7%94%A8%E9%A1%9E%E4%BC%BC%20D.1.3%20%E7%9A%84%E6%96%B9%E6%B3%95%E8%A7%A3%E6%B1%BA%E5%8E%9F%E9%A1%8C%E3%80%82%0A-%20%E5%A6%82%20D.1.3%EF%BC%8CD%20%E5%AE%98%E8%A7%A3%E7%9A%84%E7%A9%BA%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E4%B9%9F%E6%98%AF%20%24O(n%5Csqrt%7Bn%7D)%24%E3%80%82%E9%9B%96%E7%84%B6%E9%80%99%E9%A1%8C%E4%B8%A6%E6%9C%AA%E7%89%B9%E5%88%A5%E9%99%90%E5%88%B6%E8%A8%98%E6%86%B6%E9%AB%94%E7%94%A8%E9%87%8F%EF%BC%8C%E4%BD%86%E9%80%99%E8%A3%A1%E6%9A%97%E7%A4%BA%E4%BA%86%E4%B8%80%E5%80%8B%E5%9C%A8%E7%A9%BA%E9%96%93%E4%B8%8A%E6%9B%B4%E6%9C%89%E6%95%88%E7%8E%87%E7%9A%84%E4%BD%9C%E6%B3%95%EF%B8%B0%E5%A6%82%E6%9E%9C%E5%84%B2%E5%AD%98%E7%9A%84%E8%B3%87%E8%A8%8A%E6%98%AF%20%60bool%60%20%E8%80%8C%E9%9D%9E%20%60int%60%20%EF%BC%8C%E7%94%A8%20%60std%3A%3Abitset%60%20%E5%AF%A6%E4%BD%9C%E5%8F%AA%E9%9C%80%E8%A6%81%20%24%5Cfrac%7B1%7D%7B32%7D%24%20%E7%9A%84%E5%84%B2%E5%AD%98%E7%A9%BA%E9%96%93%E3%80%82%0A%0A%23%23%23%20D.2%20%E6%A8%B9%E4%B8%8A%E5%88%86%E5%A1%8A%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D%3A%20%E8%A9%A2%E5%95%8F%E6%A8%B9%E4%B8%8A%E5%85%A9%E9%BB%9E%20%24u%2C%20v%24%20%E9%96%93%E8%B7%AF%E5%BE%91%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%81%B6%E6%95%B8%E6%AC%A1%E3%80%82%0A%3A%3A%3A%0A%0A%E5%BE%9E%E6%9A%B4%E5%8A%9B%E7%9A%84%E4%BD%9C%E6%B3%95%E9%96%8B%E5%A7%8B%E7%99%BC%E6%83%B3%EF%B8%B0%E5%88%86%E5%88%A5%E5%BE%9E%20%24u%2C%20v%24%20%E9%96%8B%E5%A7%8B%E5%BE%80%E4%B8%8A%E7%88%AC%E5%88%B0%20%24lca(u%2C%20v)%24%EF%BC%8C%E7%B5%B1%E8%A8%88%E6%B2%BF%E9%80%94%E6%95%B8%E5%AD%97%E7%9A%84%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E3%80%82%E9%80%99%E6%A8%A3%E4%B8%80%E6%AC%A1%E8%A9%A2%E5%95%8F%E9%9C%80%E8%A6%81%20%24O(n)%24%20%E7%9A%84%E8%A8%88%E7%AE%97%E6%99%82%E9%96%93%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E8%83%BD%E5%83%8F%20D.1.3%20%E4%B8%80%E6%A8%A3%E6%89%BE%E5%88%B0%E9%9B%86%E5%90%88%20%24S%24%20%E4%BD%BF%E5%BE%97%20%24u%2C%20v%24%20%E5%BE%80%E4%B8%8A%E7%88%AC%E4%B8%8D%E8%B6%85%E9%81%8E%20%24%5Csqrt%7Bn%7D%24%20%E6%AC%A1%E5%B0%B1%E6%9C%83%E8%90%BD%E5%9C%A8%20%24S%24%20%E5%85%A7%EF%BC%8C%E8%AA%AA%E4%B8%8D%E5%AE%9A%E5%B0%B1%E8%83%BD%E5%9C%A8%20%24O(%5Csqrt%7Bn%7D)%24%20%E7%9A%84%E6%99%82%E9%96%93%E5%85%A7%E5%9B%9E%E7%AD%94%E8%A9%A2%E5%95%8F%E3%80%82%0A%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D.2%3A%20%E7%B5%A6%E5%AE%9A%E4%B8%80%E6%A3%B5%20%24n%24%20%E5%80%8B%E7%99%BD%E9%BB%9E%E9%80%A3%E6%88%90%E7%9A%84%E6%9C%89%E6%A0%B9%E6%A8%B9%E5%92%8C%E4%B8%80%E5%80%8B%E5%B8%B8%E6%95%B8%20%24k%24%EF%BC%8C%E5%B0%87%E7%9B%A1%E5%8F%AF%E8%83%BD%E5%B0%91%E7%9A%84%E9%BB%9E%E5%A1%97%E9%BB%91%EF%BC%8C%E4%BD%BF%E5%BE%97%E6%AF%8F%E5%80%8B%E7%99%BD%E9%BB%9E%E5%BE%80%E6%A0%B9%E7%AF%80%E9%BB%9E%E8%B5%B0%E8%87%B3%E5%A4%9A%20%24k%24%20%E6%A2%9D%E9%82%8A%E5%BE%8C%E8%83%BD%E7%A2%B0%E5%88%B0%E9%BB%91%E9%BB%9E%E3%80%82%0A%3A%3A%3A%0A%0A%E7%94%A8%20greedy%20%E8%A7%A3%E6%B1%BA%20D.2%EF%B8%B0%0A%0A1.%20%E6%8C%89%E7%85%A7%E5%BE%8C%E5%BA%8F%E8%80%83%E6%85%AE%E6%89%80%E6%9C%89%E7%AF%80%E9%BB%9E%E3%80%82%0A%20%20%20%20-%20%E4%BB%A4%E7%95%B6%E4%B8%8B%E8%80%83%E6%85%AE%E7%9A%84%E7%AF%80%E9%BB%9E%E7%82%BA%20%24u%24%20%E3%80%82%E8%8B%A5%20%24u%24%20%E7%9A%84%E5%AD%90%E6%A8%B9%E5%85%A7%E5%AD%98%E5%9C%A8%E7%99%BD%E9%BB%9E%20%24v%24%20%E6%BB%BF%E8%B6%B3%20%24v%24%20%E5%88%B0%20%24u%24%20%E7%9A%84%E8%B7%AF%E5%BE%91%E4%B8%8A%E9%83%BD%E6%98%AF%E7%99%BD%E9%BB%9E%EF%BC%8C%E4%B8%94%20%24u%2C%20v%24%20%E7%9A%84%E8%B7%9D%E9%9B%A2%E6%81%B0%E5%A5%BD%E6%98%AF%20%24k%24%EF%BC%8C%E5%B0%87%20%24v%24%20%E5%A1%97%E9%BB%91%E3%80%82%0A2.%20%E5%B0%87%E6%A0%B9%E7%AF%80%E9%BB%9E%E5%A1%97%E9%BB%91%E3%80%82%0A%0A%E6%AD%A4%E6%99%82%E9%BB%91%E9%BB%9E%E7%9A%84%E9%9B%86%E5%90%88%E4%BE%BF%E6%98%AF%E6%88%91%E5%80%91%E9%9C%80%E8%A6%81%E7%9A%84%20%24S%24%EF%BC%8C%E6%AF%8F%E5%80%8B%E9%BB%91%E9%BB%9E%E4%BB%A3%E8%A1%A8%E6%A8%B9%E4%B8%8A%E7%9A%84%E4%B8%80%E5%80%8B%E3%80%8C%E5%A1%8A%E3%80%8D%EF%BC%8C%E7%99%BD%E9%BB%9E%E5%92%8C%E5%BE%80%E6%A0%B9%E7%AF%80%E9%BB%9E%E8%B5%B0%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%A2%B0%E5%88%B0%E7%9A%84%E9%BB%91%E9%BB%9E%E5%88%86%E5%9C%A8%E5%90%8C%E4%B8%80%E5%A1%8A%E3%80%82%0A%0A%E9%99%A4%E4%BA%86%E6%A0%B9%E7%AF%80%E9%BB%9E%E5%A4%96%EF%BC%8C%E6%AF%8F%E5%A1%97%E9%BB%91%E4%B8%80%E5%80%8B%E9%BB%9E%E8%87%B3%E5%B0%91%E6%9C%83%E6%B1%BA%E5%AE%9A%20%24k%24%20%E5%80%8B%E7%99%BD%E9%BB%9E%E7%9A%84%E6%AD%B8%E5%B1%AC%EF%BC%8C%E5%9B%A0%E6%AD%A4%20%24S%24%20%E7%9A%84%E5%A4%A7%E5%B0%8F%E4%B8%8D%E8%B6%85%E9%81%8E%20%24%5Cfrac%7Bn%7D%7Bk%7D%20%2B%201%24%E3%80%82%E9%80%99%E7%A8%AE%E5%88%86%E5%A1%8A%E6%96%B9%E5%BC%8F%E4%B8%8D%E8%83%BD%E4%BF%9D%E8%AD%89%E5%A1%8A%E7%9A%84%E5%A4%A7%E5%B0%8F%EF%BC%8C%E5%8F%AA%E7%A2%BA%E4%BF%9D%E6%AF%8F%E4%B8%80%E5%A1%8A%E7%9A%84%E7%9B%B4%E5%BE%91%E4%B8%8D%E8%B6%85%E9%81%8E%20%242k%24%E3%80%82%0A%0A%23%23%23%20D.3%20%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C%20D%20...%20%3F%0A%0A%3A%3A%3Ainfo%0A%E5%95%8F%E9%A1%8C%20D%3A%20%E7%B5%A6%E5%AE%9A%E4%B8%80%E6%A3%B5%E6%A8%B9%E5%92%8C%E9%BB%9E%E4%B8%8A%E7%9A%84%E6%95%B8%E5%AD%97%20%24a_1%2C%20a_2%2C%20%5Ccdots%2C%20a_n%24%EF%BC%8C%24q%24%20%E6%AC%A1%E8%A9%A2%E5%95%8F%E6%A8%B9%E4%B8%8A%E5%85%A9%E9%BB%9E%20%24u_i%2C%20v_i%24%20%E9%96%93%E8%B7%AF%E5%BE%91%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE%E5%81%B6%E6%95%B8%E6%AC%A1%E3%80%82%0A%3A%3A%3A%0A%0A%E4%BB%A4%20%241%24%20%E7%82%BA%E6%A0%B9%E7%AF%80%E9%BB%9E%E3%80%82%0A%0AD.3.1%3A%20%E4%BB%BF%E7%85%A7%20D.1.3%20%EF%BC%8C%E5%B0%8D%E6%96%BC%E6%89%80%E6%9C%89%20%24p%20%5Cin%20S%24%EF%BC%8C%E7%B4%80%E9%8C%84%E6%AF%8F%E4%B8%80%E7%A8%AE%E6%95%B8%E5%AD%97%E5%9C%A8%20%241%24%20%E5%88%B0%20%24p%24%20%E8%B7%AF%E5%BE%91%E4%B8%8A%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E3%80%82%0A%0AD.3.2%3A%20%E5%B0%8D%E6%96%BC%E6%89%80%E6%9C%89%20%24p_1%2C%20p_2%20%5Cin%20S%24%EF%BC%8C%E9%A0%90%E5%85%88%E8%A8%88%E7%AE%97%20%24%5Bp_1%2C%20p_2%5D%24%20%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%95%B8%E5%AD%97%E5%87%BA%E7%8F%BE**%E5%81%B6**%E6%95%B8%E6%AC%A1%EF%BC%88%240%24%20%E4%B8%8D%E7%AE%97%E5%9C%A8%E5%85%A7%EF%BC%89%E3%80%82%E4%BD%9C%E6%B3%95%E6%98%AF%E6%9E%9A%E8%88%89%20%24p_1%24%EF%BC%8C%E4%BB%A4%20%24p_1%24%20%E7%82%BA%E6%96%B0%E7%9A%84%E6%A0%B9%E7%AF%80%E9%BB%9E%EF%BC%8C%E8%B7%91%E4%B8%80%E6%AC%A1%20DFS%20%E7%AE%97%E5%87%BA%E6%89%80%E6%9C%89%20%24p_2%24%20%E5%B0%8D%E6%87%89%E7%9A%84%E7%AD%94%E6%A1%88%E3%80%82%E7%B8%BD%E8%8A%B1%E8%B2%BB%E6%99%82%E9%96%93%E6%98%AF%20%24%7CS%7C%24%20%E6%AC%A1%20DFS%20%3D%20%24O(n%5Csqrt%7Bn%7D)%24%E3%80%82%0A%0AD.3.3%3A%20%E4%B8%8A%E9%9D%A2%E7%9A%84%20DFS%20%E9%82%84%E6%9C%89%E9%A1%8D%E5%A4%96%E9%9C%80%E8%A6%81%E7%B4%80%E9%8C%84%E7%9A%84%E6%9D%B1%E8%A5%BF%EF%B8%B0%E5%B0%8D%E6%96%BC%20%241%20%5Cle%20i%20%5Cle%20n%24%EF%BC%8C%24a_i%24%20%E6%98%AF%E5%90%A6%E5%9C%A8%20%24p_1%24%20%E8%B5%B0%E5%88%B0%20%24i%24%20%E7%9A%84%E8%B7%AF%E4%B8%8A%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%87%BA%E7%8F%BE%E3%80%82%0A%0A%E4%BB%A4%20%24u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%24%20%E7%82%BA%20%24u_i%2C%20v_i%24%20%E5%B0%8D%E6%87%89%E7%9A%84%E9%BB%91%E9%BB%9E%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%88%86%E6%88%90%E4%BB%A5%E4%B8%8B%E4%B8%89%E7%A8%AE%E6%83%85%E6%B3%81%EF%B8%B0%0A%0A%23%23%23%23%20Case%201%3A%20%24u%5E%5Cprime_i%20%3D%20v%5E%5Cprime_i%24%0A%24u_i%2C%20v_i%24%20%E5%B1%AC%E6%96%BC%E5%90%8C%E5%A1%8A%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%9A%B4%E5%8A%9B%E7%AE%97%E7%AD%94%E6%A1%88%E3%80%82%0A%0A%23%23%23%23%20Case%202%3A%20%24u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%24%20%E6%9C%89%E4%B8%80%E5%80%8B%E6%98%AF%E5%8F%A6%E4%B8%80%E5%80%8B%E7%9A%84%E7%A5%96%E5%85%88%0A%E6%AD%A4%E6%99%82%20%24u_i%2C%20u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%2C%20v_i%24%20%E5%8F%AF%E8%83%BD%E4%B8%8D%E6%9C%83%E6%8C%89%E9%A0%86%E5%BA%8F%E5%BD%A2%E6%88%90%E4%B8%80%E6%A2%9D%E9%8F%88%E3%80%82%0A%0A%E4%B8%8D%E5%A4%B1%E4%B8%80%E8%88%AC%E6%80%A7%E5%81%87%E8%A8%AD%20%24v%5E%5Cprime_i%24%20%E6%98%AF%20%24u%5E%5Cprime_i%24%20%E7%9A%84%E7%A5%96%E5%85%88%EF%BC%8C%E5%B0%87%20%24v%5E%5Cprime_i%24%20%E5%BE%80%20%24u%5E%5Cprime_i%24%20%E6%96%B9%E5%90%91%E9%80%80%E4%B8%80%E5%80%8B%E9%BB%91%E9%BB%9E%E3%80%82%E5%AF%A6%E4%BD%9C%E4%B8%8A%E5%8F%AF%E4%BB%A5%E9%A0%90%E8%99%95%E7%90%86%E6%AF%8F%E5%80%8B%E9%BB%91%E9%BB%9E%E5%BE%80%E4%B8%8A%E8%B5%B0%E7%A2%B0%E5%88%B0%E7%9A%84%E4%B8%8B%E5%80%8B%E9%BB%91%E9%BB%9E%EF%BC%8C%E6%94%B9%E7%94%B1%20%24u%5E%5Cprime_i%24%20%E5%BE%80%E4%B8%8A%E8%B7%B3%E6%89%BE%E5%87%BA%E6%96%B0%E7%9A%84%20%24v%5E%5Cprime_i%24%20%EF%BC%8C%E8%8A%B1%E8%B2%BB%E6%99%82%E9%96%93%E5%8F%96%E6%B1%BA%E6%96%BC%E9%BB%91%E9%BB%9E%E6%95%B8%E9%87%8F%20%3D%20%24O(%5Csqrt%7Bn%7D)%24%E3%80%82%0A%0A%E6%AD%A4%E6%99%82%20%24u_i%2C%20u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%2C%20v_i%24%20%E6%8C%89%E9%A0%86%E5%BA%8F%E5%BD%A2%E6%88%90%E4%B8%80%E6%A2%9D%E9%8F%88%EF%BC%8C%24v%5E%5Cprime_i%24%20%E4%B8%8D%E5%86%8D%E6%98%AF%20%24v_i%24%20%E7%9A%84%E7%A5%96%E5%85%88%E3%80%82%0A%0A%23%23%23%23%20Case%203%3A%20%E5%89%A9%E4%B8%8B%E7%9A%84%E6%83%85%E6%B3%81%0A%E6%AD%A4%E6%99%82%20%24u_i%2C%20u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%2C%20v_i%24%20%E6%8C%89%E9%A0%86%E5%BA%8F%E5%BD%A2%E6%88%90%E4%B8%80%E6%A2%9D%E9%8F%88%EF%BC%8C%E8%80%8C%E4%B8%94%20%24lca(u_i%2C%20v_i)%20%3D%20lca(u%5E%5Cprime_i%2C%20v%5E%5Cprime_i)%24%E3%80%82%0A%0A%E5%B0%8D%E6%96%BC%20Case%202%2C%203%EF%BC%8C%E5%88%86%E5%A1%8A%E7%9A%84%E6%80%A7%E8%B3%AA%E4%BF%9D%E8%AD%89%20%24u_i%24%20%E5%88%B0%20%24u%5E%5Cprime_i%24%20%E5%8A%A0%E4%B8%8A%20%24v%5E%5Cprime_i%24%20%E5%88%B0%20%24v_i%24%20%E7%9A%84%E8%B7%AF%E5%BE%91%E9%95%B7%E6%98%AF%20%24O(%5Csqrt%7Bn%7D)%24%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E6%9A%B4%E5%8A%9B%E8%80%83%E6%85%AE%E9%80%99%E5%85%A9%E6%AE%B5%E8%B7%AF%E5%BE%91%E4%B8%8A%E7%9A%84%E6%95%B8%E5%AD%97%E3%80%82%0A%0A%E9%A6%96%E5%85%88%E5%BE%9E%20D.3.2%20%E5%8F%96%E5%BE%97%20%24u%5E%5Cprime_i%24%20%E5%88%B0%20%24v%5E%5Cprime_i%24%20%E7%9A%84%E7%AD%94%E6%A1%88%E3%80%82%0A%0A%E5%B0%8D%E6%96%BC%20%24v%5E%5Cprime_i%24%20%E5%88%B0%20%24v_i%24%20%E7%9A%84%E4%BD%8D%E7%BD%AE%20%24j%24%EF%BC%8C%20D.3.3%20%E5%9C%A8%20%24p_1%20%3D%20u%5E%5Cprime_i%24%20%E7%9A%84%E7%B4%80%E9%8C%84%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%BE%86%E5%9B%9E%E7%AD%94%20%24a_j%24%20%E6%98%AF%E5%90%A6%E6%9C%AA%E6%9B%BE%E5%9C%A8%20%24u%5E%5Cprime_i%24%20%E5%88%B0%20%24v%5E%5Cprime_i%24%20%E5%87%BA%E7%8F%BE%E3%80%82%24u%5E%5Cprime_i%24%20%E5%88%B0%20%24u_i%24%20%E5%90%8C%E7%90%86%E3%80%82%0A%0A%E5%B0%87%20D.3.1%20%E5%B0%8D%E6%96%BC%20%24u%5E%5Cprime_i%24%20%E5%92%8C%20%24v%5E%5Cprime_i%24%20%E7%9A%84%E7%B4%80%E9%8C%84%E9%80%B2%E8%A1%8C%20XOR%20%E9%81%8B%E7%AE%97%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E6%95%B8%E5%AD%97%E5%9C%A8%20%24u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%24%20%E8%B7%AF%E5%BE%91%E4%B8%8A%E5%87%BA%E7%8F%BE%E6%AC%A1%E6%95%B8%E7%9A%84%E5%A5%87%E5%81%B6%E6%80%A7%E3%80%82%E8%A8%98%E5%BE%97%E5%B0%87%20%24lca(u%5E%5Cprime_i%2C%20v%5E%5Cprime_i)%24%20%EF%BC%88%E4%B8%8D%E6%98%AF%20%24lca(u_i%2C%20v_i)%24%EF%BC%89%E7%9A%84%E5%BD%B1%E9%9F%BF%E5%8A%A0%E5%9B%9E%E3%80%82%0A%0A%E4%BB%94%E7%B4%B0%E7%AE%97%E4%B8%80%E4%B8%8B%E5%A5%87%E5%81%B6%E6%80%A7%EF%BC%8C%E5%B0%87%E6%96%B0%E6%95%B8%E5%AD%97%E5%92%8C%20%24u%5E%5Cprime_i%2C%20v%5E%5Cprime_i%24%20%E8%B7%AF%E5%BE%91%E4%B8%8A%E6%9C%AC%E4%BE%86%E5%B0%B1%E6%9C%89%E7%9A%84%E6%95%B8%E5%AD%97%E5%88%86%E9%96%8B%E8%99%95%E7%90%86%EF%BC%8C%E9%80%99%E9%A1%8C%E5%B0%B1%E8%A2%AB%E6%88%91%E5%80%91%E8%A7%A3%E6%B1%BA%E4%BA%86%EF%BC%81%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E6%98%AF%20%24O((n%2Bq)%5Csqrt%7Bn%7D)%24%EF%BC%8C%E7%A9%BA%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E6%98%AF%20%24O(n%5Csqrt%7Bn%7D)%24%E3%80%82%0A%0A%23%23%23%20D.4%20%E5%BF%AB%E5%8F%96%E5%84%AA%E5%8C%96%0A%0A%E4%B8%8D%E9%81%8E%E4%BA%8B%E6%83%85%E5%85%B6%E5%AF%A6%E9%82%84%E6%B2%92%E7%B5%90%E6%9D%9F%EF%BC%8C%E7%95%B6%E4%BD%A0%E7%B5%82%E6%96%BC%E5%AF%AB%E5%AE%8C%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%81%9A%E6%B3%95%EF%BC%8C%E4%B8%8A%E5%82%B3%E5%BE%8C%E5%BE%88%E5%8F%AF%E8%83%BD%E6%9C%83%E6%8B%BF%E5%88%B0%E4%B8%80%E5%80%8B%20TLE%E3%80%82%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E7%B5%82%E7%A9%B6%E5%8F%AA%E8%A1%A8%E7%A4%BA%E4%BA%86%E6%BC%B8%E9%80%B2%E8%A1%8C%E7%82%BA%EF%BC%8C%E4%B8%A6%E6%9C%AA%E8%80%83%E6%85%AE%20%24(n%2Bq)%5Csqrt%7Bn%7D%24%20%E5%89%8D%E9%9D%A2%E7%9A%84%E5%B8%B8%E6%95%B8%E3%80%82%E9%A0%88%E7%9F%A5%20~~NCPC%20%E8%B3%BD%E4%B8%AD%20O(n%5E3%20%2F%20w)%20%E5%9C%A8%20n%20%3D%201e4%20%E6%99%82%E5%8F%AF%E4%BB%A5%201%20%E7%A7%92%E5%85%A7%E8%B7%91%E5%AE%8C~~%20%E5%9C%A8%E5%BF%AB%E5%8F%96%E7%9A%84%E5%BD%B1%E9%9F%BF%E4%B8%8B%EF%BC%8C%E5%BE%AA%E5%BA%8F%E5%AD%98%E5%8F%96%E6%9C%83%E6%AF%94%E9%9A%A8%E6%A9%9F%E5%AD%98%E5%8F%96%E4%BE%86%E7%9A%84%E6%9C%89%E6%95%88%E7%8E%87%EF%BC%8C%E9%80%99%E4%B9%9F%E6%98%AF%E6%A8%B9%E5%92%8C%E5%BA%8F%E5%88%97%E7%9A%84%E4%B8%80%E5%A4%A7%E5%B7%AE%E7%95%B0%EF%B8%B0%E5%BA%8F%E5%88%97%E4%B8%8A%E7%9A%84%E5%88%86%E5%A1%8A%EF%BC%88%E6%88%96%E8%8E%AB%E9%9A%8A%EF%BC%89%EF%BC%8C%E7%A7%BB%E5%8B%95%E5%8D%80%E9%96%93%E6%99%82%E5%AD%98%E5%8F%96%E7%9A%84%E7%B4%A2%E5%BC%95%E7%B8%BD%E6%98%AF%E9%80%A3%E7%BA%8C%E7%9A%84%EF%BC%8C%E8%80%8C%E6%A8%B9%E4%B8%8A%E7%A7%BB%E5%8B%95%E6%99%82%E7%A2%B0%E5%88%B0%E7%9A%84%E9%BB%9E%E7%B7%A8%E8%99%9F%E6%AF%AB%E7%84%A1%E8%A6%8F%E5%BE%8B%E3%80%82%0A%0A%E6%88%91%E5%80%91%E5%B8%8C%E6%9C%9B%E6%89%BE%E5%88%B0%E4%B8%80%E7%A8%AE%E5%B0%8D%E9%BB%9E%E9%87%8D%E6%96%B0%E7%B7%A8%E8%99%9F%E7%9A%84%E6%96%B9%E5%BC%8F%E4%BD%BF%E5%BE%97%20%24u_i%2C%20v_i%24%20%E5%BE%80%E4%B8%8A%E7%A7%BB%E5%8B%95%E7%9A%84%E9%81%8E%E7%A8%8B%E4%B8%AD%E7%A2%B0%E5%88%B0%E7%9A%84%E9%BB%9E%E7%B7%A8%E8%99%9F%E7%9B%A1%E5%8F%AF%E8%83%BD%E9%80%A3%E7%BA%8C%EF%B8%B0%E5%88%A9%E7%94%A8%5B%E6%A8%B9%E9%8F%88%E5%89%96%E5%88%86%5D(https%3A%2F%2Foi-wiki.org%2Fgraph%2Fhld%2F)%EF%BC%8C%E5%B0%8D%E6%96%BC%E5%90%8C%E4%B8%80%E6%A2%9D%E9%8F%88%E4%B8%8A%E7%9A%84%E9%BB%9E%E5%88%86%E9%85%8D%E9%80%A3%E7%BA%8C%E7%9A%84%E7%B7%A8%E8%99%9F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BF%9D%E8%AD%89%E5%BE%80%E4%B8%8A%E7%A7%BB%E5%8B%95%E6%99%82%E8%87%B3%E5%A4%9A%E7%B6%93%E9%81%8E%20%24O(%5Clog%20n)%24%20%E5%80%8B%E9%80%A3%E7%BA%8C%E5%8D%80%E9%96%93%E3%80%82%0A%0AD.4%20%E7%9A%84%E5%84%AA%E5%8C%96%E5%9C%A8%E5%87%BA%E9%A1%8C%E8%80%85%E9%9B%BB%E8%85%A6%E4%B8%8A%E5%B0%8D%E6%99%82%E9%96%93%E7%9A%84%E5%BD%B1%E9%9F%BF%E7%B4%84%E7%82%BA%203%20%E5%80%8D%E3%80%82%0A%0A%23%23%20Problem%20E.%20Er%20Wei%20Shu%20Dian%20%5Bwater%5D%0A%0A%E6%B3%A8%E6%84%8F%E5%88%B0%E9%80%99%E9%A1%8C%E5%95%8F%E4%BA%86%E7%B8%BD%E5%92%8C%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E5%BA%A7%E6%A8%99%E7%9A%84%20%24x%24%20%E5%92%8C%20%24y%24%20%E5%85%A8%E9%83%A8%E7%9B%B8%E7%95%B0%EF%BC%8C%E9%82%A3%E4%BB%BB%E4%B8%80%E5%B0%8D%E9%BB%9E%E5%B0%8D%E9%83%BD%E6%9C%83%E8%B2%A2%E7%8D%BB%E9%80%B2%E7%B8%BD%E5%92%8C%E8%A3%A1%EF%BC%88%24y%24%20%E6%AF%94%E8%BC%83%E5%B0%8F%E7%9A%84%E6%9C%83%E7%AE%97%E5%88%B0%EF%BC%89%0A%0A%E5%9B%A0%E6%AD%A4%E8%80%83%E6%85%AE%E5%BE%9E%20%24C%5EN_2%24%20%E9%96%8B%E5%A7%8B%E6%89%A3%EF%BC%8C%24x%24%20%E5%BA%A7%E6%A8%99%E4%B8%80%E6%A8%A3%E7%9A%84%20%24k%24%20%E5%80%8B%E9%BB%9E%E6%9C%83%E5%A4%9A%E7%AE%97%E5%88%B0%20%24C%5Ek_2%24%20%E6%AC%A1%E3%80%81%24y%24%20%E5%BA%A7%E6%A8%99%E4%B8%80%E6%A8%A3%E7%9A%84%E4%B9%9F%E6%98%AF%EF%BC%8C%E6%9C%80%E5%BE%8C%E8%A6%81%E6%8A%8A%E9%87%8D%E5%90%88%E7%9A%84%E9%BB%9E%E5%A4%9A%E6%89%A3%E7%9A%84%E9%87%8F%E5%8A%A0%E5%9B%9E%E4%BE%86%E3%80%82%0A%0A%E6%95%B4%E9%AB%94%E8%A4%87%E9%9B%9C%E5%BA%A6%E5%B0%B1%E6%98%AF%E8%A8%88%E7%AE%97%E5%BA%A7%E6%A8%99%E7%9B%B8%E5%90%8C%E9%BB%9E%E7%9A%84%E6%99%82%E9%96%93%EF%BC%8C%E9%80%99%E9%83%A8%E5%88%86%E6%88%91%E5%80%91%E7%94%A8%20%60std%3A%3Amap%60%20%E5%AF%A6%E4%BD%9C%20%24O(N%5Clog%20N)%24%20%E7%9A%84%E8%A7%A3%E7%AD%94%E5%8F%AF%E4%BB%A5%E5%9C%A8%E8%B3%BD%E4%B8%AD%E7%94%A8%200.31s%20%E8%B7%91%E5%AE%8C%EF%BC%8C%E4%BD%86%E5%A5%BD%E5%83%8F%E6%9C%89%E4%BA%BA%E9%82%84%E6%98%AF%E8%A2%AB%E5%8D%A1%E5%B8%B8%E4%BA%86%EF%BC%8C%E6%88%91%E5%80%91%E5%BE%88%E6%8A%B1%E6%AD%89%20QQ%0A%0A%23%23%20Problem%20F.%20Fake%20Solution%20%5Beasy%5D%0A%E5%B0%8D%E6%96%BC%E4%B8%80%E5%80%8B%E6%93%8D%E4%BD%9C%20%24(a_i%2Cj)%24%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%8E%9F%E6%9C%AC%20%24a_i%24%20%E7%AC%AC%20%24j%24%20%E5%80%8B%20bit%20%E6%98%AF%201%EF%BC%8C%E9%82%A3%E9%BA%BC%E4%B8%8D%E6%9C%83%E6%9C%89%E4%BB%BB%E4%BD%95%E5%BD%B1%E9%9F%BF%EF%BC%9B%E5%90%A6%E5%89%87%E6%9C%83%E6%8A%8A%20%24j%24%20%E7%9B%B4%E5%88%B0%20%24j%24%20%E4%BB%A5%E4%B8%8A%E7%9A%84%E7%AC%AC%E4%B8%80%E5%80%8B%201%20%E4%BB%A5%E5%89%8D%E7%9A%84%200%20%E9%83%BD%E8%AE%8A%E6%88%90%201%E3%80%82%0A%E5%9B%A0%E6%AD%A4%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E7%9F%A5%E9%81%93%E7%AD%94%E6%A1%88%E4%B8%80%E5%AE%9A%E6%98%AF%20%242%5Ep%20-%201%24%20%E5%85%B6%E4%B8%AD%20%24p%24%20%E6%98%AF%E6%89%80%E6%9C%89%20%24a_i%24%20%E7%95%B6%E4%B8%AD%E6%9C%80%E9%AB%98%E4%BD%8D%E6%9C%80%E5%A4%A7%E5%80%BC%E3%80%82%0A%E6%8E%A5%E8%91%97%E8%A6%81%E8%A8%88%E7%AE%97%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E6%AD%A5%E6%95%B8%EF%BC%8C%E6%88%91%E5%80%91%E5%85%88%E8%A8%88%E7%AE%97%E5%87%BA%E5%8E%9F%E6%9C%AC%E7%9A%84%20bitwise-or%20%E8%B7%9F%E6%9C%80%E5%A5%BD%E7%9A%84%E7%AD%94%E6%A1%88%E5%B7%AE%E4%BA%86%E5%93%AA%E4%BA%9B%20bit%EF%BC%8C%E7%84%B6%E5%BE%8C%E6%88%91%E5%80%91%E7%9A%84%E7%9B%AE%E6%A8%99%E5%B0%B1%E6%98%AF%E7%94%A8%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C%E8%AE%93%E9%80%99%E4%BA%9B%20bit%20%E8%A2%AB%E8%93%8B%E4%BD%8F%EF%BC%8C%E6%88%91%E5%80%91%E4%B8%80%E6%AC%A1%E6%93%8D%E4%BD%9C%E5%8F%AF%E4%BB%A5%E8%93%8B%E6%8E%89%E7%9A%84%E7%9B%AE%E6%A8%99%E5%B0%B1%E6%98%AF%E4%B8%80%E5%80%8B%20%24a_i%24%20%E7%9A%84%E4%BA%8C%E9%80%B2%E4%BD%8D%E8%A1%A8%E7%A4%BA%E7%9A%84%E4%B8%80%E6%AE%B5%E9%80%A3%E7%BA%8C%200%20%E6%89%80%E5%B0%8D%E6%87%89%E7%9A%84%E5%8D%80%E9%96%93%E3%80%82%E9%81%B8%E6%93%87%E4%B8%80%E4%BA%9B%E5%8D%80%E9%96%93%E4%BD%BF%E5%BE%97%E6%89%80%E6%9C%89%E7%B5%A6%E5%AE%9A%E9%BB%9E%E9%83%BD%E8%A2%AB%E8%87%B3%E5%B0%91%E4%B8%80%E5%80%8B%E5%8D%80%E9%96%93%E8%A6%86%E8%93%8B%E6%98%AF%E4%B8%80%E5%80%8B%E7%B6%93%E5%85%B8%E8%B2%AA%E5%BF%83%E6%88%96%E5%8B%95%E6%85%8B%E8%A6%8F%E5%8A%83%E5%95%8F%E9%A1%8C%EF%BC%8C%E5%85%B6%E4%B8%AD%E4%B8%80%E5%80%8B%E4%BD%9C%E6%B3%95%E6%98%AF%E5%BE%9E%E5%8F%AF%E4%BB%A5%E8%93%8B%E4%BD%8F%E6%9C%80%E5%B7%A6%E9%82%8A%E7%9A%84%E9%BB%9E%E7%9A%84%E5%8D%80%E9%96%93%E7%95%B6%E4%B8%AD%E6%AF%8F%E6%AC%A1%E9%81%B8%E5%8F%B3%E7%95%8C%E6%9C%80%E5%A4%A7%E7%9A%84%E3%80%82%0A%E5%B0%8F%E5%BF%83%E4%B8%8D%E8%A6%81%E5%AF%AB%E6%88%90%201e6%20*%2030%5E2%20%E6%87%89%E8%A9%B2%E5%B0%B1%E6%9C%83%E9%81%8E%E4%BA%86%E3%80%82%0A%0A%23%23%20Problem%20G.%20Grouping%20Problem%20%5Bmid%5D%0A%0A%E9%A6%96%E5%85%88%E6%B3%A8%E6%84%8F%E5%88%B0%E8%A6%81%E5%88%86%E7%B5%84%E7%9A%84%E8%A9%B1%EF%BC%8C%E8%82%AF%E5%AE%9A%E6%98%AF%E5%BA%A7%E6%A8%99%E6%8E%92%E5%BA%8F%E5%BE%8C%E9%80%A3%E7%BA%8C%E7%9A%84%E4%BA%BA%E6%9C%83%E5%9C%A8%E5%90%8C%E4%B8%80%E7%B5%84%EF%BC%8C%E6%89%80%E4%BB%A5%E6%89%80%E6%9C%89%E7%B5%84%E5%88%A5%E6%9C%83%E5%B0%8D%E6%87%89%E5%88%B0%E8%8B%A5%E5%B9%B2%E5%80%8B%E4%BA%92%E6%96%A5%E7%9A%84%E9%80%A3%E7%BA%8C%E5%8D%80%E9%96%93%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%20%24a%5Cleq%20b%24%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%B3%A8%E6%84%8F%E5%88%B0%E4%B8%8D%E6%8A%8A%E4%BB%BB%E4%BD%95%E4%BA%BA%E5%88%86%E5%9C%A8%E5%90%8C%E4%B8%80%E7%B5%84%E8%82%AF%E5%AE%9A%E6%98%AF%E6%9C%80%E5%A5%BD%E7%9A%84%EF%BC%8C%E6%89%80%E4%BB%A5%20%24b%24%20%E8%AE%8A%E5%BE%97%E7%84%A1%E7%94%A8%E4%BA%86%EF%BC%8C%E9%80%99%E5%85%B6%E5%AF%A6%E9%80%80%E5%8C%96%E4%BA%86%E6%88%90%E4%B8%80%E5%80%8B%E5%BE%88%E5%96%AE%E7%B4%94%E7%9A%84%E6%9C%80%E5%B0%8F%E5%89%B2%E5%95%8F%E9%A1%8C%EF%BC%88%E7%95%99%E7%B5%A6%E8%AE%80%E8%80%85%E8%87%AA%E8%A1%8C%E7%B7%B4%E7%BF%92%EF%BC%89%E3%80%82%0A%0A%E4%BB%A5%E4%B8%8B%E5%81%87%E8%A8%AD%20%24a%3Eb%24%E3%80%82%0A%0A%E8%80%83%E6%85%AE%E6%9C%80%E5%B0%8F%E5%89%B2%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%80%BC%E5%9F%9F%E5%BE%88%E5%B0%8F%E7%9A%84%E8%A9%B1%EF%BC%8C%E5%B0%8D%E6%AF%8F%E5%80%8B%E3%80%8C%E5%BA%A7%E6%A8%99%E3%80%8D%E9%83%BD%E9%96%8B%E4%B8%80%E5%80%8B%E9%BB%9E%E3%80%8C%E5%BA%A7%E6%A8%99%20%24x%24%E3%80%8D%EF%BC%8C%E4%B9%9F%E5%B0%8D%E6%AF%8F%E5%80%8B%E4%BA%BA%E9%83%BD%E9%96%8B%E4%B8%80%E5%80%8B%E9%BB%9E%E3%80%8C%E4%BA%BA%20%24x%24%E3%80%8D%EF%BC%8C%E8%A1%A8%E7%A4%BA%E9%80%99%E5%80%8B%E4%BA%BA%E6%89%80%E5%9C%A8%E7%9A%84%E4%BD%8D%E7%BD%AE%E6%98%AF%20%24x%24%E3%80%82%E8%80%83%E6%85%AE%E5%88%86%E5%9C%A8%20%24S%24%20%E7%9A%84%E9%BB%9E%E4%BB%A3%E8%A1%A8%E4%B8%8D%E9%81%B8%EF%BC%8C%E5%88%86%E5%9C%A8%20%24T%24%20%E7%9A%84%E9%BB%9E%E4%BB%A3%E8%A1%A8%E8%A6%81%E9%81%B8%EF%BC%8C%E5%85%B6%E4%B8%AD%0A-%20%E3%80%8C%E5%BA%A7%E6%A8%99%20%24x%24%E3%80%8D%E9%81%B8%E7%9A%84%E6%84%8F%E7%BE%A9%E6%98%AF%E3%80%8C%E5%AD%98%E5%9C%A8%E4%B8%80%E5%80%8B%E7%B5%84%E5%88%A5%E7%9A%84%E5%8D%80%E9%96%93%20%24%5Bl%2C%20r%5D%24%E3%80%8D%E6%BB%BF%E8%B6%B3%20%24l%20%5Cleq%20x%20%5Cleq%20r%24%0A-%20%E3%80%8C%E4%BA%BA%E3%80%8D%E9%81%B8%E7%9A%84%E6%84%8F%E7%BE%A9%E6%98%AF%E9%80%99%E5%80%8B%E4%BA%BA%E6%B2%92%E6%9C%89%E8%A2%AB%E8%AB%8B%E8%B5%B0%0A%0A%E9%82%A3%E9%BA%BC%E6%9C%89%E4%BB%A5%E4%B8%8B%E9%99%90%E5%88%B6%EF%BC%9A%0A1.%20%E9%81%B8%E4%BA%86%E5%9C%A8%E5%BA%A7%E6%A8%99%20%24x%24%20%E7%9A%84%E4%BA%BA%EF%BC%8Cimply%20%E5%BA%A7%E6%A8%99%20%24x%24%20%E8%A6%81%E9%81%B8%0A%20%20%20%20-%20%E4%B9%9F%E5%B0%B1%E6%98%AF%20%E5%BA%A7%E6%A8%99%20%24x%24%20-%3E%20%E4%BA%BA%20%24x%24%EF%BC%8Ccost%20%E7%84%A1%E9%99%90%E5%A4%A7%0A2.%20%E4%B8%8D%E9%81%B8%E4%B8%80%E5%80%8B%E4%BA%BA%EF%BC%8Ccost%20%24c_i%24%0A%20%20%20%20-%20%E4%B9%9F%E5%B0%B1%E6%98%AF%20%E4%BA%BA%20%24x%24%20-%3E%20%24T%24%EF%BC%8Ccost%20%24c_i%24%0A3.%20%E9%81%B8%E4%BA%86%E4%B8%80%E5%80%8B%E5%BA%A7%E6%A8%99%EF%BC%8C%E5%B0%B1%E7%AD%89%E5%83%B9%E5%8F%AF%E8%83%BD%E8%B2%A2%E7%8D%BB%E4%BA%86%20%24b%24%EF%BC%88%E4%BD%86%E9%80%A3%E7%BA%8C%E9%81%B8%E5%BA%A7%E6%A8%99%E7%9A%84%E5%8D%80%E9%96%93%E6%9C%83%E5%A4%9A%E7%AE%97%E4%B8%80%E5%80%8B%20%24b%24%EF%BC%8C%E4%B8%8B%E4%B8%80%E6%AD%A5%E8%A7%A3%E6%B1%BA%EF%BC%89%0A%20%20%20%20-%20%E4%B9%9F%E5%B0%B1%E6%98%AF%20%24S%24%20-%3E%20%E5%BA%A7%E6%A8%99%20%24x%24%EF%BC%8Ccost%20%24b%24%0A4.%20%E9%81%B8%E4%BA%86%E5%BA%A7%E6%A8%99%20%24x%24%EF%BC%8C%E5%8D%BB%E4%B8%8D%E9%81%B8%20%24x-1%24%20%3D%3E%20%E5%87%BA%E7%8F%BE%E4%BA%86%E4%B8%80%E5%80%8B%E5%8D%80%E9%96%93%E7%9A%84%E9%96%8B%E9%A0%AD%0A%20%20%20%20-%20%E4%B9%9F%E5%B0%B1%E6%98%AF%20%E5%BA%A7%E6%A8%99%20%24x-1%24%20-%3E%20%E5%BA%A7%E6%A8%99%20%24x%24%EF%BC%8Ccost%20%24a-b%24%EF%BC%88%E6%8A%B5%E9%8A%B7%E4%B8%80%E5%80%8B%20%24b%24%EF%BC%8C%E5%A2%9E%E5%8A%A0%20%24a%24%EF%BC%89%EF%BC%8C%E6%B3%A8%E6%84%8F%E5%88%B0%20%24a%3Eb%24%20%E6%89%80%E4%BB%A5%E9%80%99%E6%98%AF%E6%AD%A3%E7%9A%84%20cost%0A5.%20%E4%BA%BA%E8%88%87%E4%BA%BA%E4%B9%8B%E9%96%93%E7%9A%84%E6%9C%8B%E5%8F%8B%E9%82%8A%0A%20%20%20%20-%20%E4%B9%9F%E5%B0%B1%E6%98%AF%20%24u_i%24%20%3C-%3E%20%24v_i%24%EF%BC%8Ccost%20%24w_i%24%20%E7%9A%84%E9%9B%99%E5%90%91%E9%82%8A%0A%0A%E7%9B%B4%E6%8E%A5%E8%B7%91%E4%B8%8A%E5%9C%96%E7%9A%84%20%24S-T%24%20%E6%9C%80%E5%B0%8F%E5%89%B2%EF%BC%8C%E5%B0%B1%E6%9C%83%E6%98%AF%E7%AD%94%E6%A1%88%E3%80%82%0A%E6%B3%A8%E6%84%8F%E5%88%B0%E4%BB%A5%E4%B8%8A%E6%A8%A1%E5%9E%8B%E5%8F%AF%E8%83%BD%E6%9C%83%E7%94%9F%E5%87%BA%E3%80%8C%E5%8D%80%E9%96%93%E9%82%8A%E7%95%8C%E6%B2%92%E6%9C%89%E4%BA%BA%E3%80%8D%E7%9A%84%E5%8D%80%E9%96%93%EF%BC%8C%E4%BD%86%E9%80%99%E6%A8%A3%E7%AD%94%E6%A1%88%E8%82%AF%E5%AE%9A%E5%8F%AA%E6%9C%83%E6%9B%B4%E5%B7%AE%EF%BC%8C%E6%89%80%E4%BB%A5%E4%B8%8D%E7%94%A8%E5%9C%A8%E6%84%8F%E9%80%99%E4%BB%B6%E4%BA%8B%E3%80%82%0A%0A%E9%82%A3%E5%80%BC%E5%9F%9F%E5%BE%88%E5%A4%A7%E8%A6%81%E6%80%8E%E9%BA%BC%E5%81%9A%EF%BC%9F%E5%85%B6%E5%AF%A6%E5%8F%AF%E4%BB%A5%E6%8A%8A%E4%BA%BA%E8%88%87%E4%BA%BA%E4%B9%8B%E9%96%93%E7%9A%84%E5%BA%A7%E6%A8%99%E5%A3%93%E6%88%90%E4%B8%80%E5%80%8B%E9%BB%9E%EF%BC%8Ccost%20%E5%B0%B1%E6%98%AF%20%24b%24%20%E4%B9%98%E4%B8%8A%E9%95%B7%E5%BA%A6%EF%BC%8C%E5%9B%A0%E7%82%BA%E9%80%99%E6%AE%B5%E5%8D%80%E9%96%93%E4%B8%8D%E5%8F%AF%E8%83%BD%E6%9C%89%E4%BA%9B%E5%BA%A7%E6%A8%99%E9%81%B8%E4%BA%86%E6%9C%89%E4%BA%9B%E5%BA%A7%E6%A8%99%E4%B8%8D%E9%81%B8%EF%BC%8C%E5%90%A6%E5%89%87%E7%AD%94%E6%A1%88%E5%8F%AA%E6%9C%83%E6%9B%B4%E5%B7%AE%EF%BC%8C%E5%9B%A0%E6%AD%A4%E7%B8%BD%E5%85%B1%E5%B0%B1%E5%8F%AA%E6%9C%89%20%242%20%2B%20N%20%2B%202N%20-%201%20%3D%203N%20%2B%201%24%20%E5%80%8B%E9%BB%9E%EF%BC%8C%E9%82%8A%E9%87%8F%E4%B9%9F%E6%98%AF%20%24O(N%2BM)%24%EF%BC%8C%E7%B8%BD%E5%85%B1%E7%9A%84%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E8%8B%A5%E4%BD%BF%E7%94%A8%20%5BDinic%5D(https%3A%2F%2Fzh.wikipedia.org%2Fzh-tw%2F%25E8%25BF%25AA%25E5%25B0%25BC%25E8%258C%25A8%25E7%25AE%2597%25E6%25B3%2595)%20%E6%BC%94%E7%AE%97%E6%B3%95%E5%8D%B3%E7%82%BA%20%24O(N%5E2(N%2BM))%24%E3%80%82%0A%0A%E4%B8%80%E5%80%8B%E5%AE%B9%E6%98%93%E8%B8%A9%E5%88%B0%E7%9A%84%E9%8C%AF%E8%AA%A4%E6%98%AF%E4%B8%8D%E6%8A%8A%E4%BA%BA%E8%B7%9F%E5%BA%A7%E6%A8%99%E5%88%86%E9%96%8B%E5%BB%BA%E9%BB%9E%EF%BC%8C%E9%80%99%E6%A8%A3%E6%9C%83%E5%B0%8E%E8%87%B4%E8%A2%AB%E8%93%8B%E4%BD%8F%E7%9A%84%E4%BA%BA%E8%A2%AB%E5%BC%B7%E8%BF%AB%E9%81%B8%E9%80%B2%E4%BE%86%EF%BC%8C%E4%BD%86%E5%AF%A6%E9%9A%9B%E4%B8%8A%E5%8F%AF%E8%83%BD%E6%9C%83%E5%9B%A0%E7%82%BA%E6%9C%8B%E5%8F%8B%E9%82%8A%E7%9A%84%E5%BD%B1%E9%9F%BF%E8%AE%93%E9%80%99%E5%80%8B%E4%BA%BA%E8%A2%AB%E8%AB%8B%E8%B5%B0%E6%AF%94%E8%BC%83%E5%A5%BD%EF%BC%8C%E4%BB%A5%E4%B8%8B%E6%98%AF%E4%B8%80%E5%80%8B%E6%89%8B%E6%A7%8B%E7%99%BC%E7%94%9F%E9%80%99%E4%BB%B6%E4%BA%8B%E7%9A%84%E6%B8%AC%E8%B3%87%EF%BC%8C%E4%BE%9B%E5%8F%83%E8%80%83%EF%BC%9A%0A%60%60%60%0A4%201%203%201%0A1%202%203%20100%0A9%201%209%201%0A2%204%205%0A%60%60%60%0A%0A%23%23%20Problem%20H.%20Harmony%20Coloring%20%5Beasy-mid%5D%0A!%5B%5D(https%3A%2F%2Fhackmd.io%2F_uploads%2FH1LsPBfj2.png)%0A%E5%85%88%E5%9B%BA%E5%AE%9A%20%24H%24%20%E5%A1%97%E7%B4%85%E8%89%B2%EF%BC%8C%E6%9C%80%E5%BE%8C%E5%86%8D%E6%8A%8A%E7%AD%94%E6%A1%88%E4%B9%98%E4%BB%A5%202%E3%80%82%0A%E5%88%86%E7%82%BA%E5%85%A9%E5%80%8B%20case%EF%BC%9A%0A1.%20%24T%24%20%E4%B8%80%E6%A8%A3%E5%A1%97%E7%B4%85%E8%89%B2%E3%80%82%E8%80%83%E6%85%AE%E8%97%8D%E8%89%B2%E7%9A%84%E9%BB%9E%E6%80%8E%E9%BA%BC%E9%81%B8%EF%BC%8C%E5%9C%A8%E6%8B%94%E6%8E%89%20H%20%E5%92%8C%20T%20%E4%B9%8B%E5%BE%8C%EF%BC%8C%E6%95%B4%E5%BC%B5%E5%9C%96%E5%8F%AA%E5%89%A9%E4%B8%8B%E4%B8%80%E4%BA%9B%E9%8D%8A%EF%BC%8C%E5%9B%A0%E6%AD%A4%E8%97%8D%E8%89%B2%E9%BB%9E%E5%8F%AA%E8%83%BD%E9%81%B8%E6%93%87%E9%80%99%E4%BA%9B%E9%8D%8A%E7%9A%84%E5%85%B6%E4%B8%AD%E4%B8%80%E5%80%8B%E9%8D%8A%E4%B8%8A%E7%9A%84%E4%B8%80%E5%80%8B%E5%8D%80%E9%96%93%E3%80%82%0A%20%20%20%E5%81%87%E8%A8%AD%E9%81%B8%E4%BA%86%20stem%20chain%20%E5%89%87%E5%8F%AA%E8%83%BD%E6%98%AF%E4%B8%80%E5%80%8B%E5%89%8D%E7%B6%B4%EF%BC%8C%E8%80%8C%E4%B8%94%E5%89%A9%E4%B8%8B%E7%9A%84%E7%B4%85%E8%89%B2%E4%B8%80%E5%AE%9A%E6%9C%83%E9%80%A3%E9%80%9A%EF%BC%8C%E6%95%B8%E9%87%8F%E6%9C%89%20%24S%24%20%E5%80%8B%E3%80%82%0A%20%20%20%E5%81%87%E8%A8%AD%E9%81%B8%E4%BA%86%20stripe%20chain%EF%BC%8C%E5%89%87%E6%95%B8%E9%87%8F%E6%98%AF%20%24%5Csum%20%5Cfrac%7B1%7D%7B2%7D%20l_i%20(l_i%2B1)%24%20%E5%80%8B%E3%80%82%E6%B3%A8%E6%84%8F%20%24N%20%3D%201%24%20%E7%9A%84%20case%EF%BC%8C%E5%9B%A0%E7%82%BA%E6%8B%94%E6%8E%89%E9%82%A3%E4%BA%9B%E8%97%8D%E8%89%B2%E9%BB%9E%E4%B9%8B%E5%BE%8C%E5%89%A9%E4%B8%8B%E7%9A%84%E7%B4%85%E8%89%B2%E9%BB%9E%E5%BF%85%E9%A0%88%E8%A6%81%E9%80%A3%E9%80%9A%E3%80%82%0A2.%20%24T%24%20%E5%A1%97%E8%97%8D%E8%89%B2%E3%80%82%E9%80%99%E6%A8%A3%20stem%20chain%20%E5%B0%B1%E4%B8%80%E5%AE%9A%E6%95%B4%E5%80%8B%E9%83%BD%E8%A6%81%E6%98%AF%E7%B4%85%E8%89%B2%E3%80%82%E5%B0%8D%E6%96%BC%E6%AF%8F%E5%80%8B%20stripe%20chain%EF%BC%8C%E6%88%91%E5%80%91%E9%83%BD%E5%8F%AF%E4%BB%A5%E4%BB%BB%E6%84%8F%E7%8D%A8%E7%AB%8B%E7%9A%84%E6%B1%BA%E5%AE%9A%E4%B8%80%E5%80%8B%E7%B4%85%E8%97%8D%E7%9A%84%E5%88%86%E5%89%B2%E9%BB%9E%EF%BC%8C%E5%9B%A0%E6%AD%A4%E9%80%99%E9%83%A8%E4%BB%BD%E7%9A%84%E7%AD%94%E6%A1%88%E6%98%AF%20%24%5Cprod%20(l_i%20%2B%201)%24%E3%80%82%0A%0A%23%23%20Problem%20I.%20IMO%20Problem%20%5Beasy%5D%0A%3E%20%E6%93%9A%E8%AA%AA%202022%20TOI%20%E4%BA%8C%E6%A8%A1%E5%87%BA%E4%BA%86%E4%B8%80%E9%A1%8C%20IMO%20%E7%9A%84%E8%A4%87%E8%A3%BD%E9%A1%8C%EF%BC%8C%E6%88%91%E5%80%91%E6%80%8E%E9%BA%BC%E5%8F%AF%E4%BB%A5%E5%87%BA%E4%B8%80%E6%A8%A3%E7%9A%84%E9%A1%8C%E7%9B%AE%E5%91%A2%EF%BC%9F%E6%89%80%E4%BB%A5%E9%80%99%E6%98%AF%E9%82%A3%E9%A1%8C%E7%9A%84%20checker%E3%80%82%0A%0A%E6%8A%8A%E6%96%9C%E5%90%91%E5%B7%A6%E4%B8%8B%E5%92%8C%E6%96%9C%E5%90%91%E5%8F%B3%E4%B8%8B%E5%88%86%E5%88%A5%E8%A8%82%E6%88%90%20%24x%24%20%E8%BB%B8%E6%AD%A3%E5%90%91%E5%92%8C%20%24y%24%20%E8%BB%B8%E6%AD%A3%E5%90%91%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%99%BC%E7%8F%BE%E6%AF%8F%E6%AC%A1%E8%B5%B0%E5%88%B0%E6%96%B0%E4%B8%80%E6%8E%92%E7%9A%84%E5%85%A9%E5%80%8B%E5%9C%93%E5%B0%B1%E7%AD%89%E6%96%BC%E6%98%AF%E5%BE%9E%20%24(x%2Cy)%24%20%E8%B5%B0%E5%88%B0%20%24(x%2B1%2Cy)%24%20%E6%88%96%20%24(x%2Cy%2B1)%24%E3%80%82%E5%9B%A0%E6%AD%A4%E5%AE%9A%E5%A5%BD%E5%BA%A7%E6%A8%99%E4%B9%8B%E5%BE%8C%EF%BC%8C%E5%B0%B1%E7%AD%89%E6%96%BC%E6%98%AF%E8%A6%81%E9%81%B8%E4%B8%80%E5%A0%86%E7%B4%85%E8%89%B2%E5%9C%93%E4%BD%BF%E5%BE%97%E4%BB%96%E5%80%91%E7%9A%84%E5%BA%A7%E6%A8%99%E5%85%A9%E7%B6%AD%E9%83%BD%E4%B8%8D%E5%9A%B4%E6%A0%BC%E9%81%9E%E5%A2%9E%EF%BC%8C%E7%AD%89%E5%83%B9%E6%96%BC%E4%B8%80%E5%80%8B%20LIS%20%E5%95%8F%E9%A1%8C%E4%B9%8B%E9%A1%9E%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%83%BD%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%94%A8%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%E5%81%9A%E3%80%82%0A%E7%AC%AC%20%24i%24%20%E6%A9%AB%E6%8E%92%E7%9A%84%E7%AC%AC%20%24a_i%24%20%E5%80%8B%E7%B4%85%E8%89%B2%E5%9C%93%E5%B0%8D%E6%87%89%E5%88%B0%E4%B8%8A%E8%BF%B0%E7%9A%84%E5%BA%A7%E6%A8%99%E6%87%89%E8%A9%B2%E5%B0%B1%E6%98%AF%20%24(a_i%2Ci-a_i)%24%20%E4%B9%8B%E9%A1%9E%E7%9A%84%E3%80%82%0A%0A%23%23%20Problem%20J.%20Japanese%20Monsters%20%5Bmid-hard%5D%0A%0A**%E5%8E%9F%E6%9C%AC%E7%9A%84%E8%A7%A3**%0A%0A%E5%AE%9A%E7%BE%A9%E5%80%91%EF%BC%9A%0A*%20%24N%20%3D%20%7CS%7C%24%0A*%20%24%5Ctext%7BSuf%7D_i%20%3D%20S_%7Bi%5Cdots%20N%7D%24%0A*%20%E8%8B%A5%E4%B8%80%E5%80%8B%E5%AD%97%E4%B8%B2%20%24S%24%20%E5%BD%A2%E5%A6%82%20%24AA%24%EF%BC%8C%E5%85%B6%E4%B8%AD%20%24A%24%20%E6%98%AF%E6%9F%90%E5%80%8B%E9%9D%9E%E7%A9%BA%E5%AD%97%E4%B8%B2%EF%BC%8C%E5%89%87%E6%88%91%E5%80%91%E7%A8%B1%20%24S%24%20%E6%98%AF%E4%B8%80%E5%80%8B%E4%B8%B2%E4%B8%B2%0A*%20%24%5Ctext%7BLCP%7D(A%2C%20B)%24%20%E4%BB%A3%E8%A1%A8%20%24A%24%20%E8%B7%9F%20%24B%24%20%E7%9A%84%E6%9C%80%E9%95%B7%E5%85%B1%E5%90%8C%E5%89%8D%E7%B6%B4%0A%0A%E9%A1%8C%E7%9B%AE%E8%A6%81%E6%88%91%E5%80%91%E5%B0%8D%E6%AF%8F%E5%80%8B%20%24i%24%20%E7%AE%97%E6%9C%89%E5%A4%9A%E5%B0%91%E7%A8%AE%E6%96%B9%E5%BC%8F%E6%8A%8A%20%24%5Ctext%7BSuf%7D_i%24%20%E6%8B%86%E6%88%90%20%24AABA%24%20%E7%9A%84%E5%BD%A2%E5%BC%8F%EF%BC%8C%E5%85%B6%E4%B8%AD%20%24A%24%2C%20%24B%24%20%E9%83%BD%E6%98%AF%E9%9D%9E%E7%A9%BA%E5%AD%97%E4%B8%B2%E3%80%82%0A%0A%E8%80%83%E6%85%AE%E6%9E%9A%E8%88%89%E7%B5%90%E5%B0%BE%E7%9A%84%20%24A%24%EF%BC%8C%E6%88%91%E5%80%91%E7%9F%A5%E9%81%93%E5%8F%AA%E8%A6%81%20%24i%2B3%7CA%7C%20%5Cleq%20N%24%EF%BC%8C%E4%B8%94%20%24%5Ctext%7BLCP%7D(%5Ctext%7BSuf%7D_i%2C%20A)%20%3D%20A%24%EF%BC%8C%E4%B8%94%20%24%5Ctext%7BSuf%7D_i%24%20%E7%9A%84%E5%89%8D%20%242%7CA%7C%24%20%E5%80%8B%E5%AD%97%E5%85%83%E5%89%9B%E5%A5%BD%E6%98%AF%E4%B8%80%E5%80%8B%E4%B8%B2%E4%B8%B2%E7%9A%84%E8%A9%B1%EF%BC%8C%E9%82%A3%20%24A%24%20%E5%B0%B1%E6%9C%83%E5%B0%8D%20%24i%24%20%E8%B2%A2%E7%8D%BB%201%E3%80%82%0A%E6%83%B3%E5%88%B0%E4%B8%B2%E4%B8%B2%E5%B0%B1%E6%9C%83%E6%83%B3%E5%88%B0%20%5BMain-Lorentz%5D(https%3A%2F%2Fcp-algorithms.com%2Fstring%2Fmain_lorentz.html)%EF%BC%8C%E4%BB%96%E5%8F%AF%E4%BB%A5%E5%B0%8D%E6%96%BC%E6%AF%8F%E5%80%8B%20%242k%24%20%E6%89%BE%E5%88%B0%E6%9C%89%E5%93%AA%E4%BA%9B%20%24i%24%20%E5%B0%8D%E6%87%89%E7%9A%84%20%24S_%7Bi%20%5Cdots%20i%2B2k-1%7D%24%20%E6%98%AF%E4%B8%80%E5%80%8B%E4%B8%B2%E4%B8%B2%EF%BC%8C%E4%B8%A6%E4%B8%94%E9%80%99%E4%BA%9B%E9%96%8B%E9%A0%AD%E5%80%91%E6%9C%83%E5%BD%A2%E6%88%90%E4%B8%80%E4%BA%9B%E5%8D%80%E9%96%93%EF%BC%8C%E8%80%8C%E7%B8%BD%E5%8D%80%E9%96%93%E6%95%B8%E9%87%8F%E6%98%AF%20%24O(N%20%5Clog%20N)%24%E3%80%82%0A%E6%B3%A8%E6%84%8F%E5%88%B0%E5%B0%8D%E6%96%BC%20Main-Lorentz%20%E6%89%BE%E5%87%BA%E7%9A%84%E5%8D%80%E9%96%93%EF%BC%8C%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E7%A8%8D%E4%BD%9C%E8%AA%BF%E6%95%B4%EF%BC%8C%E4%BD%BF%E5%BE%97%E9%80%99%E4%BA%9B%E9%96%8B%E9%A0%AD%E4%B9%9F%E6%9C%83%E7%AC%A6%E5%90%88%20%24i%2B3%7CA%7C%20%5Cleq%20N%24%E3%80%82%0A%0A%E6%8E%A5%E4%B8%8B%E4%BE%86%E6%88%91%E5%80%91%E5%89%A9%E4%B8%8B%E8%A6%81%E5%81%9A%E7%9A%84%E4%BA%8B%E6%83%85%E5%B0%B1%E6%98%AF%E7%A2%BA%E4%BF%9D%20%24%5Ctext%7BLCP%7D%24%20%E6%98%AF%E5%B0%8D%E7%9A%84%EF%BC%8C%E9%80%99%E9%83%A8%E5%88%86%E5%8F%AF%E4%BB%A5%E6%83%B3%E5%83%8F%E4%B8%80%E6%A3%B5%5B%E5%BE%8C%E7%B6%B4%E6%A8%B9%5D(https%3A%2F%2Fcp-algorithms.com%2Fstring%2Fsuffix-tree-ukkonen.html)%E3%80%82%0A%E6%88%91%E5%80%91%E7%9F%A5%E9%81%93%E5%BE%8C%E7%B6%B4%E6%A8%B9%E4%B8%8A%20%24u%24%20%E7%9A%84%E5%BE%8C%E4%BB%A3%E7%AF%80%E9%BB%9E%20%24v%24%20%E5%80%91%E8%B7%9F%20%24u%24%20%E6%89%80%E4%BB%A3%E8%A1%A8%E7%9A%84%20%24%5Ctext%7BSuf%7D_u%24%20%E7%9A%84%20%24%5Ctext%7BLCP%7D%24%20%E9%83%BD%E6%98%AF%20%24%5Ctext%7BSuf%7D_u%24%EF%BC%8C%E6%89%80%E4%BB%A5%E8%8B%A5%E6%98%AF%20%24%5Ctext%7BSuf%7D_v%24%20%E7%9A%84%E5%89%8D%20%242%7C%5Ctext%7BSuf%7D_u%7C%24%20%E5%AD%97%E5%85%83%E5%8F%88%E5%89%9B%E5%A5%BD%E6%98%AF%E5%80%8B%E5%90%88%E6%B3%95%E4%B8%B2%E4%B8%B2%EF%BC%8C%E9%82%A3%20%24u%24%20%E5%B0%B1%E6%9C%83%E5%B0%8D%20%24v%24%20%E8%B2%A2%E7%8D%BB%201%E3%80%82%0A%0A%E7%B6%9C%E5%90%88%E8%B5%B7%E4%BE%86%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E4%BE%8B%E5%A6%82%E5%B8%B6%E8%91%97%20%5BFenwick%20Tree%5D(https%3A%2F%2Fcp-algorithms.com%2Fdata_structures%2Ffenwick.html)%20%E5%8E%BB%20dfs%20%E5%BE%8C%E7%B6%B4%E6%A8%B9%20(%E5%AF%A6%E4%BD%9C%E4%B8%8A%E5%8F%AF%E4%BB%A5%E7%94%A8%5B%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%5D(https%3A%2F%2Fcp-algorithms.com%2Fstring%2Fsuffix-array.html)%E5%8F%96%E4%BB%A3%E5%BE%8C%E7%B6%B4%E6%A8%B9)%EF%BC%8C%E6%AF%8F%E6%AC%A1%E8%B5%B0%E5%88%B0%20%24u%24%20%E7%9A%84%E6%99%82%E5%80%99%E5%B0%B1%E6%8A%8A%20Main-Lorentz%20%E7%B5%A6%E6%88%91%E5%80%91%E7%9A%84%E9%82%A3%E4%BA%9B%20%242%7C%5Ctext%7BSuf%7D_u%7C%24%20%E5%B0%8D%E6%87%89%E7%9A%84%E5%90%88%E6%B3%95%E4%B8%B2%E4%B8%B2%E5%8D%80%E9%96%93%E6%8B%BF%E5%87%BA%E4%BE%86%E5%8D%80%E9%96%93%E5%8A%A0%E5%80%BC%E4%B8%80%E4%B8%8B%EF%BC%8C%E9%9B%A2%E9%96%8B%20%24u%24%20%E7%9A%84%E6%99%82%E5%80%99%E5%86%8D%E6%92%A4%E9%8A%B7%EF%BC%8C%E7%84%B6%E5%BE%8C%E4%B9%9F%E9%A0%86%E4%BE%BF%E6%AA%A2%E6%9F%A5%E4%B8%80%E4%B8%8B%20%24u%24%20%E7%9B%AE%E5%89%8D%E8%A2%AB%E8%B2%A2%E7%8D%BB%E5%A4%9A%E5%B0%91%E4%BA%86%EF%BC%8C%E9%80%99%E5%80%8B%E5%80%BC%E5%B0%B1%E6%98%AF%20%24A_u%24%E3%80%82%0A%0A%E6%9C%80%E8%8A%B1%E8%B2%BB%E6%99%82%E9%96%93%E7%9A%84%E8%A8%88%E7%AE%97%E6%AD%A5%E9%A9%9F%E6%98%AF%E7%94%A8%20Main-Lorentz%20%E7%B5%A6%E5%87%BA%E7%9A%84%20%24O(N%20%5Clog%20N)%24%20%E5%80%8B%E5%8D%80%E9%96%93%EF%BC%8C%E6%AF%8F%E5%80%8B%E9%83%BD%E6%8B%BF%E5%8E%BB%20BIT%20%E4%BD%9C%E5%8D%80%E9%96%93%E5%8A%A0%E5%80%BC%EF%BC%8C%E5%9B%A0%E6%AD%A4%E7%B8%BD%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E7%82%BA%20%24O(N%20%5Clog%5E2%20N)%24%E3%80%82%0A%0A**%E6%9B%B4%E5%A5%BD%E7%9A%84%E8%A7%A3**%0A%0A%E5%87%BA%E9%A1%8C%E7%9A%84%E4%BA%BA%E7%9C%8B%E4%BA%86%20AYDD%20%E7%9A%84%20submission%20%E6%89%8D%E7%99%BC%E7%8F%BE%E5%85%B6%E5%AF%A6%E5%8F%AF%E4%BB%A5%20%24O(N%20%5Clog%20N)%24%20%F0%9F%98%AD%0A%0A%E4%BD%9C%E6%B3%95%E4%B8%80%E6%A8%A3%E6%9E%9A%E8%88%89%E7%B5%90%E5%B0%BE%E7%9A%84%20%24A%24%EF%BC%8C%E6%88%91%E5%80%91%E4%B8%80%E6%A8%A3%E8%A6%81%E6%89%BE%E9%96%8B%E9%A0%AD%E6%98%AF%20%24AA%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E5%80%91%EF%BC%8C%E6%89%BE%E5%88%B0%E5%BE%8C%20%24A%24%20%E5%B0%B1%E6%9C%83%E5%B0%8D%E5%B0%8D%E9%80%99%E4%B9%8B%E4%B8%AD%E5%AF%A6%E9%9A%9B%E9%96%8B%E9%A0%AD%E5%9C%A8%20%24N%20-%203%7CA%7C%24%20%E5%89%8D%E7%9A%84%E4%BA%BA%E8%B2%A2%E7%8D%BB%201%E3%80%82%0A%E6%98%8E%E9%A1%AF%E7%9A%84%E9%80%99%E4%BA%9B%E9%96%8B%E9%A0%AD%E6%98%AF%20%24AA%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E5%80%91%E6%9C%83%E5%9C%A8%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E4%B8%8A%E5%BD%A2%E6%88%90%E4%B8%80%E5%80%8B%E9%80%A3%E7%BA%8C%E5%8D%80%E9%96%93%EF%BC%8C%E8%80%8C%E8%8B%A5%E6%98%AF%E6%88%91%E5%80%91%E8%83%BD%E5%AE%9A%E4%BD%8D%E5%87%BA%E9%80%99%E5%80%8B%E5%8D%80%E9%96%93%EF%BC%8C%E9%82%A3%E5%89%A9%E4%B8%8B%E7%9A%84%E5%B0%B1%E6%98%AF%E4%B8%80%E5%80%8B%E4%BA%8C%E7%B6%AD%E6%95%B8%E9%BB%9E%E5%95%8F%E9%A1%8C%E3%80%82%0A%0A%E5%9B%A0%E6%AD%A4%E6%88%91%E5%80%91%E5%85%88%E4%BE%86%E7%9C%8B%E8%A9%B2%E6%80%8E%E9%BA%BC%E5%AE%9A%E4%BD%8D%E5%87%BA%E9%80%99%E5%80%8B%E5%8D%80%E9%96%93%E3%80%82%0A%E4%B8%80%E7%A8%AE%E5%81%9A%E6%B3%95%E6%98%AF%E7%9B%B4%E6%8E%A5%E4%BA%8C%E5%88%86%E6%90%9C%E7%AC%AC%E4%B8%80%E5%80%8B%E9%96%8B%E9%A0%AD%E5%AD%97%E5%85%B8%E5%BA%8F%20%24%5Cgeq%20AA%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E6%98%AF%E8%AA%B0%EF%BC%8C%E6%8E%A5%E8%91%97%E5%86%8D%E4%BA%8C%E5%88%86%E6%90%9C%E4%B8%80%E6%AC%A1%E6%89%BE%E5%88%B0%E6%98%AF%20%24AA%24%20%E9%96%8B%E9%A0%AD%E7%9A%84%E6%9C%80%E5%BE%8C%E9%9D%A2%E7%9A%84%E5%BE%8C%E7%B6%B4%E6%98%AF%E8%AA%B0%E3%80%82%0A%0A%E8%A6%81%E6%AA%A2%E6%9F%A5%E6%9F%90%E5%80%8B%E5%BE%8C%E7%B6%B4%20%24U%24%20%E6%98%AF%E4%B8%8D%E6%98%AF%20%24%5Cgeq%20AA%24%EF%BC%8C%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E5%85%88%E7%9C%8B%20%24U%24%20%E5%9C%A8%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E4%B8%8A%E7%9A%84%E4%BD%8D%E7%BD%AE%E6%98%AF%E4%B8%8D%E6%98%AF%E6%AF%94%20%24A%24%20%E5%89%8D%E9%9D%A2%EF%BC%8C%E8%8B%A5%E6%98%AF%E7%9A%84%E8%A9%B1%E4%BB%96%E5%B0%B1%E4%B8%80%E5%AE%9A%E4%B8%8D%E6%9C%83%20%24%5Cgeq%20AA%24%EF%BC%9B%E6%8E%A5%E8%91%97%E7%9C%8B%20%24%5Ctext%7BLCP%7D(A%2C%20U)%24%EF%BC%8C%E8%8B%A5%E4%B8%8D%E6%98%AF%20%24A%24%20%E7%9A%84%E8%A9%B1%EF%BC%8C%E5%9B%A0%E7%82%BA%E6%88%91%E5%80%91%E7%9F%A5%E9%81%93%20%24U%20%5Cgeq%20A%24%EF%BC%8C%E6%89%80%E4%BB%A5%20%24U%20%3E%20A%20%5Cimplies%20U%20%3E%20AA%24%EF%BC%9B%E7%8F%BE%E5%9C%A8%E6%88%91%E5%80%91%E6%9C%89%20%24%5Ctext%7BLCP%7D(A%2C%20U)%3DA%24%EF%BC%8C%E6%89%80%E4%BB%A5%E5%89%A9%E4%B8%8B%E5%8F%AA%E8%A6%81%E7%9C%8B%E6%98%AF%E4%B8%8D%E6%98%AF%20%24U_%7B%7CA%7C%2B1%5Cdots%7CU%7C%7D%20%5Cgeq%20A%24%EF%BC%8C%E7%AD%89%E5%83%B9%E7%9A%84%E6%84%8F%E6%80%9D%E5%B0%B1%E6%98%AF%20%24U_%7B%7CA%7C%2B1%5Cdots%7CU%7C%7D%24%20%E6%98%AF%E4%B8%8D%E6%98%AF%E5%9C%A8%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E4%B8%8A%E6%AF%94%20%24A%24%20%E9%82%84%E5%BE%8C%E9%9D%A2%20(%24U%24%20%E6%98%AF%20%24S%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%EF%BC%8C%E6%89%80%E4%BB%A5%20%24U%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E4%B9%9F%E6%9C%83%E6%98%AF%20%24S%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%EF%BC%8C%E6%89%80%E4%BB%A5%20%24U%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E4%B9%9F%E9%83%BD%E6%9C%83%E5%87%BA%E7%8F%BE%E5%9C%A8%20%24S%24%20%E7%9A%84%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E8%A3%A1)%E3%80%82%0A%0A%E7%A2%BA%E5%AE%9A%20%24V%24%20%E6%98%AF%E4%B8%8D%E6%98%AF%20%24AA%24%20%E7%9A%84%E6%83%85%E6%B3%81%E4%B9%9F%E9%A1%9E%E4%BC%BC%EF%BC%8C%E5%8F%AA%E8%A6%81%E6%AA%A2%E6%9F%A5%20%24%5Ctext%7BLCP%7D(A%2C%20V)%3DA%24%20%E4%B8%94%20%24%5Ctext%7BLCP%7D(A%2C%20V_%7B%7CA%7C%2B1%20%5Cdots%20%7CV%7C%7D)%3DA%24%20%E5%8D%B3%E5%8F%AF%E3%80%82%0A%0A%E6%89%80%E4%BB%A5%E6%9C%80%E5%BE%8C%E5%89%A9%E4%B8%8B%E7%9A%84%E5%95%8F%E9%A1%8C%E5%B0%B1%E8%AE%8A%E6%88%90%E5%9C%A8%E4%B8%80%E5%80%8B%E5%BA%8F%E5%88%97(%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E7%9A%84%E9%80%86%E5%85%83)%E4%B8%8A%EF%BC%8C%E6%9C%89%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C%20%24(L%2C%20R%2C%20v)%24%EF%BC%8C%E4%BB%A3%E8%A1%A8%E8%A6%81%E6%8A%8A%E4%BD%8D%E7%BD%AE%E4%BB%8B%E5%9C%A8%20%24%5BL%2C%20R%5D%24%20%E4%B8%94%E5%80%BC%E5%B0%91%E6%96%BC%20%24v%24%20%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9C%B0%E6%96%B9%E9%83%BD%20%24%2B1%24%EF%BC%8C%E9%80%99%E5%8F%AF%E4%BB%A5%E4%BE%8B%E5%A6%82%E5%B0%8D%E6%93%8D%E4%BD%9C%E5%80%91%E6%8C%89%20%24v%24%20%E7%94%B1%E5%B0%8F%E5%88%B0%E5%A4%A7%E6%8E%92%E5%BA%8F%EF%BC%8C%E6%AF%8F%E6%AC%A1%E5%B0%B1%E8%AE%8A%E6%88%90%E6%98%AF%E4%B8%80%E4%BA%9B%E5%8D%80%E9%96%93%E5%8A%A0%E5%80%BC%E7%9A%84%E6%93%8D%E4%BD%9C%E4%BA%86%EF%BC%8C%E4%B8%80%E6%A8%A3%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%80%8B%20Fenwick%20Tree%20%E6%90%9E%E5%AE%9A%E3%80%82%0A%0A%E8%A8%88%E7%AE%97%E9%87%8F%E6%9C%80%E5%A4%A7%E7%9A%84%E9%83%A8%E5%88%86%E5%9C%A8%E6%96%BC%E4%BA%8C%E5%88%86%E6%90%9C%E8%B7%9F%20Fenwick%20Tree%20%E6%93%8D%E4%BD%9C%EF%BC%8C%E5%85%A9%E7%A8%AE%E7%9A%84%E7%B8%BD%E8%A4%87%E9%9B%9C%E5%BA%A6%E9%83%BD%E6%98%AF%20%24O(N%20%5Clog%20N)%24%20%E7%9A%84%20(%E5%BE%8C%E7%B6%B4%E9%99%A3%E5%88%97%E8%B7%9FLCP%E9%83%BD%E6%9C%89%24O(N)%24%E7%9A%84%E6%BC%94%E7%AE%97%E6%B3%95)%0A%0A%23%23%20Problem%20K.%20Known%20Problem%20%5Bhard%5D%0A%0A%E8%80%83%E6%85%AE%E9%9B%A2%E7%B7%9A%E5%9B%9E%E7%AD%94%EF%BC%8C%E5%B0%8D%E6%89%80%E6%9C%89%E8%A9%A2%E5%95%8F%E7%9A%84%20%24r%24%20%E6%8E%92%E5%BA%8F%EF%BC%8C%24r%24%20%E5%BE%9E%E5%B0%8F%E5%88%B0%E5%A4%A7%EF%BC%8C%E6%AF%8F%E6%AC%A1%E5%8A%A0%E4%B8%80%E5%80%8B%20%24r%24%20%E9%80%B2%E4%BE%86%E5%BE%8C%E6%9B%B4%E6%96%B0%E6%89%80%E6%9C%89%20%24l%24%20%E7%9A%84%E7%AD%94%E6%A1%88%E3%80%82%0A%0A%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E5%BB%BA%E7%AB%8B%20%24%5Clog(C)%2B1%24%20%E5%80%8B%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%EF%BC%8C%E5%85%B6%E4%B8%AD%20%24C%24%20%E6%98%AF%E5%80%BC%E5%9F%9F%E3%80%81%E7%AC%AC%20%24i%24%20%E5%80%8B%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%E6%9C%83%E4%BF%9D%E6%8C%81%E5%88%B0%E6%89%80%E6%9C%89%E3%80%8C%E6%9C%89%E7%94%A8%E7%9A%84%E3%80%8D%E8%B7%9D%E9%9B%A2%E4%BB%8B%E5%9C%A8%20%24(2%5E%7Bi-1%7D%2C%202%5E%7Bi%20%2B%201%7D%5D%24%20%E7%9A%84%E6%95%B8%E5%B0%8D%E3%80%82%E7%89%B9%E5%88%A5%E5%9C%B0%EF%BC%8C%E7%AC%AC%20%240%24%20%E5%80%8B%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%E7%B6%AD%E8%AD%B7%E7%9A%84%E5%8D%80%E9%96%93%E6%98%AF%20%24%5B0%2C%201%5D%24%E3%80%82%0A%0A%E5%B0%8D%E6%96%BC%E7%AC%AC%20%24i%24%20%E5%80%8B%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%EF%BC%8C%E6%88%91%E5%80%91%E5%B0%87%E5%80%BC%E5%9F%9F%E6%AF%8F%20%242%5Ei%24%20%E5%80%8B%E5%88%87%E6%88%90%E4%B8%80%E5%A1%8A%EF%BC%8C%E6%AF%8F%E5%80%8B%E9%BB%9E%20%24x_r%24%20%E5%9C%A8%E8%A2%AB%E5%8A%A0%E9%80%B2%E4%BE%86%E6%99%82%E6%9C%83%E9%80%B2%E5%88%B0%20%24%5Clfloor%5Cfrac%7Bx_r%7D%7B2%5Ei%7D%5Crfloor%24%20%E9%80%99%E5%A1%8A%E8%A3%A1%E9%9D%A2%EF%BC%8C%E6%8E%A5%E8%91%97%E4%BB%96%E5%B0%B1%E6%9A%B4%E5%8A%9B%E8%B7%9F%20%24%5Clfloor%5Cfrac%7Bx_r%7D%7B2%5Ei%7D%5Crfloor-1%24%E3%80%81%24%5Clfloor%5Cfrac%7Bx_r%7D%7B2%5Ei%7D%5Crfloor%24%E3%80%81%24%5Clfloor%5Cfrac%7Bx_r%7D%7B2%5Ei%7D%5Crfloor%2B1%24%20%E9%80%99%E4%B8%89%E5%A1%8A%E8%A3%A1%E9%9D%A2%E7%9A%84%E6%89%80%E6%9C%89%E9%BB%9E%E5%BB%BA%E7%AB%8B%E5%87%BA%E6%95%B8%E5%B0%8D%EF%BC%8C%E5%81%87%E8%A8%AD%E5%BB%BA%E7%AB%8B%E5%87%BA%20%24x_l%2C%20x_r%24%20%E9%80%99%E5%80%8B%E6%95%B8%E5%B0%8D%EF%BC%8C%E9%82%A3%E9%80%99%E5%85%A9%E5%80%8B%E9%BB%9E%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%B2%A2%E7%8D%BB%E7%B5%A6%E6%89%80%E6%9C%89%E6%9C%AA%E4%BE%86%E8%A9%A2%E5%95%8F%E5%B7%A6%E7%95%8C%20%24%5Cleq%20l%24%20%E7%9A%84%E8%A9%A2%E5%95%8F%E3%80%82%0A%0A%E6%8E%A5%E8%91%97%EF%BC%8C%E7%95%B6%E4%B8%80%E5%A1%8A%E5%8A%A0%E5%85%A5%E9%BB%9E%E4%B9%8B%E5%BE%8C%E8%B6%85%E9%81%8E%20%243%24%20%E5%80%8B%E9%BB%9E%EF%BC%8C%E6%88%91%E5%80%91%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%A7%BB%E9%99%A4%E9%80%99%E5%A1%8A%E8%A3%A1%E9%9D%A2%20index%20%E6%9C%80%E5%B0%8F%E7%9A%84%E9%BB%9E%EF%BC%8C%E5%A6%82%E6%AD%A4%E4%B8%80%E4%BE%86%E6%95%B4%E9%AB%94%E7%9A%84%E8%A4%87%E9%9B%9C%E5%BA%A6%E5%B0%B1%E6%9C%83%E6%98%AF%20%24N%5Clog%20Cf(N)%24%EF%BC%8C%E5%85%B6%E4%B8%AD%20%24f(N)%24%20%E6%98%AF%E8%B2%A2%E7%8D%BB%E4%B8%80%E5%80%8B%E6%95%B8%E5%B0%8D%E7%9A%84%E6%99%82%E9%96%93%EF%BC%8C%E9%80%99%E8%A3%A1%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%B8%80%E5%80%8B%20BIT%20%E7%B6%AD%E8%AD%B7%EF%BC%8C%E6%89%80%E4%BB%A5%E6%98%AF%20%24N%5Clog%20C%5Clog%20N%24%EF%BC%8C%E8%80%8C%E6%AF%8F%E5%80%8B%E8%A9%A2%E5%95%8F%E5%B0%B1%E6%98%AF%E4%B8%80%E5%80%8B%20BIT%20%E6%9F%A5%E8%A9%A2%EF%BC%8C%E7%B8%BD%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E5%B0%B1%E6%98%AF%20%24O(N%5Clog%20C%5Clog%20N%20%2B%20Q%5Clog%20N)%24%E3%80%82%0A%0A%E9%82%A3%E7%82%BA%E4%BB%80%E9%BA%BC%E9%80%99%E6%A8%A3%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%B6%AD%E8%AD%B7%E5%A5%BD%E6%AC%A1%E8%BF%91%E6%95%B8%E5%B0%8D%E5%91%A2%EF%BC%9F%E9%A6%96%E5%85%88%E5%B0%8D%E6%96%BC%E7%AC%AC%20%24i%24%20%E5%80%8B%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%0A%0A%3A%3A%3Ainfo%0A%E7%95%B6%E4%B8%80%E5%A1%8A%E8%A3%A1%E9%9D%A2%E6%9C%89%E8%B6%85%E9%81%8E%20%243%24%20%E5%80%8B%E9%BB%9E%E5%BE%8C%EF%BC%8C%E8%82%AF%E5%AE%9A%E5%AD%98%E5%9C%A8%E8%B6%85%E9%81%8E%E5%85%A9%E5%80%8B%20pair%20%E7%9A%84%E8%B7%9D%E9%9B%A2%E4%B8%8D%E8%B6%85%E9%81%8E%20%242%5E%7Bi-1%7D%24%0A%3A%3A%3A%0A%0A%E6%89%80%E4%BB%A5%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%83%B3%E5%83%8F%E8%A2%AB%20pop%20%E6%8E%89%20index%20%E6%9C%80%E5%B0%8F%E5%A6%82%E6%9E%9C%E5%9C%A8%E9%80%99%E5%A1%8A%E6%98%AF%E3%80%8C%E6%9C%89%E7%94%A8%E7%9A%84%E3%80%8D%E8%A9%B1%EF%BC%8C%E9%82%A3%E4%BB%96%E8%A3%BD%E9%80%A0%E5%87%BA%E4%BE%86%E9%80%99%E5%80%8B%E4%BB%8B%E5%9C%A8%20%24(2%5E%7Bi-1%7D%2C%202%5E%7Bi%20%2B%201%7D%5D%24%20%E7%9A%84%E8%B7%9D%E9%9B%A2%E8%82%AF%E5%AE%9A%E6%9C%83%E8%A2%AB%E4%B8%8D%E8%B6%85%E9%81%8E%20%242%5E%7Bi-1%7D%24%20%E7%9A%84%E6%9F%90%E5%80%8B%E5%85%A9%E5%80%8B%E6%95%B8%E5%B0%8D%E5%9C%A8%E6%9C%AA%E4%BE%86%E8%93%8B%E4%BD%8F%EF%BC%8C%E5%9B%A0%E6%AD%A4%E4%BB%96%E6%98%AF%E6%B2%92%E6%9C%89%E7%94%A8%E7%9A%84%EF%BC%8Cpop%20%E6%8E%89%E4%B8%8D%E5%BD%B1%E9%9F%BF%E8%A7%A3%E7%AD%94%E3%80%82%0A%0A%E9%80%99%E6%8B%9B%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%BE%86%E5%81%9A%5B%E5%8D%80%E9%96%93%E6%9C%80%E8%BF%91%E9%BB%9E%E5%B0%8D%5D(https%3A%2F%2Fcodeforces.com%2Fgym%2F104172%2Fproblem%2FI)%EF%BC%8C%E4%BD%86%E5%B8%B8%E6%95%B8%E9%9D%9E%E5%B8%B8%E4%B9%8B%E5%A4%A7%EF%BC%9B%E8%80%8C%E9%80%99%E9%A1%8C%E7%9C%8B%E8%B5%B7%E4%BE%86%E5%AD%98%E5%9C%A8%E5%8E%9F%E6%9C%AC%20well-known%20%E6%9C%80%E8%BF%91%E6%95%B8%E5%B0%8D%E4%BD%9C%E6%B3%95%E7%9A%84%E5%BB%B6%E4%BC%B8%E8%A7%A3%EF%BC%88%E8%B3%BD%E4%B8%AD%E9%81%8E%E7%9A%84%E9%9A%8A%E4%BC%8D%E5%A5%BD%E5%83%8F%E9%83%BD%E6%98%AF%E9%80%99%E6%A8%A3%E5%81%9A%EF%BC%89%EF%BC%8C%E4%BD%86%E5%87%BA%E9%A1%8C%E8%80%85%E5%A4%AA%E4%BF%A1%E4%BB%BB%202017%20%E9%80%99%E9%A1%8C%E7%9A%84%E6%8F%90%E5%87%BA%E8%80%85%E6%89%80%E4%BB%A5%E4%BB%A5%E7%82%BA%E9%80%99%E5%80%8B%E5%81%9A%E6%B3%95%E4%B8%8D%E8%83%BD%E5%81%9A%EF%BC%88%EF%BC%B8%0A%0A%23%23%20Problem%20L.%20List%20of%20Order%20%5Beasy%5D%0A%0A%E9%80%99%E9%A1%8C%E6%98%AF%E5%9C%A8%E8%87%B4%E6%95%AC%202022%20ICPC%20%E6%A1%83%E5%9C%92%E7%AB%99%E7%9A%84%E9%96%B1%E8%AE%80%E6%B8%AC%E9%A9%97%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E6%8A%8A%20work%20%E7%95%B6%E6%88%90%E4%B8%80%E5%80%8B%E9%BB%9E%EF%BC%8C%E9%82%A3%E5%8F%AF%E4%BB%A5%E5%BB%BA%E5%87%BA%E4%B8%80%E5%BC%B5%20DAG%EF%BC%8C%E9%82%8A%E4%BE%86%E8%87%AA%E4%BB%A5%E4%B8%8B%EF%BC%9A%0A1.%20%E6%AF%8F%E5%80%8B%20order%20%E7%9A%84%E9%A0%86%E5%BA%8F%0A2.%20%E5%90%8C%E4%B8%80%E5%80%8B%20item%20%E7%9A%84%20work%20%E5%B0%8D%20dealine%20%E6%8E%92%E5%BA%8F%0A3.%20%E6%AF%8F%E5%80%8B%20resource%20%E7%9A%84%E9%A0%86%E5%BA%8F%0A%0A%E6%8E%A5%E8%91%97%EF%BC%8C%E5%9B%A0%E7%82%BA%E8%A6%81%E7%A7%BB%E9%99%A4%E6%9F%90%E5%80%8B%20resource%20%E7%9A%84%E5%8D%80%E9%96%93%EF%BC%8C%E6%89%80%E4%BB%A5%E9%80%99%E5%80%8B%E5%8D%80%E9%96%93%E5%9C%A8%20resource%20%E4%B8%8A%E5%B7%A6%E5%8F%B3%E7%9A%84%E9%82%8A%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%B8%8D%E5%BB%BA%EF%BC%8C%E4%B8%A6%E5%9C%A8%E7%A9%BA%E9%9A%99%E4%B9%8B%E9%96%93%E6%8F%92%E5%85%A5%E4%B8%80%E6%A2%9D%E9%82%8A%E3%80%82%0A%0A%E5%A6%82%E6%AD%A4%E4%B8%80%E4%BE%86%EF%BC%8C%E5%8E%9F%E9%A1%8C%E8%AE%8A%E6%88%90%0A%3A%3A%3Ainfo%0A%E7%B5%A6%E5%AE%9A%20DAG%20%E4%B8%8A%E7%9A%84%E5%85%A9%E5%80%8B%E9%BB%9E%20%24s%2C%20t%24%EF%BC%8C%E4%BF%9D%E8%AD%89%20%24s%24%20%E8%83%BD%E8%B5%B0%E5%88%B0%20%24t%24%EF%BC%8C%E6%8E%A5%E8%91%97%20%24Q%24%20%E7%AD%86%E8%A9%A2%E5%95%8F%E7%8D%A8%E7%AB%8B%E5%8A%A0%E5%85%A5%20%24(x%2C%20s)%24%20%E5%92%8C%20%24(t%2C%20y)%24%20%E5%85%A9%E6%A2%9D%E9%82%8A%E5%BE%8C%EF%BC%8C%E6%98%AF%E5%90%A6%E6%9C%83%E5%87%BA%E7%8F%BE%E7%92%B0%E3%80%82%0A%0A%E4%BF%9D%E8%AD%89%E6%AF%8F%E6%AC%A1%E8%A9%A2%E5%95%8F%E6%99%82%E9%83%BD%E6%9C%89%E4%B8%80%E5%80%8B%20%24(x%2C%20y)%24%20%E7%9A%84%E9%82%8A%0A%3A%3A%3A%0A%0A%E8%80%8C%E5%9B%A0%E7%82%BA%20%24s%24%20%E8%83%BD%E8%B5%B0%E5%88%B0%20%24t%24%E3%80%81%24x%24%20%E8%83%BD%E8%B5%B0%E5%88%B0%20%24y%24%EF%BC%8C%E6%89%80%E4%BB%A5%E5%85%B6%E5%AF%A6%E5%8F%AA%E8%A6%81%E5%88%A4%20%24(x%2C%20s)%24%20%E5%92%8C%20%24(t%2C%20y)%24%20%E6%9C%89%E6%B2%92%E6%9C%89%E7%92%B0%E5%B0%B1%E5%A5%BD%E4%BA%86%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E9%A0%90%E8%99%95%E7%90%86%20%24s%24%20%E8%83%BD%E4%B8%8D%E8%83%BD%E8%B5%B0%E5%88%B0%20%24x%24%20%E5%92%8C%20%24y%24%20%E8%83%BD%E4%B8%8D%E8%83%BD%E8%B5%B0%E5%88%B0%20%24t%24%EF%BC%8C%E9%80%99%E5%8F%AF%E4%BB%A5%E7%B7%9A%E6%80%A7%E9%A0%90%E8%99%95%E7%90%86%E3%80%82%0A%0A%E6%95%B4%E9%AB%94%E8%A4%87%E9%9B%9C%E5%BA%A6%E5%B0%B1%E6%98%AF%E5%9C%A8%E5%BB%BA%E5%9C%96%E4%B9%8B%E5%BE%8C%E6%88%90%E7%B7%9A%E6%80%A7%EF%BC%8C%E8%87%B3%E6%96%BC%E5%BB%BA%E5%9C%96%E5%B0%B1%E7%AE%97%E7%94%A8%20map%20%E4%BA%82%E5%BB%BA%E4%B9%9F%E4%B8%8D%E6%9C%83%E7%88%86%E5%B8%B8%E6%95%B8%E3%80%82%20%0A%0A%E9%80%99%E9%A1%8C%E7%9A%84%E9%9B%A3%E5%BA%A6%E5%85%A8%E5%9C%A8%E6%96%87%E7%AB%A0%EF%BC%8C%E5%87%BA%E9%A1%8C%E8%80%85%E4%B9%9F%E5%BC%84%E5%88%B0%E5%BF%AB%E6%9A%B4%E6%96%83%E4%BA%86%EF%BC%8C%E4%BD%86%E5%A4%A7%E5%AE%B6%E7%B5%95%E5%B0%8D%E4%B8%8D%E8%83%BD%E5%BF%BD%E8%A6%96%E9%96%B1%E8%AE%80%E9%80%9A%E9%9D%88%E9%A1%8C%E6%95%98%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7%EF%BC%8C%E6%A1%83%E5%9C%92%E7%AB%99%E6%95%99%E8%82%B2%E4%BA%86%E6%88%91%E5%80%91%E3%80%82%0A%0A%23%23%20Problem%20M.%20More%20Japanese%20Monsters%20%5Bmid%5D%0A%0A**%E7%B0%A1%E5%96%AE%E7%9A%84%E8%A7%A3**%0A%0A%E9%80%99%E9%A1%8C%E9%9B%96%E7%84%B6%E7%AF%84%E5%9C%8D%E6%AF%94%20J%20%E5%A4%A7%EF%BC%8C%E4%BD%86%E8%BC%B8%E5%87%BA%E7%B8%BD%E5%92%8C%E7%9A%84%E6%96%B9%E5%BC%8F%E5%A4%A7%E5%A4%A7%E9%99%8D%E4%BD%8E%E4%BA%86%E9%80%99%E9%A1%8C%E7%9A%84%E9%9B%A3%E5%BA%A6%EF%BC%8C%E6%89%80%E4%BB%A5%E6%9C%89%E4%BA%BA%E9%96%8B%E6%8E%89%20M%20%E6%B2%92%E9%96%8B%E5%87%BA%20J%20%E6%98%AF%E9%9D%9E%E5%B8%B8%E9%A0%90%E6%96%99%E4%B9%8B%E4%B8%AD%E7%9A%84%E3%80%82%0A%0A%E6%88%91%E5%80%91%E5%8F%AF%E4%BB%A5%E5%85%88%E5%B0%87%E5%AD%97%E4%B8%B2%E5%8F%8D%E9%81%8E%E4%BE%86%E5%BE%8C%EF%BC%8C%E8%A8%88%E7%AE%97%20%5BZ-value%5D(https%3A%2F%2Foi-wiki.org%2Fstring%2Fz-func%2F)%20%E5%BE%8C%E5%BE%97%E5%88%B0%20%24z_i%24%EF%BC%8C%E6%8E%A5%E8%91%97%E7%AE%97%20ABAA%20%E7%9A%84%E6%95%B8%E9%87%8F%E3%80%82%0A%0A%E8%A9%A6%E8%91%97%E7%AA%AE%E8%88%89%E7%AC%AC%E4%BA%8C%E5%80%8B%20A%20%E7%9A%84%E9%96%8B%E9%A0%AD%EF%BC%8C%E5%81%87%E8%A8%AD%E6%98%AF%20%24i%24%EF%BC%8C%E9%82%A3%E5%B0%B1%E6%98%AF%E5%95%8F%20%24(i%2C%20i%20%2B%20%5Cmin(z_i%2C%20i%20-%201)%5D%24%20(0-based)%20%E4%B9%8B%E9%96%93%E6%9C%89%E5%A4%9A%E5%B0%91%20%24j%24%20%E6%BB%BF%E8%B6%B3%20%24z_j%20%5Cgeq%20j-i%20%5CRightarrow%20i%20%5Cgeq%20j%20-%20z_j%24%20%0A%0A%E8%80%83%E6%85%AE%E4%B8%80%E5%80%8B%E5%90%88%E6%B3%95%E6%95%B8%E5%B0%8D%20%24(i%2C%20j)%24%EF%BC%8C%E5%85%B6%E5%AF%A6%E4%BB%96%E7%9A%84%E8%B2%A2%E7%8D%BB%E6%98%AF%20%24114514%5E%7Bn%2Bi-2j%7D%24%20%EF%BC%8C%E6%89%80%E4%BB%A5%E5%8F%AA%E8%A6%81%E5%B0%8D%20%24j-z_j%24%20%E6%8E%92%E5%BA%8F%EF%BC%8C%E7%AA%AE%E8%88%89%E5%88%B0%20%24i%24%20%E6%99%82%E5%B7%B2%E7%B6%93%E8%A2%AB%E7%AE%97%E9%81%8E%E7%9A%84%20%24j%24%20%E9%83%BD%E6%9C%89%20%24i%20%5Cgeq%20j-z_j%24%EF%BC%8C%E9%80%99%E6%99%82%E5%80%99%E5%8F%AA%E8%A6%81%E6%9F%A5%E8%A9%A2%E5%B7%B2%E7%B6%93%E8%A2%AB%E7%AE%97%E9%81%8E%E7%9A%84%20%24j%24%20%E4%B8%AD%20%24114514%5E%7B-2j%7D%24%20%E7%9A%84%E5%8D%80%E9%96%93%E5%92%8C%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%B9%98%E4%B8%8A%20%24114514%5E%7Bn%2Bi%7D%24%20%E4%BE%86%E5%BE%97%E5%88%B0%20%24i%24%20%E7%9A%84%E8%B2%A2%E7%8D%BB%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%94%A8%E4%B8%80%E5%80%8B%20BIT%20%E6%90%9E%E5%AE%9A%E3%80%82%0A%0A%E7%B8%BD%E6%99%82%E9%96%93%E8%A4%87%E9%9B%9C%E5%BA%A6%20%24O(N%5Clog%20N)%24%E3%80%82%0A%0A**%E5%A5%97%20%24O(N%20%5Clog%20N)%24%20%E7%9A%84%20J%20%E7%9A%84%E8%A7%A3**%0A%0A%E9%80%99%E9%A1%8C%E7%9A%84%E8%A8%98%E6%86%B6%E9%AB%94%E9%99%90%E5%88%B6%E6%9C%89%E4%B8%80%E9%BB%9E%E7%B7%8A%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%9C%89%E4%BA%BA%E5%9B%A0%E7%82%BA%20LCP%20%E9%96%8B%E5%88%B0%20%24O(N%20%5Clog%20N)%24%20%E7%9A%84%E8%A8%98%E6%86%B6%E9%AB%94%E7%9A%84%E8%A9%B1%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%B3%A8%E6%84%8F%E5%88%B0%E6%88%91%E5%80%91%E7%94%A8%E5%88%B0%20%24%5Ctext%7BLCP%7D%24%20%E7%9A%84%E9%83%A8%E5%88%86%E5%85%B6%E5%AF%A6%E9%83%BD%E6%98%AF%E5%9C%A8%E6%AA%A2%E6%9F%A5%20%24%5Ctext%7BLCP%7D(X%2C%20Y)%24%20%E8%B7%9F%20%24X%24%20%E6%98%AF%E4%B8%8D%E6%98%AF%E7%9B%B8%E7%AD%89%EF%BC%8C%E6%89%80%E4%BB%A5%E5%8F%AF%E4%BB%A5%E4%BE%8B%E5%A6%82%E7%9B%B4%E6%8E%A5%E6%94%B9%E7%94%A8%20Hash%20%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%9C%89%20%24O(N)%24%20%E7%A9%BA%E9%96%93%E7%9A%84%E6%BC%94%E7%AE%97%E6%B3%95%E4%BA%86%E3%80%82%0A%0A%E4%B8%8D%E9%81%8E%E9%9B%96%E7%84%B6%E6%98%AF%20%24O(N%20%5Clog%20N)%24%EF%BC%8C%E4%BD%86%E6%98%AF%E9%80%99%E9%BA%BC%E5%81%9A%E5%B8%B8%E6%95%B8%E7%9B%B8%E8%BC%83%E5%89%8D%E9%9D%A2%E7%B0%A1%E5%96%AE%E7%9A%84%E5%81%9A%E6%B3%95%E5%8F%AF%E8%83%BD%E5%A4%A7%E9%9D%9E%E5%B8%B8%E5%A4%9A%EF%BC%8C%E6%89%80%E4%BB%A5%E9%AB%98%E6%A9%9F%E7%8E%87%E8%A6%81%E5%A3%93%E5%B8%B8%F0%9F%98%B6%0A%0A%23%23%20Random%20Facts%0A%0A-%20Problem%20C%20%E6%BA%90%E6%96%BC%E7%9C%9F%E4%BA%8B%EF%BC%8C%E4%BD%86%E5%9B%A0%E7%82%BA%E4%BA%8B%E4%B8%BB%E6%98%AF%20-1e11%EF%BC%8C%E6%8B%BF%E4%BB%96%E7%95%B6%E4%B8%BB%E8%A7%92%E7%9A%84%E8%A9%B1%E6%9C%83%E6%9A%97%E7%A4%BA%E5%AE%83%E6%98%AF%E6%89%93%E8%A1%A8%E9%A1%8C%EF%BC%8C%E6%89%80%E4%BB%A5%20YP%20%E5%B0%B1%E4%B8%8A%E4%BE%86%E7%95%B6%E4%BB%A3%E7%BD%AA%E7%BE%8A%E4%BA%86%E3%80%82%0A-%20Problem%20E%20%E7%9A%84%E4%BE%86%E6%BA%90%E6%98%AF%20rgnerdplayer%20%E8%A1%A8%E7%A4%BA%E4%BB%96%E4%B8%8D%E6%9C%83%E5%81%9A%E4%BB%BB%E4%BD%95%E5%9C%A8%E4%BA%8C%E7%B6%AD%E5%B9%B3%E9%9D%A2%E4%B8%8A%E6%95%B8%E9%BB%9E%E5%B0%8D%EF%BC%88%E4%BB%96%E7%A8%B1%E4%BA%8C%E7%B6%AD%E6%95%B8%E9%BB%9E%EF%BC%89%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%8C%E6%89%80%E4%BB%A5%E5%87%BA%E9%A1%8C%E7%BE%A4%E6%B1%BA%E5%AE%9A%E5%87%BA%E4%B8%80%E9%A1%8C%E7%9B%B8%E9%97%9C%E7%9A%84%E9%A1%8C%E7%9B%AE%E5%88%B6%E8%A3%81%E4%BB%96%EF%BC%8C%E7%B5%90%E6%9E%9C%E4%BB%96%E9%A6%96%E6%AE%BA%E3%80%82%0A-%20Problem%20F%20%E7%9A%84%E4%BE%86%E6%BA%90%E6%98%AF%E5%87%BA%E9%A1%8C%E8%80%85%E5%9C%A8%E6%89%93%E6%9F%90%E4%B8%80%E5%A0%B4%E6%AF%94%E8%B3%BD%E6%99%82%E7%9C%8B%E9%8C%AF%E9%A1%8C%E7%9B%AE%EF%BC%88%E7%9C%8B%E6%88%90%20version1%EF%BC%89%EF%BC%8C%E5%AF%AB%E5%AE%8C%E4%B9%8B%E5%BE%8C%E9%82%84%E9%81%8E%E7%AF%84%E6%B8%AC%EF%BC%8C%E4%B8%8A%E5%82%B3%E4%B9%8B%E5%BE%8C%20WA%20%E6%88%90%E7%99%BD%E7%97%B4%E6%89%8D%E7%99%BC%E7%8F%BE%E8%87%AA%E5%B7%B1%E7%9C%8B%E9%8C%AF%E3%80%82%E5%BE%8C%E4%BE%86%E6%83%B3%E5%87%BA%E6%88%90%E9%A1%8C%E7%9B%AE%E4%B9%8B%E5%BE%8C%E7%99%BC%E7%8F%BE%E8%87%AA%E5%B7%B1%E5%8F%88%E5%81%87%E8%A7%A3%E4%BA%86%EF%BC%8C%E5%B0%B1%E7%A1%AC%E6%8A%8A%E9%A1%8C%E7%9B%AE%E6%94%B9%E5%A4%A7%E5%AE%B6%E8%B3%BD%E4%B8%AD%E7%9C%8B%E5%88%B0%E7%9A%84%E6%A8%A3%E5%AD%90%EF%BC%88version2%2C%20current%20version%EF%BC%89%E3%80%82%0A-%20Problem%20G%20%E7%9A%84%E4%BE%86%E6%BA%90%E6%98%AF%E5%87%BA%E9%A1%8C%E8%80%85%E5%9C%98%E7%B7%B4%E6%99%82%E4%B8%8D%E6%9C%83%E5%81%9A%E7%9A%84%E9%A1%8C%E7%9B%AE%EF%BC%8C%E5%9C%A8%E5%98%97%E8%A9%A6%E6%8A%8A%E6%9C%80%E5%B0%8F%E5%89%B2%20append%20%E5%8E%9F%E9%A1%8C%E6%99%82%E8%A6%BA%E5%BE%97%E5%BE%88%E7%BE%8E%E9%BA%97%EF%BC%8C%E5%8D%BB%E7%99%BC%E7%8F%BE%E5%8E%9F%E9%A1%8C%E7%9A%84%E9%99%90%E5%88%B6%E8%AE%93%E6%9C%80%E5%B0%8F%E5%89%B2%E8%A1%8C%E4%B8%8D%E9%80%9A%EF%BC%8C%E7%B5%90%E6%9E%9C%E6%9C%80%E7%B5%82%E8%A7%A3%E7%AD%94%E4%B9%9F%E8%B7%9F%E6%9C%80%E5%B0%8F%E5%89%B2%E4%B8%80%E9%BB%9E%E9%97%9C%E4%BF%82%E9%83%BD%E6%B2%92%E6%9C%89%EF%BC%8C%E6%89%80%E4%BB%A5%E5%B0%B1%E6%9A%B4%E5%8A%9B%E6%94%B9%E9%99%90%E5%88%B6%E8%AE%8A%E6%88%90%E7%8F%BE%E5%9C%A8%E7%9A%84%E9%A1%8C%E7%9B%AE%E4%BA%86%E3%80%82%0A-%20Problem%20H%20%E7%9A%84%E4%BE%86%E6%BA%90%E6%98%AF%20IOI%202022%20%E5%9C%8B%E6%89%8B%E5%80%91%E7%99%BC%E6%98%8E%E7%9A%84%E3%80%8C%E8%A5%BF%E7%93%9C%E5%9C%96%E3%80%8D%EF%BC%8C%E4%BD%86%E5%85%B6%E5%AF%A6%E5%87%BA%E9%A1%8C%E7%BE%A4%E6%B2%92%E6%9C%89%E4%BB%BB%E4%BD%95%20IOI%202022%20%E5%9C%8B%E6%89%8B%EF%BC%8C%E6%88%91%E5%80%91%E6%84%9F%E8%AC%9D%E5%9C%8B%E6%89%8B%E5%80%91%E6%8F%90%E4%BE%9B%E9%9D%88%E6%84%9F%E3%80%82%0A-%20Problem%20J%20%E6%98%AF%E8%87%A8%E6%99%82%E8%A2%AB%E5%8A%A0%E9%80%B2%E4%BE%86%E7%9A%84%E9%A1%8C%E7%9B%AE%EF%BC%8C%E5%8E%9F%E6%9C%AC%E5%8F%AA%E6%9C%89%20Problem%20M%EF%BC%8C%E4%BD%86%E6%AF%94%E8%B3%BD%E5%89%8D%E4%B8%80%E9%99%A3%E5%AD%90%E8%B2%A0%E8%B2%AC%E7%9A%84%E5%87%BA%E9%A1%8C%E8%80%85%E5%B0%B1%E8%A1%A8%E7%A4%BA%E4%BB%96%E5%8F%AF%E4%BB%A5%E8%BC%B8%E5%87%BA%E6%89%80%E6%9C%89%E5%B0%8D%E6%96%BC%E6%AF%8F%E4%B8%80%E5%80%8B%E5%BE%8C%E7%B6%B4%E9%83%BD%E8%BC%B8%E5%87%BA%EF%BC%8C%E4%BD%86%E5%A4%A7%E5%AE%B6%E5%AF%A6%E5%9C%A8%E6%98%AF%E5%A4%AA%E5%BF%99%E4%BA%86%E5%B0%B1%E6%B2%92%E6%9C%89%E5%B9%AB%E4%BB%96%E6%83%B3%E8%83%BD%E4%B8%8D%E8%83%BD%E6%9B%B4%E7%B0%A1%E5%96%AE%E3%80%82%0A-%20Problem%20K%20%E5%85%B6%E5%AF%A6%E5%8F%AF%E4%BB%A5%E6%8A%8A%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%E6%94%B9%E6%88%90%20%24%5Clangle%20O(1)%2C%20O(%5Csqrt%7BN%7D)%5Crangle%24%EF%BC%8C%E9%80%B2%E8%80%8C%E8%AE%93%E8%A4%87%E9%9B%9C%E5%BA%A6%E8%AE%8A%E6%88%90%20%24O(N%5Clog%20C%20%2B%20Q%5Csqrt%7BN%7D)%24%EF%BC%8C%E4%BD%86%20%24N%24%20%E9%82%A3%E9%82%8A%E7%9A%84%E5%B8%B8%E6%95%B8%E7%9C%9F%E7%9A%84%E5%BE%88%E5%A4%A7%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%80%99%E6%A8%A3%E5%87%BA%E7%9A%84%E8%A9%B1%E6%99%82%E9%99%90%E6%9C%83%E8%A2%AB%E8%AA%BF%E5%88%B0%E9%9D%9E%E5%B8%B8%E5%A4%A7%EF%BC%8C%E4%B8%8D%E7%84%B6%E6%9C%89%E9%80%9A%E9%81%8E%E7%9A%84%E9%9A%8A%E4%BC%8D%E7%9A%84%E5%81%9A%E6%B3%95%E5%85%B6%E5%AF%A6%E9%83%BD%E5%8F%AF%E4%BB%A5%E8%A2%AB%E5%8D%A1%E6%8E%89%EF%BC%88%EF%BC%B8%0A-%20Problem%20L%20%E5%AF%A6%E9%9A%9B%E4%B8%8A%E6%98%AF%E4%B8%80%E5%80%8B%E7%8F%BE%E5%AF%A6%E5%AD%98%E5%9C%A8%E7%9A%84%E5%95%8F%E9%A1%8C%EF%BC%8C%E9%A1%8C%E7%9B%AE%E4%BE%86%E6%BA%90%E4%BE%86%E8%87%AA%E6%9F%90%E4%B8%80%E4%BD%8D%E9%80%80%E5%BD%B9%E9%81%B8%E6%89%8B%E7%9A%84%E5%B7%A5%E4%BD%9C%E9%9C%80%E6%B1%82%E3%80%82","viewMode":"publish","isOwner":false,"isSignIn":false,"isLiked":false,"isBookmarked":false,"publishType":"view","commentCount":0,"isNotesRecommendationsEnabled":true,"recommendedNotes":[],"lastChangeUserInfo":{"name":"%E6%B3%A2%E8%B7%AF%E7%89%B9%E7%9F%B3","path":"baluteshih","avatarUrl":"https%3A%2F%2Flh3.googleusercontent.com%2F-CKX82J9UNKM%2FAAAAAAAAAAI%2FAAAAAAAAACA%2FosF3Ho7GK5E%2Fphoto.jpg%3Fsz%3D96"}}`);
  (function () {
    const decodeStringProps = (props) => {
      for (const key in props) {
        if (typeof props[key] === 'string') {
          props[key] = decodeURIComponent(props[key])
        } else if (typeof props[key] === 'object') {
          decodeStringProps(props[key])
        }
      }
    }
    decodeStringProps(window.publishProps)
  })()
</script>

    <meta id="style-tag-insertion">

    <script src="./# 2023 團體預賽題解 - HackMD_files/embed.js.下载"></script><style type="text/css">@keyframes index-module_spin__r2-rl{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes index-module_wave__JTStX{0%{transform:rotate(0deg)}50%{transform:rotate(20deg)}to{transform:rotate(0deg)}}@keyframes index-module_heartBeat__Jdux6{0%{transform:scale(1)}50%{transform:scale(1.08)}to{transform:scale(1)}}@keyframes index-module_flash__BHax5{0%,50%,to{opacity:1}25%,75%{opacity:.2}}@keyframes index-module_bounce__46Q2t{0%,20%,53%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-30px,0) scaleY(1.1)}70%{transform:translate3d(0,-15px,0) scaleY(1.05)}80%{transform:translateZ(0) scaleY(.95)}90%{transform:translate3d(0,-4px,0) scaleY(1.02)}}@keyframes index-module_rubberBand__QnP44{0%{transform:scaleX(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleX(1)}}@keyframes index-module_headShake__4JK7O{0%{transform:translateX(0)}6.5%{transform:translateX(-6px) rotateY(-9deg)}18.5%{transform:translateX(5px) rotateY(7deg)}31.5%{transform:translateX(-3px) rotateY(-5deg)}43.5%{transform:translateX(2px) rotateY(3deg)}50%{transform:translateX(0)}}@keyframes index-module_tada__m5Cd2{0%{transform:scaleX(1)}10%,20%{transform:scale3d(.9,.9,.9) rotate(-3deg)}30%,50%,70%,90%{transform:scale3d(1.1,1.1,1.1) rotate(3deg)}40%,60%,80%{transform:scale3d(1.1,1.1,1.1) rotate(-3deg)}to{transform:scaleX(1)}}.index-module_overlay__PyXAN{-ms-flex-pack:center;-ms-flex-align:center;align-items:center;background-color:hsla(0,0%,6%,.6);bottom:0;display:-ms-flexbox;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:1000000006}.index-module_layoutDefault__7yBRe{bottom:20px;position:fixed;right:20px;width:auto}.index-module_layoutDefault__7yBRe,.index-module_layoutModal__3-Tik{background-color:transparent;border-radius:5px;box-shadow:0 0 0 1px hsla(0,0%,6%,.05),0 3px 6px hsla(0,0%,6%,.1),0 9px 24px hsla(0,0%,6%,.2);display:-ms-flexbox;display:flex;height:auto;max-width:95vw;opacity:0;z-index:2147483000}.index-module_layoutModal__3-Tik{position:relative;width:700px}.index-module_popupContainer__R7hrk{border-radius:5px;display:-ms-flexbox;display:flex;overflow-y:auto;width:100%}.index-module_popupContainer__R7hrk iframe{border-radius:5px;max-height:95vh}.index-module_loadingIndicator__bai61{-ms-flex-align:center;-ms-flex-pack:center;align-items:center;background-color:#f5f5f5;border-radius:50%;color:#444;display:-ms-inline-flexbox;display:inline-flex;height:50px;justify-content:center;position:absolute;width:50px;z-index:2147483000}.index-module_loadingIndicatorNoOverlay__Pyhdd{bottom:10px;position:fixed;right:10px}.index-module_loadingIndicator__bai61 svg{animation:index-module_spin__r2-rl 1.618s linear infinite;height:20px;width:20px}.index-module_emoji__MDuRJ{display:inline-block;font-size:42px;left:-21px;line-height:1;position:absolute;top:-21px}.index-module_animate__wave__Rfv7x{animation:index-module_wave__JTStX 1s ease-in-out 20}.index-module_animate__heart-beat__M8Vjv{animation:index-module_heartBeat__Jdux6 1.3s ease-in-out 20}.index-module_animate__flash__zfXXt{animation:index-module_flash__BHax5 2.5s 20}.index-module_animate__bounce__YkmGJ{animation:index-module_bounce__46Q2t 1.5s 20;-ms-transform-origin:center bottom;transform-origin:center bottom}.index-module_animate__rubber-band__o0ymG{animation:index-module_rubberBand__QnP44 1.5s 20}.index-module_animate__head-shake__SgYWR{animation:index-module_headShake__4JK7O 1.5s ease-in-out 20}.index-module_animate__tada__3dUYE{animation:index-module_tada__m5Cd2 1.5s 20}.index-module_animate__spin__dJxXR{animation:index-module_spin__r2-rl 1.618s linear 20}@media (max-height:1000px){.index-module_popupContainer__R7hrk iframe{max-height:85vh}}@media (max-width:576px){.index-module_popupContainer__R7hrk iframe{max-height:70vh}.index-module_layoutDefault__7yBRe,.index-module_layoutModal__3-Tik{max-width:calc(100% - 40px)}}</style>

    
<style id="googleidentityservice_button_styles" nonce="">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style></style><link rel="stylesheet" type="text/css" href="./# 2023 團體預賽題解 - HackMD_files/fretboard.7a98c97ae43fb8ca354b.css"><script charset="utf-8" src="./# 2023 團體預賽題解 - HackMD_files/tex-mml-chtml.js.下载"></script><script src="./# 2023 團體預賽題解 - HackMD_files/safe.js.下载" charset="UTF-8"></script><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  border-collapse: collapse;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-mover {
  display: inline-block;
  text-align: left;
}

mjx-mover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-mover:not([limits="false"]) > * {
  display: block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  /* IE */ overflow: hidden;
  /* others */ overflow: clip visible;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  /* IE */ overflow: hidden;
  /* others */ overflow: visible clip;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
  box-sizing: border-box;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.075em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-TeXAtom {
  display: inline-block;
  text-align: left;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-mtable {
  display: inline-block;
  text-align: center;
  vertical-align: .25em;
  position: relative;
  box-sizing: border-box;
  border-spacing: 0;
  border-collapse: collapse;
}

mjx-mstyle[size="s"] mjx-mtable {
  vertical-align: .354em;
}

mjx-labels {
  position: absolute;
  left: 0;
  top: 0;
}

mjx-table {
  display: inline-block;
  vertical-align: -.5ex;
  box-sizing: border-box;
}

mjx-table > mjx-itable {
  vertical-align: middle;
  text-align: left;
  box-sizing: border-box;
}

mjx-labels > mjx-itable {
  position: absolute;
  top: 0;
}

mjx-mtable[justify="left"] {
  text-align: left;
}

mjx-mtable[justify="right"] {
  text-align: right;
}

mjx-mtable[justify="left"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="left"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[justify="right"][side="left"] {
  padding-right: 0 ! important;
}

mjx-mtable[justify="right"][side="right"] {
  padding-left: 0 ! important;
}

mjx-mtable[align] {
  vertical-align: baseline;
}

mjx-mtable[align="top"] > mjx-table {
  vertical-align: top;
}

mjx-mtable[align="bottom"] > mjx-table {
  vertical-align: bottom;
}

mjx-mtable[side="right"] mjx-labels {
  min-width: 100%;
}

mjx-mtr {
  display: table-row;
  text-align: left;
}

mjx-mtr[rowalign="top"] > mjx-mtd {
  vertical-align: top;
}

mjx-mtr[rowalign="center"] > mjx-mtd {
  vertical-align: middle;
}

mjx-mtr[rowalign="bottom"] > mjx-mtd {
  vertical-align: bottom;
}

mjx-mtr[rowalign="baseline"] > mjx-mtd {
  vertical-align: baseline;
}

mjx-mtr[rowalign="axis"] > mjx-mtd {
  vertical-align: .25em;
}

mjx-mtd {
  display: table-cell;
  text-align: center;
  padding: .215em .4em;
}

mjx-mtd:first-child {
  padding-left: 0;
}

mjx-mtd:last-child {
  padding-right: 0;
}

mjx-mtable > * > mjx-itable > *:first-child > mjx-mtd {
  padding-top: 0;
}

mjx-mtable > * > mjx-itable > *:last-child > mjx-mtd {
  padding-bottom: 0;
}

mjx-tstrut {
  display: inline-block;
  height: 1em;
  vertical-align: -.25em;
}

mjx-labels[align="left"] > mjx-mtr > mjx-mtd {
  text-align: left;
}

mjx-labels[align="right"] > mjx-mtr > mjx-mtd {
  text-align: right;
}

mjx-mtd[extra] {
  padding: 0;
}

mjx-mtd[rowalign="top"] {
  vertical-align: top;
}

mjx-mtd[rowalign="center"] {
  vertical-align: middle;
}

mjx-mtd[rowalign="bottom"] {
  vertical-align: bottom;
}

mjx-mtd[rowalign="baseline"] {
  vertical-align: baseline;
}

mjx-mtd[rowalign="axis"] {
  vertical-align: .25em;
}

mjx-msubsup {
  display: inline-block;
  text-align: left;
}

mjx-script {
  display: inline-block;
  padding-right: .05em;
  padding-left: .033em;
}

mjx-script > mjx-spacer {
  display: block;
}

mjx-mspace {
  display: inline-block;
  text-align: left;
}

mjx-msqrt {
  display: inline-block;
  text-align: left;
}

mjx-root {
  display: inline-block;
  white-space: nowrap;
}

mjx-surd {
  display: inline-block;
  vertical-align: top;
}

mjx-sqrt {
  display: inline-block;
  padding-top: .07em;
}

mjx-sqrt > mjx-box {
  border-top: .07em solid;
}

mjx-sqrt.mjx-tall > mjx-box {
  padding-left: .3em;
  margin-left: -.3em;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://assets.hackmd.io/build/MathJax3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-stretchy-h.mjx-c2192 mjx-ext mjx-c::before {
  content: "\2212";
  padding: 0.583em 0 0.082em 0;
}

mjx-stretchy-h.mjx-c2192 mjx-end mjx-c::before {
  content: "\2192";
  padding: 0.583em 0 0.082em 0;
}

mjx-stretchy-v.mjx-c7B mjx-beg mjx-c::before {
  content: "\23A7";
  padding: 0.899em 0.889em 0.01em 0;
}

mjx-stretchy-v.mjx-c7B mjx-ext mjx-c::before {
  content: "\23AA";
  width: 0.889em;
}

mjx-stretchy-v.mjx-c7B mjx-end mjx-c::before {
  content: "\23A9";
  padding: 0.01em 0.889em 0.899em 0;
}

mjx-stretchy-v.mjx-c7B mjx-mid mjx-c::before {
  content: "\23A8";
  padding: 1.16em 0.889em 0.66em 0;
}

mjx-stretchy-v.mjx-c7B > mjx-mid {
  margin-top: -0.91em;
  margin-bottom: -0.91em;
}

mjx-stretchy-v.mjx-c7B > mjx-end {
  margin-top: -0.909em;
}

mjx-stretchy-v.mjx-c7B > mjx-ext {
  height: 50%;
  border-top-width: 0.879em;
  border-bottom-width: 0.879em;
}

mjx-c.mjx-c1D45D.TEX-I::before {
  padding: 0.442em 0.503em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c1D45E.TEX-I::before {
  padding: 0.442em 0.46em 0.194em 0;
  content: "q";
}

mjx-c.mjx-c1D456.TEX-I::before {
  padding: 0.661em 0.345em 0.011em 0;
  content: "i";
}

mjx-c.mjx-c1D442.TEX-I::before {
  padding: 0.704em 0.763em 0.022em 0;
  content: "O";
}

mjx-c.mjx-c28::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "(";
}

mjx-c.mjx-c1D441.TEX-I::before {
  padding: 0.683em 0.888em 0 0;
  content: "N";
}

mjx-c.mjx-c1D440.TEX-I::before {
  padding: 0.683em 1.051em 0 0;
  content: "M";
}

mjx-c.mjx-c29::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: ")";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c2264::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2264";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c34::before {
  padding: 0.677em 0.5em 0 0;
  content: "4";
}

mjx-c.mjx-c3E::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: ">";
}

mjx-c.mjx-c6C::before {
  padding: 0.694em 0.278em 0 0;
  content: "l";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c67::before {
  padding: 0.453em 0.5em 0.206em 0;
  content: "g";
}

mjx-c.mjx-c2061::before {
  padding: 0 0 0 0;
  content: "";
}

mjx-c.mjx-c35::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "5";
}

mjx-c.mjx-c39::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "9";
}

mjx-c.mjx-c1D44E.TEX-I::before {
  padding: 0.441em 0.529em 0.01em 0;
  content: "a";
}

mjx-c.mjx-c1D457.TEX-I::before {
  padding: 0.661em 0.412em 0.204em 0;
  content: "j";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c2200::before {
  padding: 0.694em 0.556em 0.022em 0;
  content: "\2200";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c2026::before {
  padding: 0.12em 1.172em 0 0;
  content: "\2026";
}

mjx-c.mjx-c5B::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "[";
}

mjx-c.mjx-c36::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "6";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}

mjx-c.mjx-c5D::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "]";
}

mjx-c.mjx-c2212::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "\2212";
}

mjx-c.mjx-c7C::before {
  padding: 0.75em 0.278em 0.249em 0;
  content: "|";
}

mjx-c.mjx-c1D467.TEX-I::before {
  padding: 0.442em 0.465em 0.011em 0;
  content: "z";
}

mjx-c.mjx-c2260::before {
  padding: 0.716em 0.778em 0.215em 0;
  content: "\2260";
}

mjx-c.mjx-c1D436.TEX-I::before {
  padding: 0.705em 0.76em 0.022em 0;
  content: "C";
}

mjx-c.mjx-c7B::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "{";
}

mjx-c.mjx-c7D::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "}";
}

mjx-c.mjx-c28.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: "(";
}

mjx-c.mjx-c21::before {
  padding: 0.716em 0.278em 0 0;
  content: "!";
}

mjx-c.mjx-c1D45B.TEX-I::before {
  padding: 0.442em 0.6em 0.011em 0;
  content: "n";
}

mjx-c.mjx-c29.TEX-S3::before {
  padding: 1.45em 0.736em 0.949em 0;
  content: ")";
}

mjx-c.mjx-c2248::before {
  padding: 0.483em 0.778em 0 0;
  content: "\2248";
}

mjx-c.mjx-c1D452.TEX-I::before {
  padding: 0.442em 0.466em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c25::before {
  padding: 0.75em 0.833em 0.056em 0;
  content: "%";
}

mjx-c.mjx-c1D458.TEX-I::before {
  padding: 0.694em 0.521em 0.011em 0;
  content: "k";
}

mjx-c.mjx-c3C::before {
  padding: 0.54em 0.778em 0.04em 0;
  content: "<";
}

mjx-c.mjx-c1D460.TEX-I::before {
  padding: 0.442em 0.469em 0.01em 0;
  content: "s";
}

mjx-c.mjx-c1D465.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "x";
}

mjx-c.mjx-c1D435.TEX-I::before {
  padding: 0.683em 0.759em 0 0;
  content: "B";
}

mjx-c.mjx-c1D451.TEX-I::before {
  padding: 0.694em 0.52em 0.01em 0;
  content: "d";
}

mjx-c.mjx-c222A::before {
  padding: 0.598em 0.667em 0.022em 0;
  content: "\222A";
}

mjx-c.mjx-c22EF::before {
  padding: 0.31em 1.172em 0 0;
  content: "\22EF";
}

mjx-c.mjx-c1D459.TEX-I::before {
  padding: 0.694em 0.298em 0.011em 0;
  content: "l";
}

mjx-c.mjx-c1D45F.TEX-I::before {
  padding: 0.442em 0.451em 0.011em 0;
  content: "r";
}

mjx-c.mjx-c1D446.TEX-I::before {
  padding: 0.705em 0.645em 0.022em 0;
  content: "S";
}

mjx-c.mjx-c223C::before {
  padding: 0.367em 0.778em 0 0;
  content: "\223C";
}

mjx-c.mjx-c2208::before {
  padding: 0.54em 0.667em 0.04em 0;
  content: "\2208";
}

mjx-c.mjx-c22C5::before {
  padding: 0.31em 0.278em 0 0;
  content: "\22C5";
}

mjx-c.mjx-c2F::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "/";
}

mjx-c.mjx-c2032::before {
  padding: 0.56em 0.275em 0 0;
  content: "\2032";
}

mjx-c.mjx-c6D::before {
  padding: 0.442em 0.833em 0 0;
  content: "m";
}

mjx-c.mjx-c61::before {
  padding: 0.448em 0.5em 0.011em 0;
  content: "a";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-c64::before {
  padding: 0.694em 0.556em 0.011em 0;
  content: "d";
}

mjx-c.mjx-c221A::before {
  padding: 0.8em 0.853em 0.2em 0;
  content: "\221A";
}

mjx-c.mjx-c1D462.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c1D463.TEX-I::before {
  padding: 0.443em 0.485em 0.011em 0;
  content: "v";
}

mjx-c.mjx-c1D450.TEX-I::before {
  padding: 0.442em 0.433em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c1D466.TEX-I::before {
  padding: 0.442em 0.49em 0.205em 0;
  content: "y";
}

mjx-c.mjx-c1D44F.TEX-I::before {
  padding: 0.694em 0.429em 0.011em 0;
  content: "b";
}

mjx-c.mjx-c1D447.TEX-I::before {
  padding: 0.677em 0.704em 0 0;
  content: "T";
}

mjx-c.mjx-c1D464.TEX-I::before {
  padding: 0.443em 0.716em 0.011em 0;
  content: "w";
}

mjx-c.mjx-c1D43B.TEX-I::before {
  padding: 0.683em 0.888em 0 0;
  content: "H";
}

mjx-c.mjx-c2211.TEX-S1::before {
  padding: 0.75em 1.056em 0.25em 0;
  content: "\2211";
}

mjx-c.mjx-c220F.TEX-S1::before {
  padding: 0.75em 0.944em 0.25em 0;
  content: "\220F";
}

mjx-c.mjx-c53::before {
  padding: 0.705em 0.556em 0.022em 0;
  content: "S";
}

mjx-c.mjx-c75::before {
  padding: 0.442em 0.556em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c66::before {
  padding: 0.705em 0.372em 0 0;
  content: "f";
}

mjx-c.mjx-c1D434.TEX-I::before {
  padding: 0.716em 0.75em 0 0;
  content: "A";
}

mjx-c.mjx-c4C::before {
  padding: 0.683em 0.625em 0 0;
  content: "L";
}

mjx-c.mjx-c43::before {
  padding: 0.705em 0.722em 0.021em 0;
  content: "C";
}

mjx-c.mjx-c50::before {
  padding: 0.683em 0.681em 0 0;
  content: "P";
}

mjx-c.mjx-c2265::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2265";
}

mjx-c.mjx-c1D448.TEX-I::before {
  padding: 0.683em 0.767em 0.022em 0;
  content: "U";
}

mjx-c.mjx-c27F9::before {
  padding: 0.525em 1.638em 0.024em 0;
  content: "\27F9";
}

mjx-c.mjx-c1D449.TEX-I::before {
  padding: 0.683em 0.769em 0.022em 0;
  content: "V";
}

mjx-c.mjx-c1D43F.TEX-I::before {
  padding: 0.683em 0.681em 0 0;
  content: "L";
}

mjx-c.mjx-c1D445.TEX-I::before {
  padding: 0.683em 0.759em 0.021em 0;
  content: "R";
}

mjx-c.mjx-c230A::before {
  padding: 0.75em 0.444em 0.25em 0;
  content: "\230A";
}

mjx-c.mjx-c230B::before {
  padding: 0.75em 0.444em 0.25em 0;
  content: "\230B";
}

mjx-c.mjx-c1D453.TEX-I::before {
  padding: 0.705em 0.55em 0.205em 0;
  content: "f";
}

mjx-c.mjx-c1D444.TEX-I::before {
  padding: 0.704em 0.791em 0.194em 0;
  content: "Q";
}

mjx-c.mjx-c1D461.TEX-I::before {
  padding: 0.626em 0.361em 0.011em 0;
  content: "t";
}

mjx-c.mjx-c69::before {
  padding: 0.669em 0.278em 0 0;
  content: "i";
}

mjx-c.mjx-c6E::before {
  padding: 0.442em 0.556em 0 0;
  content: "n";
}

mjx-c.mjx-c21D2::before {
  padding: 0.525em 1em 0.024em 0;
  content: "\21D2";
}

mjx-c.mjx-c1D44B.TEX-I::before {
  padding: 0.683em 0.852em 0 0;
  content: "X";
}

mjx-c.mjx-c1D44C.TEX-I::before {
  padding: 0.683em 0.763em 0 0;
  content: "Y";
}

mjx-c.mjx-c27E8::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "\27E8";
}

mjx-c.mjx-c27E9::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "\27E9";
}
</style><link id="googleidentityservice" type="text/css" media="all" href="https://accounts.google.com/gsi/style" rel="stylesheet"></head>

<body style="--hmd-comment-panel-width: 348px;" theme="light" data-view-theme="light" class="pretty-comment-panel">
    <div id="publish-page"><div id="meta-title-tags" class="sticky top-0 z-[1000] w-full max-w-full overflow-hidden"><div class="flex w-full py-2.5 justify-between sticky top-0 bg-background-blur backdrop-blur-[12px] px-4 h-auto min-h-[50px] items-center max-w-full overflow-hidden gap-5"><div class="flex gap-2.5 items-center overflow-hidden max-w-[65%]" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-1" data-state="closed"><span class="w-full overflow-hidden"><div class="m-0 text-[16px] leading-[20px] font-bold text-text-emphasize break-words overflow-ellipsis whitespace-nowrap overflow-hidden" title="# 2023 團體預賽題解"># 2023 團體預賽題解</div></span><div></div></div><span class="flex flex-row gap-3"><button class="rounded px-2.5 py-2 font-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid community-button ui-view-theme gap-0.5 !py-1.5 !px-2 text-sm leading-sm" data-toggle="tooltip" data-placement="bottom" data-original-title="選擇色彩模式" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-0" data-state="closed"><i class="ph ph-paint-brush text-normal leading-[14px]"></i></button><a href="https://hackmd.io/?utm_source=view-page&amp;utm_medium=logo-nav" class="ui-pretty-logo-home font-bold font-brand-headline text-icon-emphasize hocus:no-underline hocus:text-text-default text-right whitespace-nowrap text-lg flex"><span class="flex justify-center items-center">Try  <img class="w-auto h-6" src="./# 2023 團體預賽題解 - HackMD_files/Logo.svg"> HackMD</span></a></span></div></div><div class="ui-infobar container-fluid unselectable hidden-print comment-enabled"><div class="row"><div class="col-xs-12 ui-infobar-inner flex items-start"><div class="ui-infobar__user-info"><ul class="list-inline mb-0 w-full"><li class="w-full"><div class="flex w-full gap-[9px] text-4"><span class="mt-[7px] flex justify-center ui-owner" data-profile="baluteshih"> <a class="ui-user-icon m-0 inline-block h-[28px] w-[28px] user-card-popover" target="_blank" href="https://hackmd.io/@baluteshih" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96&quot;);" data-original-title="" title=""></a></span><div class="flex w-[calc(100%-32px)] min-w-0 flex-col items-start"><div class="w-auto max-w-full break-words"><a class="text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-profile="baluteshih" href="https://hackmd.io/@baluteshih" data-toggle="popover" data-original-title="" title="">波路特石</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">追蹤</button></span></div></div><div class="flex w-full text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><div class="w-auto max-w-full break-words"><span class="ui-status-lastchange [&amp;_a]:text-link-text-default [&amp;_a]:hocus:text-link-text-hover">最後由 <a class="user user-card-popover" href="https://hackmd.io/@baluteshih" data-toggle="popover" data-original-title="" title="">波路特石</a> 於 <span title="2023年8月6日星期日 03:20">2023年8月6日</span> 編輯</span><span class="ui-lastchange" data-createtime="1690617206669" data-updatetime="1691263231004"></span></div><span class="ui-more-info ml-1.5 inline-flex h-fit p-[1.5px]" data-toggle="popover" style="display: none;" data-original-title="" title=""><i class="h-fit text-[13px] leading-[13px] fa fa-github"></i><div class="more-info-raw hmd-dn"><span class="ui-connectedGithub note-status-row hmd-dn text-text-subtle [&amp;_a]:text-text-subtle [&amp;_a]:hover:text-text-subtle"><span class="flex flex-row gap-1.5"><i class="w-5 text-center text-[20px] leading-lg fa fa-github"></i><a class="ui-synced-text">與 GitHub 同步</a></span><span class="flex flex-row gap-1.5"><span class="w-5"></span><a class="file-path" target="_blank"></a></span></span></div></span></div><div class="ui-contributor flex">貢獻者：<div class="ml-2 flex items-center gap-1"><a href="https://hackmd.io/@baluteshih"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a><a href="https://hackmd.io/@ibvHdex5RpCsTJxvYJS25g"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://www.gravatar.com/avatar/05104e7330b8dfba1a126ca445c522a0?s=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a><a href="https://hackmd.io/@cychien"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://www.gravatar.com/avatar/3b241547b5cb2012977f8acb24dc6155?s=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a><a href="https://hackmd.io/@oToToT"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://graph.facebook.com/1109072769198319/picture?width=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a><a href="https://hackmd.io/@omeletwithoutegg"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://graph.facebook.com/1054294144755214/picture?width=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a><a href="https://hackmd.io/@tMoidVweSi653v-pb3sLyg"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/a-/AAuE7mD9g2HIbqUXUyzo1wV1hGeKVQPlnKKfKtiWuqmq&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a></div></div></div></div></li></ul></div><div class="hmd-text-right ui-infobar__actions items-center"><ul class="list-inline mb-0"><li class="!flex"><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="讚賞"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="bottom" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="收藏"><i class="ph ph-bookmark-simple"></i></a><a class="community-button hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#"><i class="ph ph-bell"></i></a></li></ul></div><div class="clearfix"></div></div></div><div class="ui-comment-app" id="hackmd-app" style="right: -64px; width: 64px;"><div id="comment-app"><div class="open-comments open-comments-panel fixed z-[1049] !w-16"><div><button class="m-0 ui-open-comments flex gap-1 items-center p-2.5 h-[38px] text-normal leading-normal text-text-default bg-background-default rounded border border-solid border-border-default hover:bg-element-bg-hover hover:text-text-emphasize"><i class="ph ph-chat-circle-dots text-5 leading-sm" aria-hidden="true"></i><span class="text">0</span></button></div></div><div class="comments-scroller"><div class="comments-containers"></div></div></div></div></div><div class="ui-comment-app" style="right: -64px; width: 64px;"><div id="comments-panel-portal" style="display: none;"><div class="ui-comment-panel-root flex flex-row-reverse fixed select-text overflow-y-auto overflow-x-hidden transition-all duration-200 top-0 h-[100dvh] max-h-[100dvh] react-resizable" style="width: 348px;"><div class="flex h-full min-w-0 flex-grow flex-col overflow-auto bg-background-sunken"><div class="ui-comment-panel-navbar sticky top-0 z-10 box-border flex flex-col text-4 leading-[16px] border-0 border-b-1 border-solid border-b-border-default border-t-1 border-t-border-default"><div class="flex flex-row items-center justify-between gap-1 bg-background-subtler py-1 pl-2 pr-4"><button class="p-0 m-0 bg-transparent border-none w-[155px] min-w-0 rounded px-3 py-2.5 text-normal leading-normal text-text-default hocus:bg-element-bg-hover hocus:text-text-emphasize" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-2" data-state="closed"><span class="flex flex-row items-center gap-1.5"><span class="flex min-w-0 flex-grow flex-row items-center gap-1.5"><i class="ph ph-chat-circle-dots text-lg leading-sm"></i><span class="min-w-0 flex-grow overflow-hidden overflow-ellipsis whitespace-nowrap text-left">留言</span></span><i class="ph text-lg leading-sm ph-caret-down"></i></span></button><span class="flex flex-shrink-0 flex-row items-center gap-1.5 text-text-default"><button class="m-0 bg-transparent ui-comment-feedback p-1.5 text-sm leading-sm text-text-default rounded border border-solid border-border-default hocus:bg-element-bg-hover hocus:text-text-emphasize" data-tally-open="wo95EN" data-tally-emoji-text="👋" data-tally-emoji-animation="wave">使用回饋</button><button class="rounded px-2.5 py-2 text-normal font-normal leading-normal flex bg-transparent text-text-default border-none focus:border focus:border-solid hocus:bg-element-bg-hover focus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid" data-toggle="tooltip" data-original-title="固定右側面板"><i class="ph ph-push-pin" aria-hidden="true"></i></button><button class="m-0 bg-transparent border-none inline-flex cursor-pointer items-center justify-center p-1.5 text-[16px] leading-sm"><i class="ph ph-x" aria-hidden="true"></i></button></span></div><div class="flex flex-col gap-2.5 bg-background-primary-subtler p-4.5 border-0 border-t-1 border-solid border-border-default"><span class="text-sm font-semibold leading-sm text-text-emphasize">登入以編輯或刪除留言，有新留言也會通知您。</span><div class="flex flex-row justify-between text-sm font-normal leading-sm [&amp;&gt;a]:text-link-text-default [&amp;&gt;a]:underline [&amp;&gt;a:hover]:text-link-text-hover [&amp;&gt;a:focus]:text-link-text-hover"><a href="https://hackmd.io/join" class="plausible-event-name=UserNoteCommentSignup">註冊</a><a class="cursor-pointer">已有帳號？登入</a></div></div></div><div class="mt-20 flex flex-col items-center gap-5 px-[58.5px] text-center"><span class="px-[30px] py-3"><img src="./# 2023 團體預賽題解 - HackMD_files/new-comment-placeholder-light.svg"></span><span class="flex flex-col items-center gap-3"><span class="text-normal font-semibold leading-normal text-text-default">暫時還沒有留言</span><span class="text-sm leading-sm text-text-subtle">下方輸入框可對整篇文章留言，或選取文字後按「留言」，即針對該段文字留言。</span></span></div><div class="flex flex-col gap-2.5 p-2.5"></div><div class="flex-grow"></div><div class="ui-anchorless-comment-input-container sticky bottom-0 w-full border-0 border-solid bg-background-subtler rounded-t-md border-t-1 border-border-default p-4"><div class="flex w-full flex-col gap-2"><div class="ui-comment-input-container relative"><textarea class="invisible absolute w-full resize-none border border-solid p-3 text-normal leading-normal" rows="1" readonly=""></textarea><textarea class="!placeholder:text-text-subtler p-3 text-normal leading-normal text-text-default w-full resize-none rounded-[3px] border border-solid border-border-default bg-background-subtler focus-within:border-border-subtle focus-within:bg-background-default focus:outline-none hocus:border-border-subtle cursor-not-allowed" readonly="" placeholder="您沒有留言的權限。請聯繫筆記擁有者以請求權限。" rows="1" maxlength="1000"></textarea><div class="text-complete-container fixed [&amp;&gt;.dropdown-menu]:!absolute" style="top: 0px;"></div></div><div class="flex-row justify-end gap-1.5 hidden"><button class="rounded py-2 text-normal font-normal leading-normal flex bg-transparent text-text-default border border-solid border-border-default hocus:bg-element-bg-hover hocus:border-element-border-hover hocus:text-text-emphasize focus:shadow-[0_0_0_2px_#77777733] disabled:bg-element-bg-disabled disabled:border-element-border-disabled disabled:text-element-text-disabled disabled:hocus:bg-element-bg-disabled disabled:hocus:border-element-border-disabled disabled:hocus:text-element-text-disabled disabled:border disabled:border-solid disabled:hocus:border disabled:hocus:border-solid px-3.5">放棄</button><button class="rounded text-normal font-normal leading-normal flex bg-background-primary-default text-white border-none hover:bg-background-primary-hover focus:bg-background-primary-focus focus:shadow-[0_0_0_2px_#453AFF33] disabled:bg-background-primary-disabled disabled:opacity-[0.65] px-[15px] py-[9px]" disabled="">送出</button></div></div></div></div><span class="ui-right-panel-resize-handle relative cursor-ew-resize select-none pl-[5px] border-0 border-r-2 border-l-1 border-solid border-r-border-default border-l-transparent hocus:border-r-[3px] hocus:border-l-0 hocus:border-r-border-subtler"></span></div></div></div><div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true" style=""><div id="doc-body"><h2 class="part" data-startline="1" data-endline="1" id="Final-Scoreboard" data-id="Final-Scoreboard"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Final-Scoreboard" title="Final-Scoreboard" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3" data-size="16">Final Scoreboard</span></h2><p class="part" data-startline="3" data-endline="3" data-position="21" data-size="0" data-noselect="true"><div class="alert alert-danger flex !flex-row !gap-2 text-[#C85C54]">
    <div class="justify-start"><i class="fa fa-fw fa-exclamation-circle"></i></div>
    <div class="flex flex-col">
      <span class="font-semibold">無法顯示圖片</span>
      <span>可能原因</span>
      <ul class="!mb-0"><li>圖片原上傳筆記，您沒有權限閱讀</li><li>圖片原上傳筆記已被刪除</li></ul>
      <a href="https://hackmd.io/@docs/how_to_upload_image_tw?utm_source=note&amp;utm_medium=error-msg" target="_blank">詳細了解 →</a>
    </div>
  </div></p><h2 class="part" data-startline="5" data-endline="5" id="Statistics" data-id="Statistics"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Statistics" title="Statistics" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="71" data-size="10">Statistics</span></h2><h3 class="part" data-startline="7" data-endline="7" id="Problems-AttemptedSolved" data-id="Problems-AttemptedSolved"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problems-AttemptedSolved" title="Problems-AttemptedSolved" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="87" data-size="25">Problems Attempted/Solved</span></h3><p class="part" data-startline="8" data-endline="8" data-position="113" data-size="0" data-noselect="true"><div class="alert alert-danger flex !flex-row !gap-2 text-[#C85C54]">
    <div class="justify-start"><i class="fa fa-fw fa-exclamation-circle"></i></div>
    <div class="flex flex-col">
      <span class="font-semibold">無法顯示圖片</span>
      <span>可能原因</span>
      <ul class="!mb-0"><li>圖片原上傳筆記，您沒有權限閱讀</li><li>圖片原上傳筆記已被刪除</li></ul>
      <a href="https://hackmd.io/@docs/how_to_upload_image_tw?utm_source=note&amp;utm_medium=error-msg" target="_blank">詳細了解 →</a>
    </div>
  </div></p><h3 class="part" data-startline="10" data-endline="10" id="Submissions-Over-Time" data-id="Submissions-Over-Time"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Submissions-Over-Time" title="Submissions-Over-Time" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="164" data-size="21">Submissions Over Time</span></h3><p class="part" data-startline="12" data-endline="12" data-position="187" data-size="0" data-noselect="true"><div class="alert alert-danger flex !flex-row !gap-2 text-[#C85C54]">
    <div class="justify-start"><i class="fa fa-fw fa-exclamation-circle"></i></div>
    <div class="flex flex-col">
      <span class="font-semibold">無法顯示圖片</span>
      <span>可能原因</span>
      <ul class="!mb-0"><li>圖片原上傳筆記，您沒有權限閱讀</li><li>圖片原上傳筆記已被刪除</li></ul>
      <a href="https://hackmd.io/@docs/how_to_upload_image_tw?utm_source=note&amp;utm_medium=error-msg" target="_blank">詳細了解 →</a>
    </div>
  </div></p><h2 class="part" data-startline="14" data-endline="14" id="Summary" data-id="Summary"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Summary" title="Summary" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="237" data-size="7">Summary</span></h2><p class="part" data-startline="16" data-endline="16" data-position="247" data-size="0"><span data-position="247" data-size="14">基本上這場比賽被切成三個階段</span></p><ul class="part" data-startline="17" data-endline="21" data-position="262" data-size="0">
<li class="" data-startline="17" data-endline="17" data-position="264" data-size="0"><span data-position="264" data-size="9">前期題 CEFHI</span></li>
<li class="" data-startline="18" data-endline="18" data-position="276" data-size="0"><span data-position="276" data-size="8">中期題 BGML</span></li>
<li class="" data-startline="19" data-endline="19" data-position="287" data-size="0"><span data-position="287" data-size="7">後期題 AJK</span></li>
<li class="" data-startline="20" data-endline="21" data-position="297" data-size="0"><span data-position="297" data-size="14">不可做題 D（不是一個階段）</span></li>
</ul><p class="part" data-startline="22" data-endline="23" data-position="313" data-size="0"><span data-position="313" data-size="42">感覺大多數人前期題開完之後就被卡住了，可能是中期題過於 unusual 的關係 QQ</span><br>
<span data-position="357" data-size="37">最正常的 G 似乎沒有人想到，但這題還算漂亮，推薦大家多想一陣子再看題解。</span></p><p class="part" data-startline="25" data-endline="25" data-position="396" data-size="0"><span data-position="396" data-size="17">以下每題後面會附上我們預期的難度。</span></p><h2 class="part" data-startline="27" data-endline="27" id="Problem-A-Area-in-Convex-mid-hard" data-id="Problem-A-Area-in-Convex-mid-hard"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-A-Area-in-Convex-mid-hard" title="Problem-A-Area-in-Convex-mid-hard" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="418" data-size="36">Problem A. Area in Convex [mid-hard]</span></h2><p class="part" data-startline="29" data-endline="29" data-position="456" data-size="0"><span data-position="456" data-size="17">讓我們先考慮對於小凸包的一個頂點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="476" data-size="9"> 可以移動的範圍。</span></p><p class="part" data-startline="31" data-endline="32" data-position="487" data-size="0"><span data-position="487" data-size="13">可以發現，對於每一條向量 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mover><mjx-over style="padding-bottom: 0.105em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2192" style="width: 1.276em;"><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-base></mjx-mover></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow><msub><mi>q</mi><mi>i</mi></msub><mi>p</mi></mrow><mo>→</mo></mover></math></mjx-assistive-mml></mjx-container></span><span data-position="523" data-size="16"> 都會造成大凸包的每一條邊往內 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mover><mjx-over style="padding-bottom: 0.105em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2192" style="width: 1.276em;"><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-base></mjx-mover></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow><msub><mi>q</mi><mi>i</mi></msub><mi>p</mi></mrow><mo>→</mo></mover></math></mjx-assistive-mml></mjx-container></span><span data-position="562" data-size="5"> 的限制，</span><br>
<span data-position="568" data-size="3">其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="576" data-size="12"> 是小凸包上的另一個點。</span></p><p class="part" data-startline="34" data-endline="34" data-position="590" data-size="0"><span data-position="590" data-size="22">因此，對大凸包的每一條邊找到往內平移最多的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mover><mjx-over style="padding-bottom: 0.105em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2192" style="width: 1.276em;"><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-base></mjx-mover></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow><msub><mi>q</mi><mi>i</mi></msub><mi>p</mi></mrow><mo>→</mo></mover></math></mjx-assistive-mml></mjx-container></span><span data-position="635" data-size="14">，會是首要關鍵，而這除了用 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="656" data-size="15"> 找到之外，也可以用雙指針類似</span><a href="https://oi-wiki.org/geometry/rotating-calipers/" target="_blank" rel="noopener"><span data-position="672" data-size="4">旋轉卡尺</span></a><span data-position="726" data-size="5">的做法在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="6" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="739" data-size="10"> 找到。實務上因為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="7" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>,</mo><mi>M</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="764" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="8" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="772" data-size="18"> 的做法常數不要過大也可以很快找完。</span></p><p class="part" data-startline="36" data-endline="36" data-position="792" data-size="0"><span data-position="792" data-size="55">找到大凸包的每一條邊平移的結果後，因為題目保證最終解存在兩個方向可以移動小凸包 =&gt; 該頂點可移動的範圍面積 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="9" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&gt;</mo><mn>0</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="851" data-size="9">，因此可以直接套用</span><a href="https://oi-wiki.org/geometry/half-plane/" target="_blank" rel="noopener"><span data-position="861" data-size="4">半平面交</span></a><span data-position="908" data-size="22">來把範圍找出來，會是一個凸多邊形。這步可以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="949" data-size="4"> 搞定。</span></p><p class="part" data-startline="38" data-endline="39" data-position="955" data-size="0"><span data-position="955" data-size="9">接著，我們希望用 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="967" data-size="21"> 的移動範圍來還原出整個小凸包的覆蓋範圍，</span><br>
<span data-position="989" data-size="10">注意到這其實是那些 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="12" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mover><mjx-over style="padding-bottom: 0.105em;"><mjx-mo class="mjx-n"><mjx-stretchy-h class="mjx-c2192" style="width: 1.276em;"><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end></mjx-stretchy-h></mjx-mo></mjx-over><mjx-base><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.014em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-base></mjx-mover></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover><mrow><mi>p</mi><msub><mi>q</mi><mi>i</mi></msub></mrow><mo>→</mo></mover></math></mjx-assistive-mml></mjx-container></span><span data-position="1022" data-size="9"> 蒐集起來之後跟 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="1034" data-size="7"> 的移動範圍求</span><a href="https://zh.wikipedia.org/zh-tw/%E9%96%94%E5%8F%AF%E5%A4%AB%E6%96%AF%E5%9F%BA%E5%92%8C" target="_blank" rel="noopener"><span data-position="1042" data-size="6">閔可夫斯基和</span></a><span data-position="1136" data-size="7">，因此可以在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="1162" data-size="4"> 搞定。</span></p><p class="part" data-startline="41" data-endline="41" data-position="1168" data-size="0"><span data-position="1168" data-size="59">但其實，半平面交和閔可夫斯基和的複雜度瓶頸都是排序，由於這題凸包的好性質，其實實作上可以完全避免排序，因此整題可以在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="15" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="1235" data-size="5"> 內完成。</span></p><p class="part" data-startline="43" data-endline="43" data-position="1242" data-size="0"><span data-position="1242" data-size="26">比較值得注意的點是精度問題，原題保證了小凸包面積的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="16" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>5</mn></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="1274" data-size="107"> 倍不會小於最大座標絕對值的平方其實是在保證「太大的絕對誤差」不會造成精度上的困擾，但隨意實作還是很容易讓精度噴飛（ex. 過早將數字轉成浮點數後進行運算，如果之後還有乘法就可能放大誤差），在這種情況下，可以使用 </span><code data-position="1382" data-size="10">__float128</code><span data-position="1393" data-size="7"> 來維持精度。</span></p><p class="part" data-startline="45" data-endline="45" data-position="1402" data-size="0"><span data-position="1402" data-size="8">存在一份只用到 </span><code data-position="1411" data-size="6">double</code><span data-position="1418" data-size="10"> 型態浮點數的解答。</span></p><h2 class="part" data-startline="47" data-endline="47" id="Problem-B-Bogosort-mid" data-id="Problem-B-Bogosort-mid"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-B-Bogosort-mid" title="Problem-B-Bogosort-mid" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="1433" data-size="25">Problem B. Bogosort [mid]</span></h2><h3 class="part" data-startline="49" data-endline="49" id="How-to-start-with" data-id="How-to-start-with"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#How-to-start-with" title="How-to-start-with" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="1464" data-size="18">How to start with?</span></h3><p class="part" data-startline="50" data-endline="50" data-position="1483" data-size="0"><span data-position="1483" data-size="44">Let's think about a good scenario as ending </span><span class="smartypants" data-position="1527" data-size="2">–</span><span data-position="1529" data-size="11">- the last </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="17" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="1543" data-size="177"> consecutive numbers are repeatedly shuffled until all of them are correcly placed and once this is achieved, the array is sorted. If this is the case, we should have the other </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="18" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>95</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="1724" data-size="32"> numbers correctly placed first.</span></p><h3 class="part" data-startline="52" data-endline="52" id="Heuristic-Proposal" data-id="Heuristic-Proposal"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Heuristic-Proposal" title="Heuristic-Proposal" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="1762" data-size="18">Heuristic Proposal</span></h3><p class="part" data-startline="53" data-endline="53" data-position="1781" data-size="0"><span data-position="1781" data-size="62">So, we may wonder if there exists any way such that after the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="19" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="1846" data-size="5">-th (</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="20" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≤</mo><mn>95</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="1862" data-size="13">) iteration, </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="21" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c2200"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>j</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><mi mathvariant="normal">∀</mi><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="1913" data-size="41">. (And after that, just randomly shuffle </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="22" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c2E"></mjx-c></mjx-mn><mjx-mn class="mjx-n"><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false">[</mo><mn>96.</mn><mn>.100</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="1966" data-size="7"> until </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="23" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="1976" data-size="40"> gets sorted.) Good news: it's possible!</span></p><p class="part" data-startline="55" data-endline="55" data-position="2018" data-size="0"><span data-position="2018" data-size="40">Based on the induction hypothesis (i.e. </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="24" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="2113" data-size="12"> before the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="25" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="2128" data-size="30">-th iteration begins), in the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="26" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="2161" data-size="44">-th iteration, let's do the following thing:</span></p><pre class="part" data-startline="57" data-endline="70" data-position="2207"><code>while True:
    Shuffle a[i..N] // try our luck to hit a_i = i
    
    /* Verify if you are that lucky */
    record = []
    Do C times: // C can be a constant
        Shuffle a[(i + 1)..N]
        append "the i-th smallest element of |a_z - z|" to record
    if all the elements in record are zeros:
        break // treat it as a sign of a_i = i
    else:
        continue // try again to make a_i = i next time
</code></pre><h3 class="part" data-startline="72" data-endline="72" id="Verification-Validity" data-id="Verification-Validity"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Verification-Validity" title="Verification-Validity" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2636" data-size="21">Verification Validity</span></h3><p class="part" data-startline="74" data-endline="74" data-position="2659" data-size="0"><span data-position="2659" data-size="52">Let's see how the verification process can be valid.</span></p><h4 class="part" data-startline="76" data-endline="76" id="False-Negative" data-id="False-Negative"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Negative" title="False-Negative" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2718" data-size="14">False Negative</span></h4><p class="part" data-startline="78" data-endline="78" data-position="2734" data-size="0"><span data-position="2734" data-size="27">This does not happen. When </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="27" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="2770" data-size="6">, the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="28" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="2779" data-size="10"> smallest </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="29" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><msub><mi>a</mi><mi>z</mi></msub><mo>−</mo><mi>z</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="2800" data-size="79"> must all be zeros because of the induction hypothesis. Hence, when we perform </span><code data-position="2880" data-size="5">? 1 i</code><span data-position="2886" data-size="25">, it always returns 0 if </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="30" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="2920" data-size="1">.</span></p><h4 class="part" data-startline="80" data-endline="80" id="False-Positive" data-id="False-Positive"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Positive" title="False-Positive" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="2928" data-size="14">False Positive</span></h4><p class="part" data-startline="82" data-endline="82" data-position="2944" data-size="0"><span data-position="2944" data-size="5">This </span><strong data-position="2949" data-size="0"><span data-position="2951" data-size="10">may happen</span></strong><span data-position="2963" data-size="92"> but with a low probability. A false positive occurs when both of the conditions below hold.</span></p><ul class="part" data-startline="84" data-endline="87" data-position="3057" data-size="0">
<li class="" data-startline="84" data-endline="84" data-position="3059" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="31" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2260"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>≠</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span></li>
<li class="" data-startline="85" data-endline="87" data-position="3074" data-size="0"><span data-position="3074" data-size="3">no </span><a href="https://en.wikipedia.org/wiki/Derangement" target="_blank" rel="noopener"><span data-position="3078" data-size="11">derangement</span></a><span data-position="3133" data-size="23"> happens in any of the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="32" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3159" data-size="9"> shuffles</span>
<ul data-position="3173" data-size="0">
<li class="" data-startline="86" data-endline="87" data-position="3175" data-size="0"><span data-position="3175" data-size="54">Please note that this is an inaccurate statement since</span><br><br><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="33" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2260"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>a</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi><mo fence="false" stretchy="false">}</mo><mo>≠</mo><mo fence="false" stretchy="false">{</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi><mo>+</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container></span><br><br><span data-position="3315" data-size="5">when </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="34" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2260"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>≠</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3332" data-size="31">. Anyway, you know what I mean.</span></li>
</ul>
</li>
</ul><p class="part" data-startline="88" data-endline="88" data-position="3365" data-size="0"><span data-position="3365" data-size="59">The probability of the latter condition is upper-bounded by</span></p><p class="part" data-startline="90" data-endline="92" data-position="3427" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="35" style="font-size: 123.5%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-msup><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mstyle space="3"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c21"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c21"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-script style="vertical-align: 1.177em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2248"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mrow><mjx-mo class="mjx-s3"><mjx-c class="mjx-c28 TEX-S3"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mstyle space="3"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D452 TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle><mjx-mo class="mjx-s3"><mjx-c class="mjx-c29 TEX-S3"></mjx-c></mjx-mo></mjx-mrow><mjx-script style="vertical-align: 1.177em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2248"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c36"></mjx-c><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.413em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mn>1</mn><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>!</mo><mi>n</mi></mrow><mrow><mi>n</mi><mo>!</mo></mrow></mfrac></mstyle><mo data-mjx-texclass="CLOSE">)</mo></mrow><mi>C</mi></msup><mo>≈</mo><msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mn>1</mn><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mi>e</mi></mfrac></mstyle><mo data-mjx-texclass="CLOSE">)</mo></mrow><mi>C</mi></msup><mo>≈</mo><msup><mn>0.632</mn><mi>C</mi></msup></math></mjx-assistive-mml></mjx-container></span></p><p class="part" data-startline="94" data-endline="94" data-position="3520" data-size="0"><span data-position="3520" data-size="8">, where </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="36" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mi>N</mi><mo>−</mo><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3539" data-size="5"> and </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="37" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c21"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>!</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3548" data-size="13"> denotes the </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="38" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3564" data-size="51">-th derangement number. So, for sufficiently large </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="39" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="3618" data-size="73">, the probability of the occurence of a false positive can be negligible.</span></p><h3 class="part" data-startline="96" data-endline="96" id="Implementation-and-Experiments" data-id="Implementation-and-Experiments"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Implementation-and-Experiments" title="Implementation-and-Experiments" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="3697" data-size="30">Implementation and Experiments</span></h3><p class="part" data-startline="98" data-endline="98" data-position="3729" data-size="0"><span data-position="3729" data-size="10">By taking </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="40" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo><mn>30</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="3747" data-size="21"> and an optimization </span><span class="smartypants" data-position="3768" data-size="2">–</span><span data-position="3770" data-size="97">- conditionally "break" the "Do C times" loop if the number appended into the record is non-zero </span><span class="smartypants" data-position="3867" data-size="2">–</span><span data-position="3869" data-size="36">- this heuristic method can succeed </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="41" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>995</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="3910" data-size="14"> times out of </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="42" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1000</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="3930" data-size="98"> experiments. To make it even more robust, some trivial optimizations (e.g. dynamically determine </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="43" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4031" data-size="14"> depending on </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="44" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4048" data-size="186"> and the number of remaining queries, or rollback to a previous iteration if a suspicious false positive is detected with high confidence) can still be applied. But since there are only </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="45" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>20</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="4238" data-size="32"> testcases, given the fact that </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="46" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-texatom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mi class="mjx-n"><mjx-c class="mjx-c25"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>0.995</mn><mrow data-mjx-texclass="ORD"><mn>20</mn></mrow></msup><mo>&gt;</mo><mn>90</mn><mi mathvariant="normal">%</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4289" data-size="87">, I would rather just submit my code again instaead of implementing more optimizations.</span></p><h2 class="part" data-startline="100" data-endline="100" id="Problem-C-Communication-Problem-easy" data-id="Problem-C-Communication-Problem-easy"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-C-Communication-Problem-easy" title="Problem-C-Communication-Problem-easy" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="4381" data-size="39">Problem C. Communication Problem [easy]</span></h2><p class="part" data-startline="102" data-endline="102" data-position="4422" data-size="0"><span data-position="4422" data-size="48">As a contestant, you may first try on different </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="47" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4473" data-size="25"> to discover the pattern </span><span class="smartypants" data-position="4498" data-size="2">–</span><span data-position="4500" data-size="81">- if you tried to do so, you were on the expected way to start with this problem.</span></p><p class="part" data-startline="104" data-endline="104" data-position="4583" data-size="0"><span data-position="4583" data-size="45">As you may notice, except for the case where </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="48" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4635" data-size="35">, the answer is only determined by </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="49" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4673" data-size="26">. More specifically, when </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="50" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>&lt;</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4706" data-size="2">, </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="51" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mstyle space="4"><mjx-mfrac><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c21"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c21"></mjx-c></mjx-mo></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mstyle></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>n</mi><msub><mi>s</mi><mi>k</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mrow><mi>k</mi><mo>!</mo><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></mrow></mfrac></mstyle></math></mjx-assistive-mml></mjx-container></span><span data-position="4742" data-size="1">.</span></p><p class="part" data-startline="106" data-endline="106" data-position="4745" data-size="0"><span data-position="4745" data-size="141">This hypothesis seems arbitrary but you could find it reasonable after thinking twice. Let's consider the contribution when you add a number </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="52" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4889" data-size="14"> into the set </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="53" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4906" data-size="20">. The more divisors </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="54" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4929" data-size="45"> have, the larger the numerator is; however, </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="55" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="4977" data-size="24"> grows much faster than </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="56" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="5007" data-size="8">, where </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="57" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="5021" data-size="32"> denotes the number of divisors </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="58" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="5056" data-size="148"> have. In this case, adding a smaller number but keeping the nominator positive makes sense. More specifically, you may observe that for some small </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="59" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="5207" data-size="1">,</span></p><p class="part" data-startline="108" data-endline="114" data-position="5210" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="60" style="font-size: 123.5%; position: relative;"><mjx-math display="true" class="MJX-TEX" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-mrow><mjx-mo class="mjx-n"><mjx-stretchy-v class="mjx-c7B" style="height: 3.4em; vertical-align: -1.45em;"><mjx-beg><mjx-c></mjx-c></mjx-beg><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-mid><mjx-c></mjx-c></mjx-mid><mjx-ext><mjx-c></mjx-c></mjx-ext><mjx-end><mjx-c></mjx-c></mjx-end><mjx-mark></mjx-mark></mjx-stretchy-v></mjx-mo><mjx-mtable style="min-width: 17.863em;"><mjx-table><mjx-itable><mjx-mtr><mjx-mtd style="text-align: left; padding-bottom: 0.1em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-top: 0.1em; padding-bottom: 0.1em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c222A"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c2200"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr><mjx-mtr><mjx-mtd style="text-align: left; padding-top: 0.1em;"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo><mjx-tstrut></mjx-tstrut></mjx-mtd></mjx-mtr></mjx-itable></mjx-table></mjx-mtable><mjx-mo class="mjx-n" style="vertical-align: 0.25em;"></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><mtable columnalign="left left" columnspacing="1em" rowspacing=".2em"><mtr><mtd><msub><mi>B</mi><mn>1</mn></msub><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo></mtd></mtr><mtr><mtd><msub><mi>B</mi><mi>k</mi></msub><mo>=</mo><msub><mi>B</mi><mrow data-mjx-texclass="ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∪</mo><mo fence="false" stretchy="false">{</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mo>,</mo><mi mathvariant="normal">∀</mi><mi>k</mi><mo>=</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo>−</mo><mn>1</mn></mtd></mtr><mtr><mtd><msub><mi>B</mi><mi>n</mi></msub><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo fence="false" stretchy="false">}</mo></mtd></mtr></mtable><mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"></mo></mrow></math></mjx-assistive-mml></mjx-container></span></p><p class="part" data-startline="116" data-endline="116" data-position="5349" data-size="0"><span data-position="5349" data-size="45">and this is the correct construction for all </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="61" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="5397" data-size="9"> as well.</span></p><p class="part" data-startline="118" data-endline="118" data-position="5408" data-size="0"><span data-position="5408" data-size="249">The explanation above may serve as an intuitive understanding instead of a rigorous proof. With this problem, we would like to introduce that finding the pattern before coming up with a claim is often useful and effective in competitive programming.</span></p><p class="part" data-startline="120" data-endline="120" data-position="5659" data-size="0"><span data-position="5659" data-size="119">Since all the teams have solved this problem, let's omit the rigorous proof part and leave it as an exercise for you :)</span></p><h2 class="part" data-startline="122" data-endline="122" id="Problem-D-Decision-Problem-hard" data-id="Problem-D-Decision-Problem-hard"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-D-Decision-Problem-hard" title="Problem-D-Decision-Problem-hard" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5783" data-size="34">Problem D. Decision Problem [hard]</span></h2><div class="alert alert-info part" data-startline="124" data-endline="125" data-position="5819" data-size="46">
<p data-position="5827" data-size="0"><span data-position="5827" data-size="34">問題 D: 詢問樹上兩點間路徑有多少種數字出現偶數次。限定在線算法。</span></p>
</div><h3 class="part" data-startline="128" data-endline="128" id="D1-拆解問題" data-id="D1-拆解問題"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D1-%E6%8B%86%E8%A7%A3%E5%95%8F%E9%A1%8C" title="D1-拆解問題" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="5871" data-size="8">D.1 拆解問題</span></h3><p class="part" data-startline="129" data-endline="129" data-position="5880" data-size="0"><span data-position="5880" data-size="32">對於樹上路徑詢問的題目，通常可以先考慮序列（樹是一條鏈）的情形︰</span></p><div class="alert alert-info part" data-startline="131" data-endline="132" data-position="5914" data-size="86">
<p data-position="5922" data-size="0"><span data-position="5922" data-size="15">問題 D.1: 給定一個序列 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="62" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c22EF"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="5960" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="63" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="5964" data-size="7"> 次詢問區間 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="64" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="5983" data-size="13"> 有多少種數字出現偶數次。</span></p>
</div><p class="part" data-startline="135" data-endline="135" data-position="6002" data-size="0"><span data-position="6002" data-size="11">這個問題可以輕易的使用</span><a href="https://oi-wiki.org/misc/mo-algo/" target="_blank" rel="noopener"><span data-position="6014" data-size="4">莫隊算法</span></a><span data-position="6054" data-size="8">解決。注意到雖然</span><a href="https://tw.news.yahoo.com/0%E7%82%BA%E4%BD%95%E6%98%AF-%E5%81%B6%E6%95%B8-%E5%B0%8F%E5%AD%B8%E7%94%9F-%E6%8B%9B%E5%91%8A%E8%A8%B4%E4%BD%A0-023035573.html" target="_blank" rel="noopener"><span data-position="6063" data-size="4">零是偶數</span></a><span data-position="6223" data-size="70">，但依據原題（D）題意，詢問範圍內沒出現過的數字不列入計算。因此問題 D.1 本質上是以下兩個子問題（D.1.1, D.1.3）的答案相減︰</span></p><div class="alert alert-info part" data-startline="137" data-endline="138" data-position="6295" data-size="86">
<p data-position="6303" data-size="0"><span data-position="6303" data-size="17">問題 D.1.1: 給定一個序列 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="65" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c22EF"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="6343" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="66" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6347" data-size="7"> 次詢問區間 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="67" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6366" data-size="11"> 有多少種不同的數字。</span></p>
</div><p class="part" data-startline="141" data-endline="141" data-position="6383" data-size="0"><span data-position="6383" data-size="25">雖然也可以使用莫隊算法處理，但如果題目要求在線呢？</span></p><div class="alert alert-warning part" data-startline="143" data-endline="144" data-position="6410" data-size="76">
<p data-position="6421" data-size="0"><span data-position="6421" data-size="20">練習 D.1.2（無關原題官解）: 在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="68" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6459" data-size="23"> 的時間內解決問題 D.1.1。限定在線算法。</span></p>
</div><div class="alert alert-info part" data-startline="147" data-endline="148" data-position="6488" data-size="88">
<p data-position="6496" data-size="0"><span data-position="6496" data-size="17">問題 D.1.3: 給定一個序列 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="69" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c22EF"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="6536" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="70" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6540" data-size="7"> 次詢問區間 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="71" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6559" data-size="13"> 有多少種數字出現奇數次。</span></p>
</div><p class="part" data-startline="151" data-endline="151" data-position="6578" data-size="0"><span data-position="6578" data-size="59">與 D.1.1 不同的是，D.1.3 使用莫隊算法時不需要記錄每個數字實際出現的次數，只要記錄出現次數的奇偶性就好了。</span></p><p class="part" data-startline="153" data-endline="153" data-position="6639" data-size="0"><span data-position="6639" data-size="25">對於莫隊算法能解決的問題，可以嘗試分塊。選擇常數 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="72" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6667" data-size="5">，令集合 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="73" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6675" data-size="3"> 為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="74" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>∼</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6688" data-size="5"> 中所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="75" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6696" data-size="10"> 的倍數。對於所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="76" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∈</mo><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6715" data-size="10">，紀錄每一種數字在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="77" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mi>p</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6733" data-size="21"> 中出現次數的奇偶性。由於整個序列至多有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="78" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6757" data-size="13"> 種數字，紀錄奇偶性需要 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="79" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-texatom space="3" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>⋅</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>k</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6799" data-size="5"> 的空間。</span></p><p class="part" data-startline="155" data-endline="155" data-position="6806" data-size="0"><span data-position="6806" data-size="8">此外，對於所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="80" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>∈</mo><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="6830" data-size="6">，預先計算 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="81" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6848" data-size="16"> 有多少種數字出現奇數次，需要 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="82" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><msup><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><msup><mi>k</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6889" data-size="5"> 的空間。</span></p><p class="part" data-startline="157" data-endline="157" data-position="6896" data-size="0"><span data-position="6896" data-size="22">至此預處理的步驟結束，時間和空間複雜度都是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="83" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>k</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="6930" data-size="1">。</span></p><p class="part" data-startline="159" data-endline="159" data-position="6933" data-size="0"><span data-position="6933" data-size="6">詢問時，令 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="84" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mspace style="width: 0.667em;"></mjx-mspace><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mrow space="2"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mspace style="width: 0.667em;"></mjx-mspace><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c64"></mjx-c></mjx-mi><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mstyle><mjx-mspace style="width: 0.167em;"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>=</mo><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi>k</mi><mo>,</mo><msub><mi>l</mi><mi>i</mi></msub><mo>−</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mi>i</mi></msub><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>k</mi><mo stretchy="false">)</mo><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>=</mo><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><mi>k</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mi>i</mi></msub><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>k</mi><mo stretchy="false">)</mo><mo data-mjx-texclass="CLOSE">)</mo></mrow></math></mjx-assistive-mml></mjx-container></span><span data-position="7045" data-size="5">，注意到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="85" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>∈</mo><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7080" data-size="1">。</span></p><ul class="part" data-startline="160" data-endline="163" data-position="7082" data-size="0">
<li class="" data-startline="160" data-endline="160" data-position="7084" data-size="0"><span data-position="7084" data-size="7">直接查表得知 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="86" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7117" data-size="5"> 的答案。</span></li>
<li class="" data-startline="161" data-endline="161" data-position="7125" data-size="0"><span data-position="7125" data-size="6">一個數字在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="87" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7157" data-size="12"> 出現次數的奇偶性等於 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="88" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7186" data-size="10"> 的奇偶性 XOR </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="89" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7213" data-size="6"> 的奇偶性。</span></li>
<li class="" data-startline="162" data-endline="163" data-position="7222" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="90" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">|</mo><msub><mi>l</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>l</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo data-mjx-texclass="CLOSE">|</mo></mrow><mo>≤</mo><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7259" data-size="3"> 且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="91" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mrow><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msubsup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">|</mo><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>r</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo data-mjx-texclass="CLOSE">|</mo></mrow><mo>≤</mo><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7299" data-size="1">。</span></li>
</ul><p class="part" data-startline="164" data-endline="164" data-position="7302" data-size="0"><span data-position="7302" data-size="19">仿造莫隊算法移動區間的維護方式可以在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="92" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7327" data-size="11"> 時間內回答一次詢問。</span></p><p class="part" data-startline="166" data-endline="166" data-position="7340" data-size="0"><span data-position="7340" data-size="2">取 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="93" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7359" data-size="11">，即可得到時間複雜度 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="94" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7390" data-size="34"> 的演算法。結合 D.1.2 後問題 D.1 的在線版本也被解決了。</span></p><h4 class="part" data-startline="168" data-endline="168" id="觀察與結論" data-id="觀察與結論"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#%E8%A7%80%E5%AF%9F%E8%88%87%E7%B5%90%E8%AB%96" title="觀察與結論" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="7431" data-size="5">觀察與結論</span></h4><ul class="part" data-startline="169" data-endline="172" data-position="7437" data-size="0">
<li class="" data-startline="169" data-endline="169" data-position="7439" data-size="0"><span data-position="7439" data-size="13">如果原題可以離線，似乎也能</span><a href="https://www.cnblogs.com/zwfymqz/p/9223425.html" target="_blank" rel="noopener"><span data-position="7453" data-size="9">在樹上使用莫隊算法</span></a><span data-position="7511" data-size="1">？</span></li>
<li class="" data-startline="170" data-endline="170" data-position="7515" data-size="0"><span data-position="7515" data-size="20">可以用類似 D.1.3 的方法解決原題。</span></li>
<li class="" data-startline="171" data-endline="172" data-position="7538" data-size="0"><span data-position="7538" data-size="21">如 D.1.3，D 官解的空間複雜度也是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="95" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7573" data-size="46">。雖然這題並未特別限制記憶體用量，但這裡暗示了一個在空間上更有效率的作法︰如果儲存的資訊是 </span><code data-position="7620" data-size="4">bool</code><span data-position="7625" data-size="4"> 而非 </span><code data-position="7630" data-size="3">int</code><span data-position="7634" data-size="4"> ，用 </span><code data-position="7639" data-size="11">std::bitset</code><span data-position="7651" data-size="7"> 實作只需要 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="96" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c33"></mjx-c><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mn>1</mn><mn>32</mn></mfrac></math></mjx-assistive-mml></mjx-container></span><span data-position="7672" data-size="7"> 的儲存空間。</span></li>
</ul><h3 class="part" data-startline="173" data-endline="173" id="D2-樹上分塊" data-id="D2-樹上分塊"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D2-%E6%A8%B9%E4%B8%8A%E5%88%86%E5%A1%8A" title="D2-樹上分塊" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="7685" data-size="8">D.2 樹上分塊</span></h3><div class="alert alert-info part" data-startline="175" data-endline="176" data-position="7695" data-size="47">
<p data-position="7703" data-size="0"><span data-position="7703" data-size="13">問題 D: 詢問樹上兩點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="97" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>,</mo><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7722" data-size="16"> 間路徑有多少種數字出現偶數次。</span></p>
</div><p class="part" data-startline="179" data-endline="179" data-position="7744" data-size="0"><span data-position="7744" data-size="15">從暴力的作法開始發想︰分別從 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="98" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>,</mo><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7765" data-size="8"> 開始往上爬到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="99" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7784" data-size="22">，統計沿途數字的出現次數。這樣一次詢問需要 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="100" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7812" data-size="7"> 的計算時間。</span></p><p class="part" data-startline="181" data-endline="181" data-position="7821" data-size="0"><span data-position="7821" data-size="18">如果能像 D.1.3 一樣找到集合 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="101" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7842" data-size="4"> 使得 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="102" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>,</mo><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7852" data-size="8"> 往上爬不超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="103" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msqrt><mi>n</mi></msqrt></math></mjx-assistive-mml></mjx-container></span><span data-position="7870" data-size="7"> 次就會落在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="104" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7880" data-size="10"> 內，說不定就能在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="105" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="7903" data-size="10"> 的時間內回答詢問。</span></p><div class="alert alert-info part" data-startline="184" data-endline="185" data-position="7916" data-size="85">
<p data-position="7924" data-size="0"><span data-position="7924" data-size="13">問題 D.2: 給定一棵 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="106" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7940" data-size="16"> 個白點連成的有根樹和一個常數 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="107" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7959" data-size="25">，將盡可能少的點塗黑，使得每個白點往根節點走至多 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="108" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="7987" data-size="10"> 條邊後能碰到黑點。</span></p>
</div><p class="part" data-startline="188" data-endline="188" data-position="8003" data-size="0"><span data-position="8003" data-size="16">用 greedy 解決 D.2︰</span></p><ol class="part" data-startline="190" data-endline="193" data-position="8021" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="190" data-endline="191" data-position="8024" data-size="0"><span data-position="8024" data-size="11">按照後序考慮所有節點。</span>
<ul data-position="8040" data-size="0">
<li class="" data-startline="191" data-endline="191" data-position="8042" data-size="0"><span data-position="8042" data-size="10">令當下考慮的節點為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="109" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8055" data-size="4"> 。若 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="110" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8062" data-size="10"> 的子樹內存在白點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="111" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8075" data-size="4"> 滿足 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="112" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8082" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="113" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8088" data-size="12"> 的路徑上都是白點，且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="114" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>,</mo><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8106" data-size="8"> 的距離恰好是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="115" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8117" data-size="3">，將 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="116" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8123" data-size="4"> 塗黑。</span></li>
</ul>
</li>
<li class="" data-startline="192" data-endline="193" data-position="8131" data-size="0"><span data-position="8131" data-size="7">將根節點塗黑。</span></li>
</ol><p class="part" data-startline="194" data-endline="194" data-position="8140" data-size="0"><span data-position="8140" data-size="15">此時黑點的集合便是我們需要的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="117" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8158" data-size="38">，每個黑點代表樹上的一個「塊」，白點和往根節點走第一次碰到的黑點分在同一塊。</span></p><p class="part" data-startline="196" data-endline="196" data-position="8198" data-size="0"><span data-position="8198" data-size="19">除了根節點外，每塗黑一個點至少會決定 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="118" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8220" data-size="11"> 個白點的歸屬，因此 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="119" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8234" data-size="8"> 的大小不超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="120" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>n</mi><mi>k</mi></mfrac><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="8259" data-size="29">。這種分塊方式不能保證塊的大小，只確保每一塊的直徑不超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="121" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8292" data-size="1">。</span></p><h3 class="part" data-startline="198" data-endline="198" id="D3-解決問題-D-…-" data-id="D3-解決問題-D-…-"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D3-%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C-D-%E2%80%A6-" title="D3-解決問題-D-…-" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="8299" data-size="11">D.3 解決問題 D </span><span class="smartypants" data-position="8310" data-size="3">…</span><span data-position="8313" data-size="2"> ?</span></h3><div class="alert alert-info part" data-startline="200" data-endline="201" data-position="8317" data-size="92">
<p data-position="8325" data-size="0"><span data-position="8325" data-size="18">問題 D: 給定一棵樹和點上的數字 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="122" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c22EF"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8366" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="123" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8370" data-size="9"> 次詢問樹上兩點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="124" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8389" data-size="16"> 間路徑有多少種數字出現偶數次。</span></p>
</div><p class="part" data-startline="204" data-endline="204" data-position="8411" data-size="0"><span data-position="8411" data-size="2">令 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="125" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="8416" data-size="6"> 為根節點。</span></p><p class="part" data-startline="206" data-endline="206" data-position="8424" data-size="0"><span data-position="8424" data-size="22">D.3.1: 仿照 D.1.3 ，對於所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="126" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∈</mo><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8455" data-size="10">，紀錄每一種數字在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="127" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="8468" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="128" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8474" data-size="13"> 路徑上出現次數的奇偶性。</span></p><p class="part" data-startline="208" data-endline="208" data-position="8489" data-size="0"><span data-position="8489" data-size="12">D.3.2: 對於所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="129" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>∈</mo><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8517" data-size="6">，預先計算 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="130" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="8535" data-size="9"> 有多少種數字出現</span><strong data-position="8544" data-size="0"><span data-position="8546" data-size="1">偶</span></strong><span data-position="8549" data-size="3">數次（</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="131" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="8555" data-size="13"> 不算在內）。作法是枚舉 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="132" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8573" data-size="3">，令 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="133" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8581" data-size="21"> 為新的根節點，跑一次 DFS 算出所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="134" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8607" data-size="14"> 對應的答案。總花費時間是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="135" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>S</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="8626" data-size="9"> 次 DFS = </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="136" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="8649" data-size="1">。</span></p><p class="part" data-startline="210" data-endline="210" data-position="8652" data-size="0"><span data-position="8652" data-size="30">D.3.3: 上面的 DFS 還有額外需要紀錄的東西︰對於 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="137" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8697" data-size="1">，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="138" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8703" data-size="5"> 是否在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="139" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8713" data-size="4"> 走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="140" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="8720" data-size="10"> 的路上第一次出現。</span></p><p class="part" data-startline="212" data-endline="212" data-position="8732" data-size="0"><span data-position="8732" data-size="2">令 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="141" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="8758" data-size="3"> 為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="142" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8771" data-size="18"> 對應的黑點，可以分成以下三種情況︰</span></p><h4 class="part" data-startline="214" data-endline="214" id="Case-1-uprime_i--vprime_i" data-id="Case-1-uprime_i--vprime_i"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-1-uprime_i--vprime_i" title="Case-1-uprime_i--vprime_i" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="8796" data-size="8">Case 1: </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="143" style="font-size: 118.8%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msubsup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>=</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span></h4><p class="part" data-startline="215" data-endline="215" data-position="8830" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="144" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8840" data-size="14"> 屬於同塊，直接暴力算答案。</span></p><h4 class="part" data-startline="217" data-endline="217" id="Case-2-uprime_i-vprime_i-有一個是另一個的祖先" data-id="Case-2-uprime_i-vprime_i-有一個是另一個的祖先"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-2-uprime_i-vprime_i-%E6%9C%89%E4%B8%80%E5%80%8B%E6%98%AF%E5%8F%A6%E4%B8%80%E5%80%8B%E7%9A%84%E7%A5%96%E5%85%88" title="Case-2-uprime_i-vprime_i-有一個是另一個的祖先" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="8861" data-size="8">Case 2: </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="145" style="font-size: 118.8%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="8893" data-size="11"> 有一個是另一個的祖先</span></h4><p class="part" data-startline="218" data-endline="218" data-position="8905" data-size="0"><span data-position="8905" data-size="3">此時 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="146" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="8942" data-size="14"> 可能不會按順序形成一條鏈。</span></p><p class="part" data-startline="220" data-endline="220" data-position="8958" data-size="0"><span data-position="8958" data-size="8">不失一般性假設 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="147" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="8978" data-size="3"> 是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="148" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="8993" data-size="7"> 的祖先，將 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="149" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9012" data-size="3"> 往 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="150" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9027" data-size="35"> 方向退一個黑點。實作上可以預處理每個黑點往上走碰到的下個黑點，改由 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="151" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9074" data-size="9"> 往上跳找出新的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="152" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9095" data-size="16"> ，花費時間取決於黑點數量 = </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="153" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9124" data-size="1">。</span></p><p class="part" data-startline="222" data-endline="222" data-position="9127" data-size="0"><span data-position="9127" data-size="3">此時 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="154" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9164" data-size="10"> 按順序形成一條鏈，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="155" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9186" data-size="5"> 不再是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="156" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9196" data-size="5"> 的祖先。</span></p><h4 class="part" data-startline="224" data-endline="224" id="Case-3-剩下的情況" data-id="Case-3-剩下的情況"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-3-%E5%89%A9%E4%B8%8B%E7%9A%84%E6%83%85%E6%B3%81" title="Case-3-剩下的情況" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="9208" data-size="13">Case 3: 剩下的情況</span></h4><p class="part" data-startline="225" data-endline="225" data-position="9222" data-size="0"><span data-position="9222" data-size="3">此時 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="157" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9259" data-size="13"> 按順序形成一條鏈，而且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="158" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9317" data-size="1">。</span></p><p class="part" data-startline="227" data-endline="227" data-position="9320" data-size="0"><span data-position="9320" data-size="21">對於 Case 2, 3，分塊的性質保證 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="159" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9346" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="160" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9361" data-size="4"> 加上 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="161" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9377" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="162" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9385" data-size="7"> 的路徑長是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="163" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9405" data-size="21">，因此我們可以暴力考慮這兩段路徑上的數字。</span></p><p class="part" data-startline="229" data-endline="229" data-position="9428" data-size="0"><span data-position="9428" data-size="13">首先從 D.3.2 取得 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="164" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9453" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="165" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9468" data-size="5"> 的答案。</span></p><p class="part" data-startline="231" data-endline="231" data-position="9475" data-size="0"><span data-position="9475" data-size="3">對於 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="166" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9490" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="167" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9498" data-size="5"> 的位置 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="168" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="9506" data-size="10">， D.3.3 在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="169" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msubsup space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9534" data-size="11"> 的紀錄可以用來回答 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="170" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9550" data-size="7"> 是否未曾在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="171" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9569" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="172" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9584" data-size="4"> 出現。</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="173" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9600" data-size="3"> 到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="174" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="9608" data-size="4"> 同理。</span></p><p class="part" data-startline="233" data-endline="233" data-position="9614" data-size="0"><span data-position="9614" data-size="11">將 D.3.1 對於 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="175" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9637" data-size="3"> 和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="176" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9652" data-size="21"> 的紀錄進行 XOR 運算可以得到數字在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="177" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9697" data-size="17"> 路徑上出現次數的奇偶性。記得將 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="178" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9743" data-size="5"> （不是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="179" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9763" data-size="7">）的影響加回。</span></p><p class="part" data-startline="235" data-endline="235" data-position="9772" data-size="0"><span data-position="9772" data-size="15">仔細算一下奇偶性，將新數字和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="180" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msubsup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.254em; margin-left: 0px;"><mjx-mi class="mjx-var" size="s"><mjx-c class="mjx-c2032"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>u</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup><mo>,</mo><msubsup><mi>v</mi><mi>i</mi><mi data-mjx-alternate="1">′</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="9811" data-size="33"> 路徑上本來就有的數字分開處理，這題就被我們解決了！時間複雜度是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="181" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9862" data-size="8">，空間複雜度是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="182" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="9884" data-size="1">。</span></p><h3 class="part" data-startline="237" data-endline="237" id="D4-快取優化" data-id="D4-快取優化"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D4-%E5%BF%AB%E5%8F%96%E5%84%AA%E5%8C%96" title="D4-快取優化" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="9891" data-size="8">D.4 快取優化</span></h3><p class="part" data-startline="239" data-endline="239" data-position="9901" data-size="0"><span data-position="9901" data-size="60">不過事情其實還沒結束，當你終於寫完上面的做法，上傳後很可能會拿到一個 TLE。時間複雜度終究只表示了漸進行為，並未考慮 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="183" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D45E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.281em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><msqrt><mi>n</mi></msqrt></math></mjx-assistive-mml></mjx-container></span><span data-position="9976" data-size="10"> 前面的常數。須知 </span><s data-position="9986" data-size="0"><span data-position="9988" data-size="39">NCPC 賽中 O(n^3 / w) 在 n = 1e4 時可以 1 秒內跑完</span></s><span data-position="10029" data-size="83"> 在快取的影響下，循序存取會比隨機存取來的有效率，這也是樹和序列的一大差異︰序列上的分塊（或莫隊），移動區間時存取的索引總是連續的，而樹上移動時碰到的點編號毫無規律。</span></p><p class="part" data-startline="241" data-endline="241" data-position="10114" data-size="0"><span data-position="10114" data-size="20">我們希望找到一種對點重新編號的方式使得 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="184" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub><mo>,</mo><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="10144" data-size="23"> 往上移動的過程中碰到的點編號盡可能連續︰利用</span><a href="https://oi-wiki.org/graph/hld/" target="_blank" rel="noopener"><span data-position="10168" data-size="4">樹鏈剖分</span></a><span data-position="10205" data-size="32">，對於同一條鏈上的點分配連續的編號，可以保證往上移動時至多經過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="185" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="10248" data-size="7"> 個連續區間。</span></p><p class="part" data-startline="243" data-endline="243" data-position="10257" data-size="0"><span data-position="10257" data-size="27">D.4 的優化在出題者電腦上對時間的影響約為 3 倍。</span></p><h2 class="part" data-startline="245" data-endline="245" id="Problem-E-Er-Wei-Shu-Dian-water" data-id="Problem-E-Er-Wei-Shu-Dian-water"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-E-Er-Wei-Shu-Dian-water" title="Problem-E-Er-Wei-Shu-Dian-water" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="10289" data-size="34">Problem E. Er Wei Shu Dian [water]</span></h2><p class="part" data-startline="247" data-endline="247" data-position="10325" data-size="0"><span data-position="10325" data-size="10">注意到這題問了總和。</span></p><p class="part" data-startline="249" data-endline="249" data-position="10337" data-size="0"><span data-position="10337" data-size="6">如果座標的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="186" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10346" data-size="3"> 和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="187" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10352" data-size="21"> 全部相異，那任一對點對都會貢獻進總和裡（</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="188" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10376" data-size="9"> 比較小的會算到）</span></p><p class="part" data-startline="251" data-endline="251" data-position="10387" data-size="0"><span data-position="10387" data-size="6">因此考慮從 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="189" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.288em; margin-left: -0.045em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.138em;"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>C</mi><mn>2</mn><mi>N</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="10400" data-size="5"> 開始扣，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="190" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10408" data-size="7"> 座標一樣的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="191" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10418" data-size="8"> 個點會多算到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="192" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.296em; margin-left: -0.045em;"><mjx-mi class="mjx-i" size="s" style="margin-left: 0.138em;"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.18em;"></mjx-spacer><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>C</mi><mn>2</mn><mi>k</mi></msubsup></math></mjx-assistive-mml></mjx-container></span><span data-position="10433" data-size="3"> 次、</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="193" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10439" data-size="25"> 座標一樣的也是，最後要把重合的點多扣的量加回來。</span></p><p class="part" data-startline="253" data-endline="253" data-position="10466" data-size="0"><span data-position="10466" data-size="25">整體複雜度就是計算座標相同點的時間，這部分我們用 </span><code data-position="10492" data-size="8">std::map</code><span data-position="10501" data-size="4"> 實作 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="194" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="10517" data-size="40"> 的解答可以在賽中用 0.31s 跑完，但好像有人還是被卡常了，我們很抱歉 QQ</span></p><h2 class="part" data-startline="255" data-endline="255" id="Problem-F-Fake-Solution-easy" data-id="Problem-F-Fake-Solution-easy"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-F-Fake-Solution-easy" title="Problem-F-Fake-Solution-easy" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="10562" data-size="31">Problem F. Fake Solution [easy]</span></h2><p class="part" data-startline="256" data-endline="259" data-position="10594" data-size="0"><span data-position="10594" data-size="7">對於一個操作 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="195" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="10610" data-size="6">，如果原本 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="196" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="10621" data-size="3"> 第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="197" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10627" data-size="26"> 個 bit 是 1，那麼不會有任何影響；否則會把 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="198" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10656" data-size="4"> 直到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="199" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10663" data-size="22"> 以上的第一個 1 以前的 0 都變成 1。</span><br>
<span data-position="10686" data-size="14">因此我們可以知道答案一定是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="200" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>p</mi></msup><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="10709" data-size="4"> 其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="201" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="10716" data-size="5"> 是所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="202" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="10726" data-size="10"> 當中最高位最大值。</span><br>
<span data-position="10737" data-size="92">接著要計算所需要的步數，我們先計算出原本的 bitwise-or 跟最好的答案差了哪些 bit，然後我們的目標就是用一些操作讓這些 bit 被蓋住，我們一次操作可以蓋掉的目標就是一個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="203" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="10834" data-size="91"> 的二進位表示的一段連續 0 所對應的區間。選擇一些區間使得所有給定點都被至少一個區間覆蓋是一個經典貪心或動態規劃問題，其中一個作法是從可以蓋住最左邊的點的區間當中每次選右界最大的。</span><br>
<span data-position="10926" data-size="24">小心不要寫成 1e6 * 30^2 應該就會過了。</span></p><h2 class="part" data-startline="261" data-endline="261" id="Problem-G-Grouping-Problem-mid" data-id="Problem-G-Grouping-Problem-mid"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-G-Grouping-Problem-mid" title="Problem-G-Grouping-Problem-mid" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="10956" data-size="33">Problem G. Grouping Problem [mid]</span></h2><p class="part" data-startline="263" data-endline="263" data-position="10991" data-size="0"><span data-position="10991" data-size="50">首先注意到要分組的話，肯定是座標排序後連續的人會在同一組，所以所有組別會對應到若干個互斥的連續區間。</span></p><p class="part" data-startline="265" data-endline="265" data-position="11043" data-size="0"><span data-position="11043" data-size="3">如果 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="204" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>≤</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11055" data-size="26">，可以注意到不把任何人分在同一組肯定是最好的，所以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="205" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11084" data-size="36"> 變得無用了，這其實退化了成一個很單純的最小割問題（留給讀者自行練習）。</span></p><p class="part" data-startline="267" data-endline="267" data-position="11122" data-size="0"><span data-position="11122" data-size="5">以下假設 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="206" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>&gt;</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11132" data-size="1">。</span></p><p class="part" data-startline="269" data-endline="269" data-position="11135" data-size="0"><span data-position="11135" data-size="31">考慮最小割，如果值域很小的話，對每個「座標」都開一個點「座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="207" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11169" data-size="15">」，也對每個人都開一個點「人 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="208" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11187" data-size="14">」，表示這個人所在的位置是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="209" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11204" data-size="6">。考慮分在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="210" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11213" data-size="11"> 的點代表不選，分在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="211" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11227" data-size="10"> 的點代表要選，其中</span></p><ul class="part" data-startline="270" data-endline="272" data-position="11238" data-size="0">
<li class="" data-startline="270" data-endline="270" data-position="11240" data-size="0"><span data-position="11240" data-size="4">「座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="212" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11247" data-size="17">」選的意義是「存在一個組別的區間 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="213" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="11272" data-size="4">」滿足 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="214" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>r</mi></math></mjx-assistive-mml></mjx-container></span></li>
<li class="" data-startline="271" data-endline="272" data-position="11296" data-size="0"><span data-position="11296" data-size="16">「人」選的意義是這個人沒有被請走</span></li>
</ul><p class="part" data-startline="273" data-endline="273" data-position="11314" data-size="0"><span data-position="11314" data-size="8">那麼有以下限制：</span></p><ol class="part" data-startline="274" data-endline="284" data-position="11323" data-size="0" data-original-title="" title="" style="padding-left: 2em;">
<li class="" data-startline="274" data-endline="275" data-position="11326" data-size="0"><span data-position="11326" data-size="6">選了在座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="485" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11335" data-size="13"> 的人，imply 座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="486" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11351" data-size="3"> 要選</span>
<ul data-position="11359" data-size="0">
<li class="" data-startline="275" data-endline="275" data-position="11361" data-size="0"><span data-position="11361" data-size="7">也就是 座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="487" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11371" data-size="6"> -&gt; 人 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="488" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11380" data-size="9">，cost 無限大</span></li>
</ul>
</li>
<li class="" data-startline="276" data-endline="277" data-position="11393" data-size="0"><span data-position="11393" data-size="11">不選一個人，cost </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="489" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span>
<ul data-position="11414" data-size="0">
<li class="" data-startline="277" data-endline="277" data-position="11416" data-size="0"><span data-position="11416" data-size="6">也就是 人 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="490" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11425" data-size="4"> -&gt; </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="491" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11432" data-size="6">，cost </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="492" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span></li>
</ul>
</li>
<li class="" data-startline="278" data-endline="279" data-position="11447" data-size="0"><span data-position="11447" data-size="16">選了一個座標，就等價可能貢獻了 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="493" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11466" data-size="16">（但連續選座標的區間會多算一個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="494" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11485" data-size="7">，下一步解決）</span>
<ul data-position="11497" data-size="0">
<li class="" data-startline="279" data-endline="279" data-position="11499" data-size="0"><span data-position="11499" data-size="4">也就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="495" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11506" data-size="7"> -&gt; 座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="496" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11516" data-size="6">，cost </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="497" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span></li>
</ul>
</li>
<li class="" data-startline="280" data-endline="281" data-position="11529" data-size="0"><span data-position="11529" data-size="5">選了座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="498" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11537" data-size="5">，卻不選 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="499" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="11547" data-size="14"> =&gt; 出現了一個區間的開頭</span>
<ul data-position="11566" data-size="0">
<li class="" data-startline="281" data-endline="281" data-position="11568" data-size="0"><span data-position="11568" data-size="7">也就是 座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="500" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="11580" data-size="7"> -&gt; 座標 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="501" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-size="6" data-position="11590">，cost </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="502" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>−</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-size="6" data-position="11601">（抵銷一個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="503" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-size="4" data-position="11610">，增加 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="504" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11617" data-size="6">），注意到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="505" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>&gt;</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11628" data-size="12"> 所以這是正的 cost</span></li>
</ul>
</li>
<li class="" data-startline="282" data-endline="284" data-position="11644" data-size="0"><span data-position="11644" data-size="9">人與人之間的朋友邊</span>
<ul data-position="11658" data-size="0">
<li class="" data-startline="283" data-endline="284" data-position="11660" data-size="0"><span data-position="11660" data-size="4">也就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="506" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="11669" data-size="5"> &lt;-&gt; </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="507" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="11679" data-size="6">，cost </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="508" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="11690" data-size="5"> 的雙向邊</span></li>
</ul>
</li>
</ol><p class="part" data-startline="285" data-endline="286" data-position="11697" data-size="0"><span data-position="11697" data-size="7">直接跑上圖的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="239" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>−</mo><mi>T</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11709" data-size="11"> 最小割，就會是答案。</span><br>
<span data-position="11721" data-size="47">注意到以上模型可能會生出「區間邊界沒有人」的區間，但這樣答案肯定只會更差，所以不用在意這件事。</span></p><p class="part" data-startline="288" data-endline="288" data-position="11770" data-size="0"><span data-position="11770" data-size="37">那值域很大要怎麼做？其實可以把人與人之間的座標壓成一個點，cost 就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="240" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="11810" data-size="45"> 乘上長度，因為這段區間不可能有些座標選了有些座標不選，否則答案只會更差，因此總共就只有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="241" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>+</mo><mi>N</mi><mo>+</mo><mn>2</mn><mi>N</mi><mo>−</mo><mn>1</mn><mo>=</mo><mn>3</mn><mi>N</mi><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="11880" data-size="9"> 個點，邊量也是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="242" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="11897" data-size="13">，總共的時間複雜度若使用 </span><a href="https://zh.wikipedia.org/zh-tw/%E8%BF%AA%E5%B0%BC%E8%8C%A8%E7%AE%97%E6%B3%95" target="_blank" rel="noopener"><span data-position="11911" data-size="5">Dinic</span></a><span data-position="11995" data-size="7"> 演算法即為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="243" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.363em; margin-left: 0.054em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D440 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12015" data-size="1">。</span></p><p class="part" data-startline="290" data-endline="290" data-position="12018" data-size="0"><span data-position="12018" data-size="84">一個容易踩到的錯誤是不把人跟座標分開建點，這樣會導致被蓋住的人被強迫選進來，但實際上可能會因為朋友邊的影響讓這個人被請走比較好，以下是一個手構發生這件事的測資，供參考：</span></p><pre class="part" data-startline="291" data-endline="296" data-position="12103"><code>4 1 3 1
1 2 3 100
9 1 9 1
2 4 5
</code></pre><h2 class="part" data-startline="298" data-endline="298" id="Problem-H-Harmony-Coloring-easy-mid" data-id="Problem-H-Harmony-Coloring-easy-mid"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-H-Harmony-Coloring-easy-mid" title="Problem-H-Harmony-Coloring-easy-mid" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="12147" data-size="38">Problem H. Harmony Coloring [easy-mid]</span></h2><p class="part" data-startline="299" data-endline="301" data-position="12186" data-size="0" data-noselect="true"><div class="alert alert-danger flex !flex-row !gap-2 text-[#C85C54]">
    <div class="justify-start"><i class="fa fa-fw fa-exclamation-circle"></i></div>
    <div class="flex flex-col">
      <span class="font-semibold">無法顯示圖片</span>
      <span>可能原因</span>
      <ul class="!mb-0"><li>圖片原上傳筆記，您沒有權限閱讀</li><li>圖片原上傳筆記已被刪除</li></ul>
      <a href="https://hackmd.io/@docs/how_to_upload_image_tw?utm_source=note&amp;utm_medium=error-msg" target="_blank">詳細了解 →</a>
    </div>
  </div><br>
<span data-position="12232" data-size="4">先固定 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="244" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12239" data-size="16"> 塗紅色，最後再把答案乘以 2。</span><br>
<span data-position="12256" data-size="10">分為兩個 case：</span></p><ol class="part" data-startline="302" data-endline="306" data-position="12267" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="302" data-endline="304" data-position="12270" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="245" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12273" data-size="65"> 一樣塗紅色。考慮藍色的點怎麼選，在拔掉 H 和 T 之後，整張圖只剩下一些鍊，因此藍色點只能選擇這些鍊的其中一個鍊上的一個區間。</span><br>
<span data-position="12339" data-size="42">假設選了 stem chain 則只能是一個前綴，而且剩下的紅色一定會連通，數量有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="246" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12384" data-size="3"> 個。</span><br>
<span data-position="12388" data-size="23">假設選了 stripe chain，則數量是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="247" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo><mjx-mfrac space="2"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP">∑</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>l</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>l</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12441" data-size="6"> 個。注意 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="248" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>=</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="12454" data-size="31"> 的 case，因為拔掉那些藍色點之後剩下的紅色點必須要連通。</span></li>
<li class="" data-startline="305" data-endline="306" data-position="12495" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="249" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12498" data-size="79"> 塗藍色。這樣 stem chain 就一定整個都要是紅色。對於每個 stripe chain，我們都可以任意獨立的決定一個紅藍的分割點，因此這部份的答案是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="250" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c220F TEX-S1"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo data-mjx-texclass="OP">∏</mo><mo stretchy="false">(</mo><msub><mi>l</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12594" data-size="1">。</span></li>
</ol><h2 class="part" data-startline="307" data-endline="307" id="Problem-I-IMO-Problem-easy" data-id="Problem-I-IMO-Problem-easy"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-I-IMO-Problem-easy" title="Problem-I-IMO-Problem-easy" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="12600" data-size="29">Problem I. IMO Problem [easy]</span></h2><blockquote class="part" data-startline="308" data-endline="308">
<p data-position="12632" data-size="0"><span data-position="12632" data-size="58">據說 2022 TOI 二模出了一題 IMO 的複製題，我們怎麼可以出一樣的題目呢？所以這是那題的 checker。</span></p>
</blockquote><p class="part" data-startline="310" data-endline="311" data-position="12692" data-size="0"><span data-position="12692" data-size="15">把斜向左下和斜向右下分別訂成 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="251" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12710" data-size="6"> 軸正向和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="252" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12719" data-size="26"> 軸正向，可以發現每次走到新一排的兩個圓就等於是從 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="253" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12752" data-size="4"> 走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="254" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12765" data-size="3"> 或 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="255" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12777" data-size="65">。因此定好座標之後，就等於是要選一堆紅色圓使得他們的座標兩維都不嚴格遞增，等價於一個 LIS 問題之類的，可能也可以用資料結構做。</span><br>
<span data-position="12843" data-size="2">第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="256" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="12848" data-size="6"> 橫排的第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="257" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="12859" data-size="18"> 個紅色圓對應到上述的座標應該就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="258" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>−</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="12890" data-size="5"> 之類的。</span></p><h2 class="part" data-startline="313" data-endline="313" id="Problem-J-Japanese-Monsters-mid-hard" data-id="Problem-J-Japanese-Monsters-mid-hard"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-J-Japanese-Monsters-mid-hard" title="Problem-J-Japanese-Monsters-mid-hard" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="12900" data-size="39">Problem J. Japanese Monsters [mid-hard]</span></h2><p class="part" data-startline="315" data-endline="315" data-position="12941" data-size="0"><strong data-position="12941" data-size="0"><span data-position="12943" data-size="4">原本的解</span></strong></p><p class="part" data-startline="317" data-endline="317" data-position="12951" data-size="0"><span data-position="12951" data-size="4">定義們：</span></p><ul class="part" data-startline="318" data-endline="322" data-position="12956" data-size="0">
<li class="" data-startline="318" data-endline="318" data-position="12958" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="259" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>=</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span></li>
<li class="" data-startline="319" data-endline="319" data-position="12970" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="260" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.032em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>i</mi></msub><mo>=</mo><msub><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>…</mo><mi>N</mi></mrow></msub></math></mjx-assistive-mml></mjx-container></span></li>
<li class="" data-startline="320" data-endline="320" data-position="13002" data-size="0"><span data-position="13002" data-size="6">若一個字串 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="261" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13011" data-size="4"> 形如 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="262" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13019" data-size="4">，其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="263" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13026" data-size="14"> 是某個非空字串，則我們稱 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="264" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13043" data-size="6"> 是一個串串</span></li>
<li class="" data-startline="321" data-endline="322" data-position="13052" data-size="0"><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="265" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="13070" data-size="4"> 代表 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="266" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13077" data-size="3"> 跟 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="267" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13083" data-size="8"> 的最長共同前綴</span></li>
</ul><p class="part" data-startline="323" data-endline="323" data-position="13093" data-size="0"><span data-position="13093" data-size="9">題目要我們對每個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="268" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13105" data-size="10"> 算有多少種方式把 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="269" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13129" data-size="4"> 拆成 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="270" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi><mi>B</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13139" data-size="8"> 的形式，其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="271" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13150" data-size="2">, </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="272" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13155" data-size="8"> 都是非空字串。</span></p><p class="part" data-startline="325" data-endline="327" data-position="13165" data-size="0"><span data-position="13165" data-size="8">考慮枚舉結尾的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="273" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13176" data-size="8">，我們知道只要 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="274" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>3</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13199" data-size="3">，且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="275" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><msub><mtext>Suf</mtext><mi>i</mi></msub><mo>,</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13235" data-size="3">，且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="276" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13252" data-size="4"> 的前 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="277" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="13262" data-size="16"> 個字元剛好是一個串串的話，那 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="278" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13281" data-size="5"> 就會對 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="279" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13289" data-size="6"> 貢獻 1。</span><br>
<span data-position="13296" data-size="9">想到串串就會想到 </span><a href="https://cp-algorithms.com/string/main_lorentz.html" target="_blank" rel="noopener"><span data-position="13306" data-size="12">Main-Lorentz</span></a><span data-position="13371" data-size="9">，他可以對於每個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="280" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>k</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13384" data-size="7"> 找到有哪些 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="281" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13394" data-size="5"> 對應的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="282" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.032em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>…</mo><mi>i</mi><mo>+</mo><mn>2</mn><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13419" data-size="30"> 是一個串串，並且這些開頭們會形成一些區間，而總區間數量是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="283" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="13462" data-size="1">。</span><br>
<span data-position="13464" data-size="45">注意到對於 Main-Lorentz 找出的區間，我們可以稍作調整，使得這些開頭也會符合 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="284" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>3</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>≤</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13524" data-size="1">。</span></p><p class="part" data-startline="329" data-endline="330" data-position="13527" data-size="0"><span data-position="13527" data-size="17">接下來我們剩下要做的事情就是確保 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="285" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext></math></mjx-assistive-mml></mjx-container></span><span data-position="13556" data-size="14"> 是對的，這部分可以想像一棵</span><a href="https://cp-algorithms.com/string/suffix-tree-ukkonen.html" target="_blank" rel="noopener"><span data-position="13571" data-size="3">後綴樹</span></a><span data-position="13634" data-size="1">。</span><br>
<span data-position="13636" data-size="9">我們知道後綴樹上 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="286" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13648" data-size="7"> 的後代節點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="287" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13658" data-size="4"> 們跟 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="288" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13665" data-size="6"> 所代表的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="289" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>u</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13685" data-size="3"> 的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="290" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext></math></mjx-assistive-mml></mjx-container></span><span data-position="13700" data-size="4"> 都是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="291" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>u</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13718" data-size="6">，所以若是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="292" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>Suf</mtext><mi>v</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="13738" data-size="4"> 的前 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="293" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><msub><mtext>Suf</mtext><mi>u</mi></msub><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="13759" data-size="15"> 字元又剛好是個合法串串，那 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="294" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13777" data-size="5"> 就會對 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="295" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13785" data-size="6"> 貢獻 1。</span></p><p class="part" data-startline="332" data-endline="332" data-position="13793" data-size="0"><span data-position="13793" data-size="13">綜合起來我們可以例如帶著 </span><a href="https://cp-algorithms.com/data_structures/fenwick.html" target="_blank" rel="noopener"><span data-position="13807" data-size="12">Fenwick Tree</span></a><span data-position="13876" data-size="18"> 去 dfs 後綴樹 (實作上可以用</span><a href="https://cp-algorithms.com/string/suffix-array.html" target="_blank" rel="noopener"><span data-position="13895" data-size="4">後綴陣列</span></a><span data-position="13952" data-size="12">取代後綴樹)，每次走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="296" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="13967" data-size="27"> 的時候就把 Main-Lorentz 給我們的那些 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="297" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-msub><mjx-mtext class="mjx-n"><mjx-c class="mjx-c53"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c66"></mjx-c></mjx-mtext><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><msub><mtext>Suf</mtext><mi>u</mi></msub><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14011" data-size="23"> 對應的合法串串區間拿出來區間加值一下，離開 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="298" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14037" data-size="18"> 的時候再撤銷，然後也順便檢查一下 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="299" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14058" data-size="16"> 目前被貢獻多少了，這個值就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="300" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D462 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>u</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="14079" data-size="1">。</span></p><p class="part" data-startline="334" data-endline="334" data-position="14082" data-size="0"><span data-position="14082" data-size="30">最花費時間的計算步驟是用 Main-Lorentz 給出的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="301" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14125" data-size="31"> 個區間，每個都拿去 BIT 作區間加值，因此總時間複雜度為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="302" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-msup space="2"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-script style="vertical-align: 0.421em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><msup><mi>log</mi><mn>2</mn></msup><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14171" data-size="1">。</span></p><p class="part" data-startline="336" data-endline="336" data-position="14174" data-size="0"><strong data-position="14174" data-size="0"><span data-position="14176" data-size="4">更好的解</span></strong></p><p class="part" data-startline="338" data-endline="338" data-position="14184" data-size="0"><span data-position="14184" data-size="33">出題的人看了 AYDD 的 submission 才發現其實可以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="303" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14230" data-size="3"> 😭</span></p><p class="part" data-startline="340" data-endline="341" data-position="14235" data-size="0"><span data-position="14235" data-size="10">作法一樣枚舉結尾的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="304" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14248" data-size="11">，我們一樣要找開頭是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="305" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14263" data-size="10"> 的後綴們，找到後 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="306" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14276" data-size="14"> 就會對對這之中實際開頭在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="307" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>−</mo><mn>3</mn><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mo stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14300" data-size="9"> 前的人貢獻 1。</span><br>
<span data-position="14310" data-size="9">明顯的這些開頭是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="308" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14323" data-size="50"> 的後綴們會在後綴陣列上形成一個連續區間，而若是我們能定位出這個區間，那剩下的就是一個二維數點問題。</span></p><p class="part" data-startline="343" data-endline="344" data-position="14375" data-size="0"><span data-position="14375" data-size="18">因此我們先來看該怎麼定位出這個區間。</span><br>
<span data-position="14394" data-size="19">一種做法是直接二分搜第一個開頭字典序 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="309" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14422" data-size="19"> 的後綴是誰，接著再二分搜一次找到是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="310" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14445" data-size="13"> 開頭的最後面的後綴是誰。</span></p><p class="part" data-startline="346" data-endline="346" data-position="14460" data-size="0"><span data-position="14460" data-size="8">要檢查某個後綴 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="311" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14471" data-size="5"> 是不是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="312" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14485" data-size="8">，我們可以先看 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="313" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14496" data-size="15"> 在後綴陣列上的位置是不是比 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="314" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14514" data-size="15"> 前面，若是的話他就一定不會 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="315" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14538" data-size="5">；接著看 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="316" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>U</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14561" data-size="5">，若不是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="317" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14569" data-size="11"> 的話，因為我們知道 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="318" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mo>≥</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14590" data-size="4">，所以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="319" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mstyle><mjx-mspace style="width: 0.278em;"></mjx-mspace></mjx-mstyle><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c27F9"></mjx-c></mjx-mo><mjx-mstyle><mjx-mspace style="width: 0.278em;"></mjx-mspace></mjx-mstyle><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><mo>&gt;</mo><mi>A</mi><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle><mo stretchy="false">⟹</mo><mstyle scriptlevel="0"><mspace width="0.278em"></mspace></mstyle><mi>U</mi><mo>&gt;</mo><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14617" data-size="7">；現在我們有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="320" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>U</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14644" data-size="12">，所以剩下只要看是不是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="321" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.176em; margin-left: -0.084em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>…</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mo stretchy="false">|</mo></mrow></msub><mo>≥</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14682" data-size="9">，等價的意思就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="322" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.176em; margin-left: -0.084em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>…</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mo stretchy="false">|</mo></mrow></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="14710" data-size="12"> 是不是在後綴陣列上比 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="323" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14725" data-size="6"> 還後面 (</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="324" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14734" data-size="3"> 是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="325" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14740" data-size="8"> 的後綴，所以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="326" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14751" data-size="8"> 的後綴也會是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="327" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14762" data-size="8"> 的後綴，所以 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="328" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14773" data-size="11"> 的後綴也都會出現在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="329" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14787" data-size="9"> 的後綴陣列裡)。</span></p><p class="part" data-startline="348" data-endline="348" data-position="14798" data-size="0"><span data-position="14798" data-size="3">確定 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="330" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14804" data-size="5"> 是不是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="331" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14813" data-size="13"> 的情況也類似，只要檢查 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="332" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14846" data-size="3"> 且 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="333" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.176em; margin-left: -0.186em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><msub><mi>V</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>…</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mo stretchy="false">|</mo></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14887" data-size="4"> 即可。</span></p><p class="part" data-startline="350" data-endline="350" data-position="14893" data-size="0"><span data-position="14893" data-size="34">所以最後剩下的問題就變成在一個序列(後綴陣列的逆元)上，有一些操作 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="334" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>L</mi><mo>,</mo><mi>R</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14938" data-size="10">，代表要把位置介在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="335" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D445 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>L</mi><mo>,</mo><mi>R</mi><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="14956" data-size="6"> 且值少於 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="336" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14965" data-size="8"> 的那些地方都 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="337" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="14977" data-size="12">，這可以例如對操作們按 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="338" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="14992" data-size="48"> 由小到大排序，每次就變成是一些區間加值的操作了，一樣可以用個 Fenwick Tree 搞定。</span></p><p class="part" data-startline="352" data-endline="352" data-position="15042" data-size="0"><span data-position="15042" data-size="41">計算量最大的部分在於二分搜跟 Fenwick Tree 操作，兩種的總複雜度都是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="339" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15096" data-size="14"> 的 (後綴陣列跟LCP都有</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="340" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15116" data-size="5">的演算法)</span></p><h2 class="part" data-startline="354" data-endline="354" id="Problem-K-Known-Problem-hard" data-id="Problem-K-Known-Problem-hard"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-K-Known-Problem-hard" title="Problem-K-Known-Problem-hard" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="15126" data-size="31">Problem K. Known Problem [hard]</span></h2><p class="part" data-startline="356" data-endline="356" data-position="15159" data-size="0"><span data-position="15159" data-size="14">考慮離線回答，對所有詢問的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="341" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15176" data-size="4"> 排序，</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="342" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15183" data-size="12"> 從小到大，每次加一個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="343" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15198" data-size="9"> 進來後更新所有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="344" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15210" data-size="5"> 的答案。</span></p><p class="part" data-startline="358" data-endline="358" data-position="15217" data-size="0"><span data-position="15217" data-size="7">我們可以建立 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="345" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-n"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15235" data-size="10"> 個資料結構，其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="346" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15248" data-size="7"> 是值域、第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="347" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15258" data-size="22"> 個資料結構會保持到所有「有用的」距離介在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="348" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15302" data-size="11"> 的數對。特別地，第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="349" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15316" data-size="13"> 個資料結構維護的區間是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="350" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15337" data-size="1">。</span></p><p class="part" data-startline="360" data-endline="360" data-position="15340" data-size="0"><span data-position="15340" data-size="4">對於第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="351" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15347" data-size="14"> 個資料結構，我們將值域每 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="352" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>i</mi></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="15366" data-size="11"> 個切成一塊，每個點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="353" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>r</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="15382" data-size="11"> 在被加進來時會進到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="354" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-msub size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msup size="s"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.289em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⌊</mo><mfrac><msub><mi>x</mi><mi>r</mi></msub><msup><mn>2</mn><mi>i</mi></msup></mfrac><mo fence="false" stretchy="false">⌋</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15424" data-size="14"> 這塊裡面，接著他就暴力跟 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="355" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-msub size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msup size="s"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.289em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⌊</mo><mfrac><msub><mi>x</mi><mi>r</mi></msub><msup><mn>2</mn><mi>i</mi></msup></mfrac><mo fence="false" stretchy="false">⌋</mo><mo>−</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15471" data-size="1">、</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="356" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-msub size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msup size="s"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.289em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⌊</mo><mfrac><msub><mi>x</mi><mi>r</mi></msub><msup><mn>2</mn><mi>i</mi></msup></mfrac><mo fence="false" stretchy="false">⌋</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15503" data-size="1">、</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="357" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c230A"></mjx-c></mjx-mo><mjx-mfrac><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-msub size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msup size="s"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.289em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c230B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⌊</mo><mfrac><msub><mi>x</mi><mi>r</mi></msub><msup><mn>2</mn><mi>i</mi></msup></mfrac><mo fence="false" stretchy="false">⌋</mo><mo>+</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15537" data-size="22"> 這三塊裡面的所有點建立出數對，假設建立出 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="358" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>l</mi></msub><mo>,</mo><msub><mi>x</mi><mi>r</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="15569" data-size="26"> 這個數對，那這兩個點就可以貢獻給所有未來詢問左界 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="359" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≤</mo><mi>l</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15603" data-size="5"> 的詢問。</span></p><p class="part" data-startline="362" data-endline="362" data-position="15610" data-size="0"><span data-position="15610" data-size="14">接著，當一塊加入點之後超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="360" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15627" data-size="41"> 個點，我們就可以移除這塊裡面 index 最小的點，如此一來整體的複雜度就會是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="361" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>C</mi><mi>f</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15681" data-size="4">，其中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="362" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15691" data-size="31"> 是貢獻一個數對的時間，這裡可以用一個 BIT 維護，所以是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="363" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>C</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15737" data-size="27">，而每個詢問就是一個 BIT 查詢，總時間複雜度就是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="364" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>C</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo>+</mo><mi>Q</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15792" data-size="1">。</span></p><p class="part" data-startline="364" data-endline="364" data-position="15795" data-size="0"><span data-position="15795" data-size="24">那為什麼這樣就可以維護好次近數對呢？首先對於第 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="365" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="15822" data-size="6"> 個資料結構</span></p><div class="alert alert-info part" data-startline="366" data-endline="367" data-position="15830" data-size="59">
<p data-position="15838" data-size="0"><span data-position="15838" data-size="9">當一塊裡面有超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="366" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></mjx-assistive-mml></mjx-container></span><span data-position="15850" data-size="26"> 個點後，肯定存在超過兩個 pair 的距離不超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="367" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container></span></p>
</div><p class="part" data-startline="370" data-endline="370" data-position="15891" data-size="0"><span data-position="15891" data-size="47">所以，可以想像被 pop 掉 index 最小如果在這塊是「有用的」話，那他製造出來這個介在 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="368" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msup space="2"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="15960" data-size="12"> 的距離肯定會被不超過 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="369" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="15981" data-size="34"> 的某個兩個數對在未來蓋住，因此他是沒有用的，pop 掉不影響解答。</span></p><p class="part" data-startline="372" data-endline="372" data-position="16017" data-size="0"><span data-position="16017" data-size="7">這招可以用來做</span><a href="https://codeforces.com/gym/104172/problem/I" target="_blank" rel="noopener"><span data-position="16025" data-size="6">區間最近點對</span></a><span data-position="16077" data-size="89">，但常數非常之大；而這題看起來存在原本 well-known 最近數對作法的延伸解（賽中過的隊伍好像都是這樣做），但出題者太信任 2017 這題的提出者所以以為這個做法不能做（Ｘ</span></p><h2 class="part" data-startline="374" data-endline="374" id="Problem-L-List-of-Order-easy" data-id="Problem-L-List-of-Order-easy"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-L-List-of-Order-easy" title="Problem-L-List-of-Order-easy" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="16171" data-size="31">Problem L. List of Order [easy]</span></h2><p class="part" data-startline="376" data-endline="376" data-position="16204" data-size="0"><span data-position="16204" data-size="26">這題是在致敬 2022 ICPC 桃園站的閱讀測驗。</span></p><p class="part" data-startline="378" data-endline="378" data-position="16232" data-size="0"><span data-position="16232" data-size="33">如果把 work 當成一個點，那可以建出一張 DAG，邊來自以下：</span></p><ol class="part" data-startline="379" data-endline="382" data-position="16266" data-size="0" style="padding-left: 2em;">
<li class="" data-startline="379" data-endline="379" data-position="16269" data-size="0"><span data-position="16269" data-size="12">每個 order 的順序</span></li>
<li class="" data-startline="380" data-endline="380" data-position="16285" data-size="0"><span data-position="16285" data-size="28">同一個 item 的 work 對 dealine 排序</span></li>
<li class="" data-startline="381" data-endline="382" data-position="16317" data-size="0"><span data-position="16317" data-size="15">每個 resource 的順序</span></li>
</ol><p class="part" data-startline="383" data-endline="383" data-position="16334" data-size="0"><span data-position="16334" data-size="65">接著，因為要移除某個 resource 的區間，所以這個區間在 resource 上左右的邊可以直接不建，並在空隙之間插入一條邊。</span></p><p class="part" data-startline="385" data-endline="385" data-position="16401" data-size="0"><span data-position="16401" data-size="9">如此一來，原題變成</span></p><div class="alert alert-info part" data-startline="386" data-endline="389" data-position="16411" data-size="119">
<p data-position="16419" data-size="0"><span data-position="16419" data-size="13">給定 DAG 上的兩個點 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="370" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>,</mo><mi>t</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16438" data-size="4">，保證 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="371" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16445" data-size="5"> 能走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="372" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16453" data-size="4">，接著 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="373" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16460" data-size="9"> 筆詢問獨立加入 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="374" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16477" data-size="3"> 和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="375" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16488" data-size="13"> 兩條邊後，是否會出現環。</span></p>
<p data-position="16503" data-size="0"><span data-position="16503" data-size="12">保證每次詢問時都有一個 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="376" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16523" data-size="3"> 的邊</span></p>
</div><p class="part" data-startline="392" data-endline="392" data-position="16532" data-size="0"><span data-position="16532" data-size="4">而因為 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="377" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16539" data-size="5"> 能走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="378" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16547" data-size="1">、</span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="379" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16551" data-size="5"> 能走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="380" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16559" data-size="9">，所以其實只要判 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="381" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16576" data-size="3"> 和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="382" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16587" data-size="16"> 有沒有環就好了，也就是預處理 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="383" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16606" data-size="7"> 能不能走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="384" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16616" data-size="3"> 和 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="385" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D466 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16622" data-size="7"> 能不能走到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="386" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16632" data-size="10">，這可以線性預處理。</span></p><p class="part" data-startline="394" data-endline="394" data-position="16644" data-size="0"><span data-position="16644" data-size="37">整體複雜度就是在建圖之後成線性，至於建圖就算用 map 亂建也不會爆常數。</span></p><p class="part" data-startline="396" data-endline="396" data-position="16684" data-size="0"><span data-position="16684" data-size="50">這題的難度全在文章，出題者也弄到快暴斃了，但大家絕對不能忽視閱讀通靈題敘的重要性，桃園站教育了我們。</span></p><h2 class="part" data-startline="398" data-endline="398" id="Problem-M-More-Japanese-Monsters-mid" data-id="Problem-M-More-Japanese-Monsters-mid"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-M-More-Japanese-Monsters-mid" title="Problem-M-More-Japanese-Monsters-mid" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="16739" data-size="39">Problem M. More Japanese Monsters [mid]</span></h2><p class="part" data-startline="400" data-endline="400" data-position="16780" data-size="0"><strong data-position="16780" data-size="0"><span data-position="16782" data-size="4">簡單的解</span></strong></p><p class="part" data-startline="402" data-endline="402" data-position="16790" data-size="0"><span data-position="16790" data-size="55">這題雖然範圍比 J 大，但輸出總和的方式大大降低了這題的難度，所以有人開掉 M 沒開出 J 是非常預料之中的。</span></p><p class="part" data-startline="404" data-endline="404" data-position="16847" data-size="0"><span data-position="16847" data-size="16">我們可以先將字串反過來後，計算 </span><a href="https://oi-wiki.org/string/z-func/" target="_blank" rel="noopener"><span data-position="16864" data-size="7">Z-value</span></a><span data-position="16908" data-size="5"> 後得到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="387" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="16918" data-size="14">，接著算 ABAA 的數量。</span></p><p class="part" data-startline="406" data-endline="406" data-position="16934" data-size="0"><span data-position="16934" data-size="18">試著窮舉第二個 A 的開頭，假設是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="388" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="16955" data-size="6">，那就是問 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="389" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mo data-mjx-texclass="OP" movablelimits="true">min</mo><mo stretchy="false">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="16988" data-size="17"> (0-based) 之間有多少 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="390" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17008" data-size="4"> 滿足 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="391" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c21D2"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>z</mi><mi>j</mi></msub><mo>≥</mo><mi>j</mi><mo>−</mo><mi>i</mi><mo stretchy="false">⇒</mo><mi>i</mi><mo>≥</mo><mi>j</mi><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container></span></p><p class="part" data-startline="408" data-endline="408" data-position="17056" data-size="0"><span data-position="17056" data-size="9">考慮一個合法數對 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="392" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17073" data-size="9">，其實他的貢獻是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="393" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.404em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>114514</mn><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>+</mo><mi>i</mi><mo>−</mo><mn>2</mn><mi>j</mi></mrow></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="17099" data-size="8"> ，所以只要對 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="394" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="17114" data-size="8"> 排序，窮舉到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="395" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17125" data-size="9"> 時已經被算過的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="396" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17137" data-size="4"> 都有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="397" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D467 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≥</mo><mi>j</mi><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub></math></mjx-assistive-mml></mjx-container></span><span data-position="17155" data-size="15">，這時候只要查詢已經被算過的 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="398" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17173" data-size="3"> 中 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="399" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.404em;"><mjx-texatom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>114514</mn><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>2</mn><mi>j</mi></mrow></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="17190" data-size="12"> 的區間和，就可以乘上 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="400" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c><mjx-c class="mjx-c35"></mjx-c><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c34"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.404em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>114514</mn><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>+</mo><mi>i</mi></mrow></msup></math></mjx-assistive-mml></mjx-container></span><span data-position="17216" data-size="5"> 來得到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="401" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17224" data-size="18"> 的貢獻，可以用一個 BIT 搞定。</span></p><p class="part" data-startline="410" data-endline="410" data-position="17244" data-size="0"><span data-position="17244" data-size="7">總時間複雜度 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="402" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17263" data-size="1">。</span></p><p class="part" data-startline="412" data-endline="412" data-position="17266" data-size="0"><strong data-position="17266" data-size="0"><span data-position="17268" data-size="2">套 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="403" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17283" data-size="7"> 的 J 的解</span></strong></p><p class="part" data-startline="414" data-endline="414" data-position="17294" data-size="0"><span data-position="17294" data-size="27">這題的記憶體限制有一點緊，如果有人因為 LCP 開到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="404" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17334" data-size="18"> 的記憶體的話，可以注意到我們用到 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="405" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext></math></mjx-assistive-mml></mjx-container></span><span data-position="17364" data-size="12"> 的部分其實都是在檢查 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="406" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mtext class="mjx-n"><mjx-c class="mjx-c4C"></mjx-c><mjx-c class="mjx-c43"></mjx-c><mjx-c class="mjx-c50"></mjx-c></mjx-mtext><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D44C TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>LCP</mtext><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>Y</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17394" data-size="3"> 跟 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="407" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="17400" data-size="28"> 是不是相等，所以可以例如直接改用 Hash 就可以有 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="408" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17434" data-size="9"> 空間的演算法了。</span></p><p class="part" data-startline="416" data-endline="416" data-position="17445" data-size="0"><span data-position="17445" data-size="6">不過雖然是 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="409" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="17464" data-size="34">，但是這麼做常數相較前面簡單的做法可能大非常多，所以高機率要壓常😶</span></p><h2 class="part" data-startline="418" data-endline="418" id="Random-Facts" data-id="Random-Facts"><a class="anchor hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Random-Facts" title="Random-Facts" smoothhashscroll=""><span class="octicon octicon-link ph ph-link-simple-horizontal"></span></a><span data-position="17503" data-size="12">Random Facts</span></h2><ul class="part" data-startline="420" data-endline="427" data-position="17517" data-size="0">
<li class="" data-startline="420" data-endline="420" data-position="17519" data-size="0"><span data-position="17519" data-size="59">Problem C 源於真事，但因為事主是 -1e11，拿他當主角的話會暗示它是打表題，所以 YP 就上來當代罪羊了。</span></li>
<li class="" data-startline="421" data-endline="421" data-position="17581" data-size="0"><span data-position="17581" data-size="82">Problem E 的來源是 rgnerdplayer 表示他不會做任何在二維平面上數點對（他稱二維數點）的操作，所以出題群決定出一題相關的題目制裁他，結果他首殺。</span></li>
<li class="" data-startline="422" data-endline="422" data-position="17666" data-size="0"><span data-position="17666" data-size="132">Problem F 的來源是出題者在打某一場比賽時看錯題目（看成 version1），寫完之後還過範測，上傳之後 WA 成白痴才發現自己看錯。後來想出成題目之後發現自己又假解了，就硬把題目改大家賽中看到的樣子（version2, current version）。</span></li>
<li class="" data-startline="423" data-endline="423" data-position="17801" data-size="0"><span data-position="17801" data-size="103">Problem G 的來源是出題者團練時不會做的題目，在嘗試把最小割 append 原題時覺得很美麗，卻發現原題的限制讓最小割行不通，結果最終解答也跟最小割一點關係都沒有，所以就暴力改限制變成現在的題目了。</span></li>
<li class="" data-startline="424" data-endline="424" data-position="17907" data-size="0"><span data-position="17907" data-size="71">Problem H 的來源是 IOI 2022 國手們發明的「西瓜圖」，但其實出題群沒有任何 IOI 2022 國手，我們感謝國手們提供靈感。</span></li>
<li class="" data-startline="425" data-endline="425" data-position="17981" data-size="0"><span data-position="17981" data-size="92">Problem J 是臨時被加進來的題目，原本只有 Problem M，但比賽前一陣子負責的出題者就表示他可以輸出所有對於每一個後綴都輸出，但大家實在是太忙了就沒有幫他想能不能更簡單。</span></li>
<li class="" data-startline="426" data-endline="426" data-position="18076" data-size="0"><span data-position="18076" data-size="22">Problem K 其實可以把資料結構改成 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="410" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c27E8"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.166em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c27E9"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⟨</mo><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>,</mo><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>N</mi></msqrt><mo stretchy="false">)</mo><mo fence="false" stretchy="false">⟩</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="18132" data-size="10">，進而讓複雜度變成 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="411" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-n" space="2"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D436 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-n"><mjx-c class="mjx-c221A"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.166em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-box></mjx-sqrt></mjx-msqrt><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>log</mi><mo data-mjx-texclass="NONE">⁡</mo><mi>C</mi><mo>+</mo><mi>Q</mi><msqrt><mi>N</mi></msqrt><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></span><span data-position="18166" data-size="3">，但 </span><span class="mathjax"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="412" style="font-size: 123.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container></span><span data-position="18172" data-size="49"> 那邊的常數真的很大，如果這樣出的話時限會被調到非常大，不然有通過的隊伍的做法其實都可以被卡掉（Ｘ</span></li>
<li class="" data-startline="427" data-endline="427" data-position="18224" data-size="0"><span data-position="18224" data-size="43">Problem L 實際上是一個現實存在的問題，題目來源來自某一位退役選手的工作需求。</span></li>
</ul></div></div><div class="document-footer container-fluid hmd-pb-2 hidden-print"><div class="-mb-5 flex items-center justify-end text-right text-3 text-text-subtle"><span>最後編輯：&nbsp;</span><span class="ui-lastchangeuser h-[18px]" data-profile="baluteshih" data-placement="left" data-name="波路特石"><a class="ui-user-icon m-0 inline-block h-[18px] w-[18px] user-card-popover" target="_blank" href="https://hackmd.io/@baluteshih" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96&quot;);" data-original-title="" title=""></a></span></div><hr class="my-[30px]"><div class="footer hmd-items-center flex flex-col-reverse gap-[25px] sm:flex-row sm:gap-0"><div class="block h-full flex-1"><div class="flex gap-3 text-text-subtle"><span class="flex items-center justify-center ui-owner" data-placement="top" data-profile="baluteshih"> <a class="min-w-10 ui-user-icon m-0 inline-block h-10 w-10 user-card-popover" target="_blank" href="https://hackmd.io/@baluteshih" data-toggle="popover" style="background-image: url(&quot;https://lh3.googleusercontent.com/-CKX82J9UNKM/AAAAAAAAAAI/AAAAAAAAACA/osF3Ho7GK5E/photo.jpg?sz=96&quot;);" data-original-title="" title=""></a></span><div class="flex max-w-[303px] flex-col items-start justify-center gap-1.5"><div class="w-full break-words"><a class="cursor-pointer text-normal font-semibold leading-normal text-text-emphasize hocus:text-link-text-hover hocus:underline ui-owner user-card-popover" data-placement="top" data-profile="baluteshih" href="https://hackmd.io/@baluteshih" data-toggle="popover" data-original-title="" title="">波路特石</a><div class="follow-button-container inline" data-signin="false"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-text-subtle ui-signin">追蹤</button></span></div></div><span class="w-full break-words text-sm text-text-subtle"></span></div></div></div><div class="footer__views"><div class="flex flex-col gap-2.5"><div class="flex flex-row justify-around gap-[7px]"><div class="community-button ui-comment-counts flex items-center justify-center gap-[5px] text-5" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="0 篇留言"><i class="ph-fill ph-chat-circle-dots"></i><span>0</span></div><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="讚賞"><i class="ph ph-heart"></i><span class="count"></span></a><div class="community-button ui-viewcount" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" data-original-title="1585 次瀏覽"><i class="ph ph-eye"></i><span class="count">1585</span></div><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="top" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="收藏"><i class="ph ph-bookmark-simple"></i></a></div></div></div></div><section id="notes-recommendations"></section><hr class="mt-7.5 mb-3.5"><div class="footer text-center text-sm leading-sm text-text-subtle"><span>發表於</span> <strong><a href="https://hackmd.io/" target="_blank"><img class="h-5 w-auto" src="./# 2023 團體預賽題解 - HackMD_files/Logo.svg"> <span class="brand">HackMD</span></a></strong></div></div><div class="ui-community unselectable hidden-print hidden-xs" style="visibility: visible; left: 450.27px;"><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="讚賞"><i class="ph ph-heart"></i><span class="count"></span></a><a class="community-button hidden-xs" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" type="button" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" data-original-title="收藏"><i class="ph ph-bookmark-simple"></i></a><a class="community-button hidden-xs" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#"><i class="ph ph-bell"></i></a></div><div class="ui-toc dropup unselectable hidden-print" style="display: none; left: 450.114px;"><div class="pull-left dropdown"><a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" role="button" aria-haspopup="true" aria-expanded="false" title="目錄"><i class="fa fa-bars"></i></a><ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel"><div class="toc"><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Final-Scoreboard" title="Final Scoreboard" smoothhashscroll="">Final Scoreboard</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Statistics" title="Statistics" smoothhashscroll="">Statistics</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problems-AttemptedSolved" title="Problems Attempted/Solved" smoothhashscroll="">Problems Attempted/Solved</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Submissions-Over-Time" title="Submissions Over Time" smoothhashscroll="">Submissions Over Time</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Summary" title="Summary" smoothhashscroll="">Summary</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-A-Area-in-Convex-mid-hard" title="Problem A. Area in Convex [mid-hard]" smoothhashscroll="">Problem A. Area in Convex [mid-hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-B-Bogosort-mid" title="Problem B. Bogosort [mid]" smoothhashscroll="">Problem B. Bogosort [mid]</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#How-to-start-with" title="How to start with?" smoothhashscroll="">How to start with?</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Heuristic-Proposal" title="Heuristic Proposal" smoothhashscroll="">Heuristic Proposal</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Verification-Validity" title="Verification Validity" smoothhashscroll="">Verification Validity</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Negative" title="False Negative" smoothhashscroll="">False Negative</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Positive" title="False Positive" smoothhashscroll="">False Positive</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Implementation-and-Experiments" title="Implementation and Experiments" smoothhashscroll="">Implementation and Experiments</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-C-Communication-Problem-easy" title="Problem C. Communication Problem [easy]" smoothhashscroll="">Problem C. Communication Problem [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-D-Decision-Problem-hard" title="Problem D. Decision Problem [hard]" smoothhashscroll="">Problem D. Decision Problem [hard]</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D1-%E6%8B%86%E8%A7%A3%E5%95%8F%E9%A1%8C" title="D.1 拆解問題" smoothhashscroll="">D.1 拆解問題</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#%E8%A7%80%E5%AF%9F%E8%88%87%E7%B5%90%E8%AB%96" title="觀察與結論" smoothhashscroll="">觀察與結論</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D2-%E6%A8%B9%E4%B8%8A%E5%88%86%E5%A1%8A" title="D.2 樹上分塊" smoothhashscroll="">D.2 樹上分塊</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D3-%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C-D-%E2%80%A6-" title="D.3 解決問題 D … ?" smoothhashscroll="">D.3 解決問題 D … ?</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-1-uprime_i--vprime_i" title="Case 1: ui′=vi′" smoothhashscroll="">Case 1: ui′=vi′</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-2-uprime_i-vprime_i-%E6%9C%89%E4%B8%80%E5%80%8B%E6%98%AF%E5%8F%A6%E4%B8%80%E5%80%8B%E7%9A%84%E7%A5%96%E5%85%88" title="Case 2: ui′,vi′ 有一個是另一個的祖先" smoothhashscroll="">Case 2: ui′,vi′ 有一個是另一個的祖先</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-3-%E5%89%A9%E4%B8%8B%E7%9A%84%E6%83%85%E6%B3%81" title="Case 3: 剩下的情況" smoothhashscroll="">Case 3: 剩下的情況</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D4-%E5%BF%AB%E5%8F%96%E5%84%AA%E5%8C%96" title="D.4 快取優化" smoothhashscroll="">D.4 快取優化</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-E-Er-Wei-Shu-Dian-water" title="Problem E. Er Wei Shu Dian [water]" smoothhashscroll="">Problem E. Er Wei Shu Dian [water]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-F-Fake-Solution-easy" title="Problem F. Fake Solution [easy]" smoothhashscroll="">Problem F. Fake Solution [easy]</a></li>
<li class="active"><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-G-Grouping-Problem-mid" title="Problem G. Grouping Problem [mid]" smoothhashscroll="">Problem G. Grouping Problem [mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-H-Harmony-Coloring-easy-mid" title="Problem H. Harmony Coloring [easy-mid]" smoothhashscroll="">Problem H. Harmony Coloring [easy-mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-I-IMO-Problem-easy" title="Problem I. IMO Problem [easy]" smoothhashscroll="">Problem I. IMO Problem [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-J-Japanese-Monsters-mid-hard" title="Problem J. Japanese Monsters [mid-hard]" smoothhashscroll="">Problem J. Japanese Monsters [mid-hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-K-Known-Problem-hard" title="Problem K. Known Problem [hard]" smoothhashscroll="">Problem K. Known Problem [hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-L-List-of-Order-easy" title="Problem L. List of Order [easy]" smoothhashscroll="">Problem L. List of Order [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-M-More-Japanese-Monsters-mid" title="Problem M. More Japanese Monsters [mid]" smoothhashscroll="">Problem M. More Japanese Monsters [mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Random-Facts" title="Random Facts" smoothhashscroll="">Random Facts</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">全部展開</a><a class="back-to-top" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">回到頂部</a><a class="go-to-bottom" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">移至底部</a></div></ul></div></div><div class="toc-placeholder hidden"></div><div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print affix" data-spy="affix" style="max-width: min(488.274px, 15vw); top: 155.001px; right: 1271.27px;"><div class="toc"><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Final-Scoreboard" title="Final Scoreboard" smoothhashscroll="">Final Scoreboard</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Statistics" title="Statistics" smoothhashscroll="">Statistics</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problems-AttemptedSolved" title="Problems Attempted/Solved" smoothhashscroll="">Problems Attempted/Solved</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Submissions-Over-Time" title="Submissions Over Time" smoothhashscroll="">Submissions Over Time</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Summary" title="Summary" smoothhashscroll="">Summary</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-A-Area-in-Convex-mid-hard" title="Problem A. Area in Convex [mid-hard]" smoothhashscroll="">Problem A. Area in Convex [mid-hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-B-Bogosort-mid" title="Problem B. Bogosort [mid]" smoothhashscroll="">Problem B. Bogosort [mid]</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#How-to-start-with" title="How to start with?" smoothhashscroll="">How to start with?</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Heuristic-Proposal" title="Heuristic Proposal" smoothhashscroll="">Heuristic Proposal</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Verification-Validity" title="Verification Validity" smoothhashscroll="">Verification Validity</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Negative" title="False Negative" smoothhashscroll="">False Negative</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#False-Positive" title="False Positive" smoothhashscroll="">False Positive</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Implementation-and-Experiments" title="Implementation and Experiments" smoothhashscroll="">Implementation and Experiments</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-C-Communication-Problem-easy" title="Problem C. Communication Problem [easy]" smoothhashscroll="">Problem C. Communication Problem [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-D-Decision-Problem-hard" title="Problem D. Decision Problem [hard]" smoothhashscroll="">Problem D. Decision Problem [hard]</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D1-%E6%8B%86%E8%A7%A3%E5%95%8F%E9%A1%8C" title="D.1 拆解問題" smoothhashscroll="">D.1 拆解問題</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#%E8%A7%80%E5%AF%9F%E8%88%87%E7%B5%90%E8%AB%96" title="觀察與結論" smoothhashscroll="">觀察與結論</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D2-%E6%A8%B9%E4%B8%8A%E5%88%86%E5%A1%8A" title="D.2 樹上分塊" smoothhashscroll="">D.2 樹上分塊</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D3-%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C-D-%E2%80%A6-" title="D.3 解決問題 D … ?" smoothhashscroll="">D.3 解決問題 D … ?</a><ul class="nav">
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-1-uprime_i--vprime_i" title="Case 1: ui′=vi′" smoothhashscroll="">Case 1: ui′=vi′</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-2-uprime_i-vprime_i-%E6%9C%89%E4%B8%80%E5%80%8B%E6%98%AF%E5%8F%A6%E4%B8%80%E5%80%8B%E7%9A%84%E7%A5%96%E5%85%88" title="Case 2: ui′,vi′ 有一個是另一個的祖先" smoothhashscroll="">Case 2: ui′,vi′ 有一個是另一個的祖先</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Case-3-%E5%89%A9%E4%B8%8B%E7%9A%84%E6%83%85%E6%B3%81" title="Case 3: 剩下的情況" smoothhashscroll="">Case 3: 剩下的情況</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#D4-%E5%BF%AB%E5%8F%96%E5%84%AA%E5%8C%96" title="D.4 快取優化" smoothhashscroll="">D.4 快取優化</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-E-Er-Wei-Shu-Dian-water" title="Problem E. Er Wei Shu Dian [water]" smoothhashscroll="">Problem E. Er Wei Shu Dian [water]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-F-Fake-Solution-easy" title="Problem F. Fake Solution [easy]" smoothhashscroll="">Problem F. Fake Solution [easy]</a></li>
<li class="active"><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-G-Grouping-Problem-mid" title="Problem G. Grouping Problem [mid]" smoothhashscroll="">Problem G. Grouping Problem [mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-H-Harmony-Coloring-easy-mid" title="Problem H. Harmony Coloring [easy-mid]" smoothhashscroll="">Problem H. Harmony Coloring [easy-mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-I-IMO-Problem-easy" title="Problem I. IMO Problem [easy]" smoothhashscroll="">Problem I. IMO Problem [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-J-Japanese-Monsters-mid-hard" title="Problem J. Japanese Monsters [mid-hard]" smoothhashscroll="">Problem J. Japanese Monsters [mid-hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-K-Known-Problem-hard" title="Problem K. Known Problem [hard]" smoothhashscroll="">Problem K. Known Problem [hard]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-L-List-of-Order-easy" title="Problem L. List of Order [easy]" smoothhashscroll="">Problem L. List of Order [easy]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Problem-M-More-Japanese-Monsters-mid" title="Problem M. More Japanese Monsters [mid]" smoothhashscroll="">Problem M. More Japanese Monsters [mid]</a></li>
<li><a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#Random-Facts" title="Random Facts" smoothhashscroll="">Random Facts</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">全部展開</a><a class="back-to-top" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">回到頂部</a><a class="go-to-bottom" href="https://hackmd.io/@baluteshih/NTUPreliminary2023#">移至底部</a></div></div><div class="clearfix"></div></div>
    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true" theme="light">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">×</span></button>
            






    









<h3>登入</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form" novalidate="true">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="NTu6VyCT-CKzL_LElWt9y9kHCdby9_hpiwY8"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="您的 Email" required="" autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">密碼</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="margin-top: 14px"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="您的密碼" required="" autocomplete="current-password" maxlength="128">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right !text-normal !leading-normal !font-normal !mt-1.5"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">忘記密碼</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        <div hidden="" id="hmd-captcha" data-provider="" data-captcha-data="" class="flex justify-center"></div>

        
            <input type="submit" class="neo-btn neo-btn-primary !justify-center !py-3.5 !mx-auto disabled" formaction="https://hackmd.io/login" value="登入">
        

        
    </div>
</form>














    
        <p class="separator">或是</p>
    

    
        <p>繼續登入，代表您同意<a href="https://hackmd.io/s/terms" target="_blank">服務條款</a>。</p>
    

    












<script id="gsi-client" src="https://accounts.google.com/gsi/client" async="" defer="" nonce=""></script>
<script nonce="">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = '/login'
            const joinPath = '/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.pathname.toLowerCase() === loginPath || location.pathname.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="https://hackmd.io/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>


<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> 透過 Facebook 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> 透過 Twitter 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> 透過 GitHub 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> 透過 Dropbox 登入
    </a>
    
    
    
      <a href="https://hackmd.io/@baluteshih/NTUPreliminary2023#" class="bg-white btn btn-block btn-social btn-web3 bg-gray-800 hocus:bg-[#2b2b2b] text-white hocus:text-white">
          <img src="./# 2023 團體預賽題解 - HackMD_files/wallet.svg" style="max-height: 20px; margin-top: 8px; margin-left: 6px; border: none;">
          <span class="sign-in-wallet-text">
              錢包登入
          </span>

          <div class="inline-flex items-center justify-between w-full hidden web3-wallet-info">
              <span>
                   錢包
                   (
                    <span class="web3-wallet-address"></span>
                   )
              </span>

              <i class="fa fa-arrow-right" aria-hidden="true"></i>
          </div>
      </a>

      <small class="web3-wallet-info hidden text-left hocus:text-white underline hocus:underline block pt-2 ui-disconnect-connected-wallets text-gray-600 cursor-pointer">
          連結其他錢包
      </small>
    
</div>




    <div>
        <p>第一次使用 HackMD？ <a href="https://hackmd.io/join" class="plausible-event-name=LoginModalSignUp">註冊</a></p>
    </div>




        </div>
    </div>
</div>

    
    <script src="./# 2023 團體預賽題解 - HackMD_files/js(1)"></script><script type="text/javascript" id="" src="./# 2023 團體預賽題解 - HackMD_files/script.manual.js.下载"></script>
<script type="text/javascript" id="" src="./# 2023 團體預賽題解 - HackMD_files/tracks.js.下载"></script><iframe allow="join-ad-interest-group" data-tagging-id="G-NGVZMM6DR6" data-load-time="1728295826520" height="0" width="0" src="./# 2023 團體預賽題解 - HackMD_files/rul.html" style="display: none; visibility: hidden;"></iframe>

    <script nonce="">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'G-NGVZMM6DR6', {'user_id': userid});
        
    </script>


    
<script src="./# 2023 團體預賽題解 - HackMD_files/bundle.min.js.下载" crossorigin="anonymous"></script>
<script nonce="">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="./# 2023 團體預賽題解 - HackMD_files/i18n.js.下载"></script>
     <script src="./# 2023 團體預賽題解 - HackMD_files/font-vendor.eaa8dd82d4e056021b8c.js.下载" defer="defer"></script><script src="./# 2023 團體預賽題解 - HackMD_files/common-vendor.04da453a2a68f624f4d4.js.下载" defer="defer"></script><script src="./# 2023 團體預賽題解 - HackMD_files/pretty-vendor.94ca39727118897623cd.js.下载" defer="defer"></script><script src="./# 2023 團體預賽題解 - HackMD_files/pretty-common.e537850a918313f6b528.js.下载" defer="defer"></script><script src="./# 2023 團體預賽題解 - HackMD_files/pretty.06788b18aa36f883c497.js.下载" defer="defer"></script>

    



<div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div id="toasts-container" class="toasts-container"><div><div class="pointer-events-auto ml-auto mr-auto flex w-fit flex-col justify-end"></div></div></div></body><div></div></html>