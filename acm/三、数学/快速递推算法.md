## 快速递推算法

###  Bostan-Mori

#### 生成函数与递推关系

这是一个用来计算常系数递推数列第 $k$ 项，以及分式型多项式第 $k$ 项系数的东西。通常这里的 $k$ 会很大，比如 $1e18$.

通常，递推数列由两部分组成，一部分是递推公式，形如 $a_n=\sum_{j=1}^{d} c_{j} \times a_{n-j}$，另一部分则是初值，即 $a_0,a_1,a_2,\cdots,a_{d-1}$ 这些数构成。

$A(x) = \sum a_i x^i$

结合递推公式有

$A(x)=\sum_{i = 1}^d x^i c_i A(x) +P(x)$，其中 $P(x)$ 表示误差修正项。

稍加移相变形即可得到 $A(x) = \frac{P(x)}{1 - (\sum_{i=1}^{n} c_i x^i)}$,令 $Q(x)$为分母即可。

利用生成函数的方法，很容易发现其对应的生成函数可以写成 $\frac{P(x)}{Q(x)}$的形式.

#### 快速幂

接下来我们需要思考的问题是，我们能否向普通快速幂一样去快速的计算这个数列的第 $k$ 项？

利用奇偶函数的性质，我们可以将 $A(x)$ 视为 $F(x^2)+xG(x^2)$，此时我们将这个函数分成了两部分，$F(x^2)$表示了 $A(x)$ 中的所有偶次幂 $(0, 2, 4,\cdots)$，$xG(x^2)$ 表示了 $A(x)$ 中所有奇次幂 $(1, 3, 5, \cdots)$。

于是我们递推的大小就缩减为原先的一半。

那么接下来问题就变成了我们怎么去得到这两个函数。

$d \log d \log k$